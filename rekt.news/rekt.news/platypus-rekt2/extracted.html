<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/platypus2-header.png"/></figure></p><p><em><a href="https://twitter.com/Platypusdefi">Platypus</a> is beginning to look like an endangered species.</em></p><p><strong>A flashloan attack has drained the Avalanche-based protocol of $2.2M, but this isn’t their first time on the <a href="https://rekt.news/leaderboard/">leaderboard</a>…</strong></p><p>In February, <a href="https://rekt.news/platypus-finance-rekt/">Platypus lost $8.5M</a> when its recently-released stablecoin was attacked (also via flash loan).</p><p><em>The incident wasn’t exactly a blackhat masterclass.</em></p><p>The hacker had <a href="https://twitter.com/danielvf/status/1626641254531448833">neglected</a> to code a way to withdraw funds from the attack contract, and BlockSec were able to <a href="https://snowtrace.io/tx/0x5e3eb070c772631d599367521b886793e13cf0bc150bd588357c589395d2d5c3">whitehack 2.4M USDC</a> to be returned. Additionally, shoddy OPSEC led to the hacker being quickly <a href="https://twitter.com/zachxbt/status/1626434265260118021">tracked down</a>, and later <a href="https://cointelegraph.com/news/french-police-arrest-2-people-in-connection-to-platypus-attack">arrested</a> in France.</p><p><em>The project was also <a href="https://twitter.com/peckshield/status/1678800450303164431">hit</a> in July for $150k.</em></p><p>**This time, after <a href="https://twitter.com/peckshield/status/1712354198246035562">Peckshield</a> raised the alarm, and the losses began to <a href="https://twitter.com/PeckShieldAlert/status/1712367911766257912">mount up</a>, Platypus <a href="https://twitter.com/Platypusdefi/status/1712365385100689584">acknowledged</a> the incident:</p><blockquote><p>Due to suspicious activities in our protocol, we have taken the proactive measure of temporarily suspending all pools.</p></blockquote><p>As we wrote last time:</p><blockquote><p>Evolution works in mysterious ways.</p></blockquote><p><strong>But after three exploits in 8 months…</strong></p><p><em>…how long until Platypus goes extinct?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/09/rekt-investigates-linebreak.png"/></figure></p><p>Credit: <em><a href="https://twitter.com/BlockSecTeam/status/1712445197538468298">BlockSec</a>, <a href="https://twitter.com/InspexCo/status/1712489621018599468">Inspex</a></em></p><p><strong>The attack was comprised of three transactions, each of which used flash loans to manipulate the prices within the Platypus <a href="https://snowtrace.io/address/0xc73eed4494382093c6a7c284426a9a00f6c79939">LP-AVAX pool</a>.</strong></p><p>According to <a href="https://twitter.com/BlockSecTeam/status/1712445197538468298">BlockSec</a>, the attacker “<em>manipulated 'cash' and 'liability' which affected the swap price</em>” via slippage.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/platypus2-code.png"/></figure></p><p><strong>Inspex <a href="https://twitter.com/InspexCo/status/1712489621018599468">provided</a> the following step-by-step:</strong></p><blockquote><p>1/ The attacker deposits WAVAX to LP-AVAX, and sAVAX to LP-sAVAX increases the liability of both LP contracts.</p><p>2/ The attacker swapped sAVAX to WAVAX to reduce the cash from the LP-AVAX contract.</p><p>3/ The attacker then withdrawn WAVAX from LP-AVAX to remove all available cash from the LP-AVAX contract. This will increase the slippageFrom value, resulting in manipulating the <code>actualToAmount</code> value.</p><p>4/ As a result, the attacker swap and take profit from the manipulated slippage.</p></blockquote><p><strong><strong>Again, as in February, the hacker made a mistake which allowed for the <a href="https://snowtrace.io/tx/0xa15960386586816486261dbc5cd9c8bf5f212f9f667e32abaa9f18891d0165e4">recovery</a> of <a href="https://snowtrace.io/tx/0xb643892f6d343965856f9f85045820bb55bb1b4b8064fee3bbcc2b0929c7616b">some</a> ($575k) of the stolen assets.</strong></strong></p><p>Attacker address 1: <strong><a href="https://snowtrace.io/address/0x0cd4fd0eecd2c5ad24de7f17ae35f9db6ac51ee7">0x0cd4fd0eecd2c5ad24de7f17ae35f9db6ac51ee7</a></strong></p><p>Malicious contract 1: <a href="https://snowtrace.io/address/0x4cfb527f51b391ecb1a5197edc7a38160c261b6f">0x4cfb527f51b391ecb1a5197edc7a38160c261b6f</a></p><p>Attack tx 1: <a href="https://snowtrace.io/tx/0xab5f6242fb073af1bb3cd6e891bc93d247e748a69e599a3744ff070447acb20f">0xab5f6242…</a></p><p>Attack tx 2: <a href="https://snowtrace.io/tx/0x4425f757715e23d392cda666bc0492d9e5d5848ff89851a1821eab5ed12bb867">0x4425f757…</a></p><p>Attacker address 2: <strong><a href="https://snowtrace.io/address/0x464073f659591507d9255b833d163ef1af5ccc2c">0x464073f659591507d9255b833d163ef1af5ccc2c</a></strong></p><p>Malicious contract 2: <a href="https://snowtrace.io/address/0xf2c444572a402ec83b7cb64e4a9fc2188f0628f2">0xf2c444572a402ec83b7cb64e4a9fc2188f0628f2</a></p><p>Attack tx 3: <a href="https://snowtrace.io/tx/0x6a09d38505beeb29ed4dbb30de2803f30f3c62e2464c6a20ec17026c372c763e">0x6a09d385…</a></p><p>Rescued funds ($575k): <a href="https://snowtrace.io/address/0x068e297e8ff74115c9e1c4b5b83b700fda5afdeb">0x068e297e8ff74115c9e1c4b5b83b700fda5afdeb</a></p><p><strong>The remaining stolen funds ($1.6M of WAVAX and sAVAX) currently remain in the primary <a href="https://snowtrace.io/address/0x4cfb527f51b391ecb1a5197edc7a38160c261b6f">attack contract</a>.</strong></p><p><em>Platypus fork Hummus Exchange has also <a href="https://twitter.com/hummusdefi/status/1712425534930534465">paused contracts</a> in order to avoid a repeat attack.</em></p><p>Platypus was audited by both Hacken and Omniscia, but both audits were <a href="https://medium.com/platypus-finance/platypus-successfully-passed-hackens-smart-contract-audit-and-omniscia-s-security-analysis-767d79bff5a6">completed</a> by early January 2022, over three months before the affected contract was <a href="https://snowtrace.io/tx/0xa9320f3f74dfd0a4ceb5ef875148f923b9493492d3d426172fcebed6bb8f9b86">deployed</a>.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p><em>It’s been a rough week for Avalanche.</em></p><p><strong>Last weekend’s <a href="https://rekt.news/stars-arena-rekt/">Stars Arena</a> debacle came after a while with barely a peep from the AVAX community.</strong></p><p>Despite the fact that <a href="https://twitter.com/starsarenacom/status/1712192197443883453">90% of funds</a> have been returned, the way the incident was handled (by both the team and Ava Labs’ CEO) left a bad impression.</p><p>Then, news broke that Avalanche’s favourite DEX Trader Joe is <a href="https://twitter.com/CoinDesk/status/1711720164121628846">being sued</a> by none other than… Trader Joe’s. <em>Who could've seen that coming?</em></p><p><strong>With many alternate L1s struggling, and even <a href="https://twitter.com/CantoPublic/status/1703809950290718871">pivoting</a> to the more active Ethereum L2 ecosystem…</strong></p><p><em>…what’s next for Avalanche?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/rekt-outline-conc.png"/></figure></p>