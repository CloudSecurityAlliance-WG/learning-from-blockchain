<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2022/04/elephant-header.png"/></figure></p><p><strong>An audit couldn’t protect Elephant Money from the on-chain poachers.</strong></p><p><a href="https://solidity.finance/audits/ElephantMoney/">Solidity Finance</a> failed to notify Elephant about a price manipulation vulnerability, which was then exploited in a flash loan attack that this Elephant <em>will</em> want to forget.</p><p>The <a href="https://medium.com/elephant-money/reserve-exploit-52fd36ccc7e8">official post-mortem</a> stated a loss of $11.2M, yet <a href="https://twitter.com/peckshield/status/1514023036596330496">Peckshield</a> later pointed out that Elephant had chosen not to include the loss of ~30 billion ELEPHANT tokens, bringing the total amount lost to $22.2M.</p><p>“DO NOT SELL” <a href="https://twitter.com/ElephantStatus/status/1514007291116199936?s=20&amp;t=rwVlFzi-S1G4wOW4K3-yVg">say Elephant Money</a>.</p><p><em>Is this… financial advice?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/09/rekt-investigates-linebreak.png"/></figure></p><p><em>Credit: <a href="https://twitter.com/BlockSecTeam/status/1513966074357698563">BlockSecTeam</a></em></p><p><strong>The attacker used flash loans to manipulate the price of the ELEPHANT token during the minting process of the project’s stablecoin TRUNK.</strong></p><p><strong>Example tx:</strong> <a href="https://bscscan.com/tx/0xec317deb2f3efdc1dbf7ed5d3902cdf2c33ae512151646383a8cf8cbcd3d4577">0xec317deb2f3efdc1dbf7ed5d3902cdf2c33ae512151646383a8cf8cbcd3d4577</a></p><p>Firstly, the attacker took flash loans of 131k WBNB and 91M BUSD, the 131,162.00 WBNB was swapped to 34.244e21 ELEPHANT.</p><p>TRUNK can be minted by depositing BUSD. During this process, the vulnerable contract first swaps BUSD to WBNB and then uses the WBNB to buy ELEPHANT, raising the price of ELEPHANT. By minting, the attacker both receives TRUNK and increases the value of the ELEPHANT from the previous step.</p><p>The attacker then swapped the ELEPHANT, originally acquired for 131k WBNB, to 164k WBNB. Additionally, the attacker redeemed the TRUNK for 37k WBNB and 67M BUSD, making for a total of ~200k WBNB and ~67M BUSD. After returning the flash loans (of 131k WBNB and 91M BUSD), this resulted in a profit of ~$4M</p><p>The same process was repeated on a cycle, leading to total gains of over 27k WBNB ($11.2M) for the hacker. Since the incident, the funds have been sent on to various accounts and then either bridged to Ethereum or sent to Tornado Cash, as can be seen in the <a href="https://twitter.com/PeckShieldAlert/status/1514145304253120515">visualisation below</a>.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2022/04/elephant-peckshield.jpeg"/></figure></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p><strong><a href="https://rekt.news/leaderboard/">Position #28 on the leaderboard</a> for <a href="https://www.coingecko.com/en/coins/elephant-money">Elephant Money</a>, despite their attempt to downplay the loss.</strong></p><p>The <a href="https://www.coingecko.com/en/coins/elephant-money">price of $ELEPHANT</a> is now down by 75%, and their “stable”coin <a href="https://nomics.com/assets/trunk-elephant-money-stable">TRUNK</a> fell by 40%, before partially recovering to $0.78.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2022/04/elephant-trunk.png"/></figure></p><p><strong>It’s a standard story of flash loans and price manipulation.</strong></p><p>The most entertaining part is this <a href="https://twitter.com/ElephantStatus/status/1513608274733543426?s=20&amp;t=cQr_-Gq5TKnQp5D0tgl5rg">headline / financial advice</a> from the Elephant Money marketing department.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2022/04/elephant-buytops.png"/></figure></p><p><em>So we buy the tops… then we sell the… ?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/rekt-outline-conc.png"/></figure></p>