<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/12/badger-header.png"/></figure></p><p><strong>rekt roadkill.</strong></p><p><em>The badger is dead.</em></p><p><a href="https://twitter.com/peckshield/status/1466356911842856967">$120 million</a> taken in various forms of wBTC and ERC20.</p><p><strong>A front-end attack places Badger DAO at number four on the <a href="https://rekt.news/leaderboard/">leaderboard</a>.</strong></p><p><a href="https://rekt.news/furucombo-rekt/">rekt.news repeats:</a></p><blockquote><p><em>Infinite approval means unlimited trust - something which we know we shouldn’t do in DeFi.</em></p></blockquote><p><strong>But should regular users be expected to spot an illegitimate contract via wallet approvals if the front-end is compromised?</strong></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/09/rekt-investigates-linebreak.png"/></figure></p><p><strong>An unknown party inserted additional approvals to send users' tokens to their own address. Starting from 00:00:23 UTC on 2.12.2021, the attacker used this stolen trust to fill their own wallet.</strong></p><p>As the news of users’ addresses being drained reached Badger, the team announced they had <a href="https://twitter.com/BadgerDAO/status/1466263899498377218">paused</a> the project’s smart contracts, and the malicious transactions began to fail around 2 hours 20 mins after they had begun.</p><p>BadgerDAO’s aim is to bring Bitcoin to DeFi. The project is made up of various vaults for users to earn yield on wrapped BTC variants on Ethereum.</p><p>The vast majority of <a href="https://twitter.com/peckshield/status/1466286523729383427">stolen</a> assets were vault deposit tokens which were then cashed out, with the underlying BTC bridged back to the Bitcoin network, and any ERC20 tokens remaining on Ethereum.</p><p><em>The current locations of the stolen funds is summarised <a href="https://twitter.com/peckshield/status/1466356911842856967">here</a>.</em></p><p>Rumours that the project’s Cloudflare account was compromised have been circulating, as have other <a href="https://twitter.com/SlowMist_Team/status/1466359656981225475">security</a> <a href="https://twitter.com/SlowMist_Team/status/1466361705571618817">vulnerabilities</a>.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/12/badger-discord.png"/></figure></p><p><strong>The approvals presented themselves when users attempted to make legitimate deposit and reward claim transactions, building a base of unlimited wallet approvals that allowed the attacker to transfer BTC related tokens directly from the user’s address.</strong></p><p>The first instance of approvals for the hacker’s address was almost two weeks ago, according to <a href="https://twitter.com/peckshield/status/1466317257085227012">Peckshield</a>. Anyone interacting with the platform since then, may have inadvertently approved the attacker to drain funds.</p><p><strong>Over <a href="https://bloxy.info/txs/references_address/0x1fcdb04d0c5364fbd92c73ca8af9baa72c269107?argument=spender&amp;signature_id=5">500 addresses</a> have approved the Hacker’s address: <a href="https://etherscan.io/address/0x1fcdb04d0c5364fbd92c73ca8af9baa72c269107">0x1fcdb04d0c5364fbd92c73ca8af9baa72c269107</a></strong></p><p><strong>Check your approvals and revoke here: <a href="https://etherscan.io/tokenapprovalchecker">etherscan.io/tokenapprovalchecker</a></strong></p><p><strong><a href="https://etherscan.io/tx/0x951babdddbfbbba81bbbb7991a959d9815e80cc5d9418d10e692f41541029869">Example transaction</a>: draining ~900 byvWBTC, worth over $50M.</strong> The <a href="https://etherscan.io/address/0x53461e4fddcc1385f1256ae24ce3505be664f249">victim</a> had <a href="https://etherscan.io/tx/0x5e4c7966b0eaddaf63f1c89fc1c4c84812905ea79c6bee9d2ada2d2e5afe1f34">approved</a> the attacker’s address to spend unlimited funds via the <em>increaseAllowance()</em> function around 6 hours earlier.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/12/badger-inputdata.png"/></figure></p><p><strong>Eventually, thanks to an “<a href="https://mobile.twitter.com/flashfish0x/status/1466369783016869892"><em>unusual</em></a>” feature in Badger’s <em>transferFrom()</em> function, the team was able to pause all activity, halting the further loss of funds.</strong></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p>If longstanding projects with such strong reputations as Badger can get rekt like this, and some of the biggest names in the game have their <a href="https://governance.aave.com/t/analysis-of-xsushis-incident/6335">near-misses</a>, DeFi users can’t afford to get too comfortable about the security of their biggest bags. Diversification is key to survival.</p><p>Despite all the stress that’s usually placed on checking the URL and making sure you’re interacting with proper channels, this wouldn’t have helped users in this case.</p><p><strong>The front-end was manipulated at least <a href="https://twitter.com/peckshield/status/1466317257085227012">12 days ago</a>.</strong></p><p><em>How did Badger not notice?</em></p><p><strong>A user <a href="https://twitter.com/0xMoves/status/1466275399944445952">flagged</a> the suspicious <em>increaseAllowance()</em> approval in Discord.</strong></p><p><em>Why did Badger devs not look into it?</em></p><p>For experienced users, these kinds of bogus approvals might be easy to spot, and checking the validity of any contract is easy enough by copy/pasting the address into Etherscan before signing the transaction.</p><p>But for DeFi to reach “mass adoption”, these extra precautions must be streamlined.</p><p><em>Until then, we can only practise good <a href="https://twitter.com/CryptoCatVC/status/1466380960648380419">wallet and approval hygiene</a>.</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/rekt-outline-conc.png"/></figure></p>