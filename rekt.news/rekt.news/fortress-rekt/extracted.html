<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2022/05/fortress-header.png"/></figure></p><p><strong><a href="https://fortress.loans/">Fortress Protocol</a>, the lending arm of <a href="https://jetfuel.finance/vaults">JetFuel Finance</a> on BSC, was <a href="https://twitter.com/Fortressloans/status/1523495202115051520">pillaged for $3M</a> yesterday.</strong></p><p><strong>Weak fortifications surrounding the project’s oracle and governance process allowed the invading hacker to pass a malicious proposal and manipulate the price of collateral.</strong></p><p>Though contracts remain live, the team have <a href="https://twitter.com/Jetfuelfinance/status/1523555687468793856">paused the platform’s UI</a> and launched a <a href="https://bsc.fortress.loans/vote/proposal/12">follow-up proposal</a> to repair the damage.</p><p><em>However with $3M gone, will this leave Fortress in ruins?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/09/rekt-investigates-linebreak.png"/></figure></p><p><em>Credit: <a href="https://twitter.com/BlockSecTeam/status/1523530484877209600">BlockSecTeam</a>, <a href="https://twitter.com/certikalert/status/1523529765969444864">Certik</a></em></p><p><strong>The protocol’s price oracle was vulnerable to manipulation as the price submit() function is publicly callable.</strong></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2022/05/fortress-code.png"/></figure></p><p>Coupled with a <a href="https://bsc.fortress.loans/vote/proposal/11">malicious proposal</a> to add FTS as collateral (with a factor of 700000000000000000), the attacker was able to drain all assets from the platform using just 100 FTS (~4.5$ at pre-hack prices) as collateral.</p><p>The attack was <a href="https://bscscan.com/tx/0xd253c7c22a5a526e6240d315f95d6b525828ae0632df7f711c363d1960c6a2cb">funded</a> with ETH (on BSC), originally <a href="https://etherscan.io/tx/0x1f1b43b6a56698af777c8c8b7e70eb77f10ff08bd8518c1685b9c19528e3daa5">sourced</a> from Tornado Cash on mainnet. The funds were then <a href="https://etherscan.io/tx/0x1f1b43b6a56698af777c8c8b7e70eb77f10ff08bd8518c1685b9c19528e3daa5">swapped</a> for large quantities of FTS, which were used to reach quorum for the malicious proposal and as collateral.</p><p>Following the exploit, the attacker deposited a total of 1048 ETH ($2.6M) and 400k DAI into Tornado Cash.</p><p><strong>Oracle attack tx: <a href="https://bscscan.com/tx/0x13d19809b19ac512da6d110764caee75e2157ea62cb70937c8d9471afcb061bf">0x13d198…</a></strong></p><p><strong>Attacker’s address on <a href="https://bscscan.com/address/0xA6AF2872176320015f8ddB2ba013B38Cb35d22Ad">BSC</a> and <a href="https://etherscan.io/address/0xA6AF2872176320015f8ddB2ba013B38Cb35d22Ad">ETH</a>:
0xA6AF2872176320015f8ddB2ba013B38Cb35d22Ad</strong></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p><strong>The project’s site lists <a href="https://chain.link/">ChainLink</a> among its “collaboraters” (sic), however it seems that their oracle expertise was not part of the “collaboration”.</strong></p><p>Fortress Protocol was audited by both <a href="https://fortress.loans/audit_hash0x.pdf">Hash0x</a> and <a href="https://fortress.loans/audit_etherautherity.pdf">EtherAuthority</a>, two new names on our leaderboard, neither of which picked up any oracle vulnerability in the code.</p><p>Although the attacker was able to pass quorum, their malicious governance proposal was active for 3 days. Why was the suspicious vote not addressed?</p><p><strong>Once again, we see that taking a vigilant role in governance is important, not just for the team but for all users.</strong></p><p><em>Will the larger JetFuel Finance ecosystem bail out users for the lost funds?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/rekt-outline-conc.png"/></figure></p>