<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/deus3-header.png"/></figure></p><p><em>It’s a hat trick for <a href="https://twitter.com/DeusDao">Deus DAO</a>.</em></p><p><strong>Token holders lost a total of ~$6.5M on Arbitrum, BSC and Etherum, and the <a href="https://www.coingecko.com/en/coins/dei-token">DEI stablecoin</a> depegged over 80%.</strong></p><p>This incident, just over a year since their <a href="https://rekt.news/deus-dao-rekt-2/">last appearance</a>, makes Deus DAO the third protocol with three entries on our <a href="https://rekt.news/leaderboard/">leaderboard</a>.</p><p>Deus’ two previous entries were on the project’s original home, FTM, where they don’t appear to have been affected. Since then, DEI has branched out onto other chains.</p><p>After the <a href="https://twitter.com/hippo_potato/status/1654555505854152704">alarm was raised</a>, and the <a href="https://twitter.com/adamb83024264/status/1654558408803250176">root cause identified</a>, Deus eventually <a href="https://twitter.com/DeusDao/status/1654614967084101633">acknowledged</a> the hack, as well as confirming a multisig address for whitehats to return funds.</p><p><em>But how many times can a thrice-hacked protocol be trusted?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/09/rekt-investigates-linebreak.png"/></figure></p><p>Credit: _<a href="https://twitter.com/adamb83024264/status/1654558408803250176">adamb</a>, <a href="https://twitter.com/zellic_io/status/1654605171333423104">Zellic</a>, <a href="https://twitter.com/0xProtosec/status/1654592710546960385">0xProtosec</a></p><p>A simple implementation error was introduced into the DEI token contract, in an upgrade last month. The burnFrom function was misconfigured, with the ‘_allowances’ parameters ‘msgSender’ and ‘account’ written into the contract in the wrong order.</p><p>This created a public (or pubic, according to <a href="https://twitter.com/peckshield/status/1654626667787321344">Peckshield</a>) burn vulnerability, which an attacker is then able to manipulate and gain control of DEI holders’ approvals and transfer assets directly to their own address.</p><p>The mis-ordered parameters allow the attacker to set a large token approval for any DEI holder’s address. Then, by burning 0 tokens from the address, the approval is updated to the attacker’s address, who can drain the holder’s funds.</p><p>See the <a href="https://twitter.com/PaladinCharles/status/1654585109964619777">following</a> step-by-step:</p><blockquote><p>identify an address with a huge amount of DEI</p><p>approve to this address</p><p>call burnFrom with amount = 0 and this address</p><p>During the burnFrom it grants approves all tokens from the address to your own</p><p>call transferFrom</p></blockquote><p>Attacker’s address (Arbitrum): <strong><a href="https://arbiscan.io/address/0x189cf534de3097c08b6beaf6eb2b9179dab122d1">0x189cf534de3097c08b6beaf6eb2b9179dab122d1</a></strong></p><p>Example attack tx (Arbitrum): <a href="https://arbiscan.io/tx/0xb1141785b7b94eb37c39c37f0272744c6e79ca1517529fec3f4af59d4c3c37ef">0xb1141785…</a></p><p>Frontrunner address (BSC): <a href="https://bscscan.com/address/0x5a647e376d3835b8f941c143af3eb3ddf286c474">0x5a647e376d3835b8f941c143af3eb3ddf286c474</a></p><p>Example attack tx (BSC): <a href="https://bscscan.com/tx/0xde2c8718a9efd8db0eaf9d8141089a22a89bca7d1415d04c05ba107dc1a190c3">0xde2c8718…</a></p><p>Attacker’s address (Ethereum): <a href="https://etherscan.io/address/0x189cf534de3097c08b6beaf6eb2b9179dab122d1">0x189cf534de3097c08b6beaf6eb2b9179dab122d1</a></p><p>Example attack tx (Ethereum): <a href="https://etherscan.io/tx/0x6129dd42778345bc278822a7feadeacb933f5e56ce51114e686832ad239307a8">0x6129dd42…</a></p><p><strong>According to BlockSec’s <a href="https://twitter.com/MetaSleuth/status/1654688526095745024">MetaSleuth</a>, the losses were approximately $5M on Arbitrum, $1.3M on BSC and $135k on Ethereum.</strong></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p>Luckily, the exploit on BSC was frontrun, and an on-chain <a href="https://bscscan.com/tx/0x6cda17b36013ab3d5c2ed95cdb56256bffcb4f086f0c849ae53d4f036f96c322">message</a> to the Deus Deployer shows the intent to return the funds. Other <a href="https://twitter.com/pcaversaccio/status/1654576766927634432">whitehats</a> also sprang into action, and over $600k in USDC has so far been returned to a <a href="https://arbiscan.io/address/0xf8b5e2e99faea5a3416822123c8eca24309cab99#tokentxns">recovery multisig</a>.</p><p><em>However, there were also <a href="https://twitter.com/adamb83024264/status/1654577806628761600">doubts</a> about the usefulness of giving funds back to a team that produced such a trivial bug.</em></p><p><strong>Returning rescued funds to a thrice-hacked protocol seems rather counterproductive…</strong></p><p>An official update mentions a <a href="https://twitter.com/DeusDao/status/1654808611263246336">recovery plan</a> for users who lost out in the exploit, and Deus have <a href="https://arbiscan.io/tx/0xa99e7ee2889fddd52f2c1549072f290516e1001b3220e44f0e62d9ec26341abe">reached out</a> to the attacker on-chain.</p><p>But given the account was originally <a href="https://bscscan.com/tx/0x8b1fd7b6726499fcd4bf4d593fe7be80c2ec134d81db1d431cb590a9ea88147a">funded</a> via Tornado Cash on BSC, it’s not looking good.</p><p><em>Will this be finally be a killing blow for Deus DAO?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/rekt-outline-conc.png"/></figure></p>