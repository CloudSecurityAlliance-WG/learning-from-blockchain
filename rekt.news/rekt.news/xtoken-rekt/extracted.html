<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/05/xtok-header.png"/></figure></p><p><strong>The X-ploiters live amongst us.</strong></p><p>A sub-species of crypto users have developed superhuman abilities which allow them to tear through holes in smart contracts or mould them to their will with flash loans and arbitrage.</p><p><em>Nobody is entirely safe from the anonymous team.</em></p><p>However, rekt.news is here to help by archiving the stories of the infamous X-ploiters so that our readers can learn and future generations may be protected from their brutal attacks.</p><p>This was no cheap ticket - <a href="https://twitter.com/xtokenmarket">XToken</a> is a quality protocol with strong partnerships. Hacks like these remind us that even the “blue chips” aren’t entirely safe.</p><p><strong>What went wrong?</strong></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/05/xtok-investigates.png"/></figure></p><p>Credit: <a href="https://twitter.com/0xdeadf4ce">0xdeadfce</a> &amp; <a href="https://twitter.com/FrankResearcher/status/1392515198674681863?s=20">Frankresearcher</a></p><p><a href="https://ethtx.info/mainnet/0x7cc7d935d895980cdd905b2a134597fb91004b5d551d6db0fb265e3d9840da22">Exploit Transaction</a></p><p><strong>xToken.Market, a decentralized passive investing protocol, was exploited with the use of flash loans.</strong></p><p><strong>Over $24 million was taken from the yield-bearing liquidity pools for SNX (xSNXa) and BNT (xBNTa).</strong></p><p>At 15:14 UTC X-Token released the following <a href="https://twitter.com/xtokenmarket/status/1392483368135233544">warning</a>.</p><blockquote><p>Minting on all contracts has been paused as we investigate reports.</p></blockquote><p>The community alerted us to X-Tokens <a href="https://twitter.com/xtokenmarket/status/1392490733588946948?s=20">tweet</a> within minutes.</p><p>A second tweet explained that:</p><blockquote><p>xSNXa and xBNTa contracts have been exploited. Minting paused on all contracts as we investigate further.</p></blockquote><blockquote><p>Liquidity pools have been drained, however most SNX and BNT remain in xToken contracts.</p></blockquote><p>The attacker used a Flashloan from DyDx for 61,833 ETH (~$267M) and a Private Transaction using Flashbots MEV to facilitate the attack.</p><p><strong>Funds lost</strong></p><ul><li>2.4k ETH ($10.3M)</li><li>781k BNT ($6.2M)</li><li>407k SNX ($8M)</li><li>1.9B xBNTa</li></ul><p><strong>All tokens except xBNTa have already been sold to ~5.6k ETH through 1inch.</strong></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/05/xtok-how.png"/></figure></p><p><strong>1:</strong> Hacker borrowed 61.8k ETH flash loan on dYdX</p><p><strong>2:</strong> Deposited 10k ETH to borrow 564k SNX on Aave and swap 5.5k ETH to 700k SNX on SushiSwap</p><p><strong>3:</strong> Sold 1.2M SNX for 818 ETH on Uniswap v2, significantly reducing the SNX price.</p><p><strong>4:</strong> Used only 0.12 ETH to mint 1.2B xSNXa, because the protocol buys SNX through Kyber, who in turn led to use Uniswap v2 for this swap.</p><p><strong>5:</strong> However, within the protocol, xSNXa price turned out to be normal, which made it possible to swap 105M xSNX into 414 ETH.</p><p><strong>6:</strong> After that, the attacker began to do reverse swaps in SushiSwap and Uniswap and repaid loans in Aave.</p><p><strong>7:</strong> Then they also began to sell the existing xSNXa to the Balancer SNX/ETH/xSNXa (25/25/50) pool.</p><p><strong>8:</strong> Repaid flash loan to dYdX.</p><p><strong>9:</strong> Issued xBNTa four times for 0.03 ETH, which ultimately gave them 3.9B xBNTa.</p><p><strong>10:</strong> Swap half of xBNTa to 781k BNT.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/05/xtok-conclude.png"/></figure></p><p><strong>Another $24 million gone, yet the only unusual thing is the names involved.</strong></p><p>We’re not used to seeing our blue chip babies involved in such violence.</p><p>Perhaps that label gives a false sense of security, even the most time-tested protocols are still incredibly new when you look long term.</p><p>A new entry onto our leaderboard for XToken as they take the number 9 spot, but it’s the fourth time for their security auditor Peckshield, making them the most rekt auditor on the rekt.news leaderboard.</p><p>But then again, perhaps a $24 million bounty is worth another spot on the leaderboard…</p><p><strong>Did this attack come from within?</strong></p><p><em>We may never know, but we will always wonder.</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/05/rekt-stamped.png"/></figure></p>