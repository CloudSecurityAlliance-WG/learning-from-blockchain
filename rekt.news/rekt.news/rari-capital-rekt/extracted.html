<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/05/rari-header.png"/></figure></p><p><strong>Young blood and new money.</strong></p><p>After a quick break for lunch, it was <a href="https://twitter.com/RariCapital/status/1391050253621678080?s=20">Rari Capitals</a> turn to get rekt.</p><p>The youthful yield aggregator has fallen victim to a serial attacker, as the <a href="https://twitter.com/JohnDoughBull/status/1391050085161656320?s=20">same wallet</a> which attacked <a href="https://www.rekt.news/value-rekt3/">Value DeFi</a> only hours before, turned their eyes onto the Rari Capital <a href="https://etherscan.io/tx/0xb7faca63a73d5d0490dda1c390577db3f30414cd91ce462e45c1e7f37c258519">ETH pool</a>, removing $10 million worth of ETH.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/05/rekt-deco-logobreak.png"/></figure></p><p>Rari Capital has attracted attention due to the young age of their developers, causing the community to argue amongst themselves as to whether age is of much relevance when the whole DeFi industry is only 2 - 3 years old.</p><p><strong>Although <a href="https://twitter.com/ChrisBlec/status/1391051943653650439?s=20">some</a> might say they “<a href="https://www.youtube.com/watch?v=D143VuAxr-k">had it coming</a>”, we take no pleasure in learning that people have lost their money.</strong></p><p>There are no developers with 10 years experience in DeFi system design, this is a meritocracy that depends on the skill and maturity of the person rather than the length of their CV.</p><p><em>Each attack presents us with a valuable lesson, and we must study the techniques in order to build a safer future.</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/05/rari-investigates.png"/></figure></p><p><strong>We’re looking at the actions of a cross-chain killer, who used the blood money from Value DeFi to fuel their attack on Rari Capital.</strong></p><p>5,346 BNB ($3.8M) were stolen and swapped to 1k ETH.</p><p><strong>The attacker’s actions on BSC were as follows:</strong></p><p><strong>1:</strong> Create a fake token and pool it with BNB on PancakeSwap in order to use Alpaca Finance.</p><p><strong>2:</strong> Interact with Alpaca Finance, where when calling approve() for a fake token, a payload is called, which allows an attacker to use VSafe through Codex farm to get vSafeWBNB</p><p><strong>3:</strong> Convert vSafeWBNB to WBNB</p><p><strong>4:</strong> Transfer WBNB to Ethereum through Anyswap.</p><p><em>Repeat 2x.</em></p><p><strong>The attack on Rari was as follows:</strong></p><p><strong>1:</strong> Create a fake token and pool with it on SushiSwap</p><p><strong>2:</strong> Interact with <a href="https://twitter.com/alphafinancelab/status/1391046927349784589?s=2">Alpha Homora</a>, where a payload is also called so that the attacker can get ibETH in the Rari ETH pool contract.</p><p><strong>3:</strong> Convert ibETH to ETH in the Rari ETH pool.</p><p>As a result, 2.9k ETH ($11.1M) was stolen, and another 1.7k ETH was at risk before the actions of the Rari team.</p><p><strong>The total profit from the two attacks was $15M in ETH.</strong></p><p>credit: <a href="https://twitter.com/FrankResearcher/status/1391087260125188099">frankresearcher</a></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/05/rari-chart.png"/></figure></p><p>The Rari Capital governance token <a href="https://www.coingecko.com/en/coins/rari-governance-token">$RGT</a> fell sharply in price following the attack.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/05/rari-decode.png"/></figure></p><p>The attacker decided to voice their opinion on the involved protocols, but it seems they had second thoughts, as they tried to cancel the transaction. However, they set the gas too low and the cancellation didn’t go through for 20 minutes, giving everyone time to see their message.</p><p>Credit: <a href="https://twitter.com/bantg/status/1391054251388964867?s=20">banteg</a> &amp; <a href="https://twitter.com/dudesahn/status/1391056013416140803?s=20">dudesahn</a></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/05/rekt-deco-logobreak.png"/></figure></p><p><strong>This attack technique was similar to the <a href="https://www.rekt.news/pickle-finance-rekt/">Evil Pickle Jar</a>, one which looks likely to become even more common in the future.</strong></p><p>Even though various protocols were used, the same exploit mechanism was applied.</p><p>Alpaca/Alpha, vSafe/Rari, PancakeSwap/SushiSwap - the interaction between them was built in such a way that the exploit was easily repeated on another chain.</p><p>The interoperability between DeFi protocols is increasing, and the blurred lines make for even easier escape routes.</p><p><strong>In the roaring twenties, the ruthless are rewarded, and any prosecution seems unlikely.</strong></p><p><em>With so many other surface-level crimes in crypto, who’s going to try and prosecute someone for exploiting contracts where so many remain anonymous?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/05/artdecowidth.png"/></figure></p>