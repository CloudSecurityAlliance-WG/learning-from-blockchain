<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/dodo-header.png"/></figure>
<strong>Is it dead or has it just gone to bed?</strong></p><p>DODO was hacked for $2 million using a fake token attack, but the motive remains unclear.</p><p>One thing’s for sure, whether hat white or black, only $2 million? Must try harder.</p><p>Twitter remains the fastest source of news for DeFi - even the DODO team relied on <a href="https://twitter.com/Luciano_vPEPO/status/1369055985684381696?s=20">Luciano</a> to tell them that their own $WCRES / $USDT pool had been drained using fake tokens.</p><p>The following analysis is taken from the official DODO release, with thanks to <a href="https://twitter.com/samczsun">@samczsun</a>, <a href="https://twitter.com/tzhen">@tzhen</a>, <a href="https://twitter.com/peckshield">PeckShield</a>, and <a href="https://twitter.com/SlowMist_Team">SlowMist</a>.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/dodo-linebreak.png"/></figure></p><p><strong>The exploits targeted several DODO V2 Crowdpools, namely the WSZO, WCRES, ETHA, and FUSI pools.</strong></p><p>In total, approximately $3.8 million, of which $1.88 million is expected to be returned (see below for more information), was drained as a result of these exploits.</p><p>The DODO V2 Crowdpooling smart contract has a bug that allows the init() function to be called multiple times. This means that an exploiter can perform an attack with the following steps:</p><p><strong>1.</strong> Exploiter creates a counterfeit token and initialize the smart contract with it by calling the init() function</p><p><strong>2.</strong> Exploiter calls the sync() function and sets the “reserve” variable, which represents the token balance, to 0</p><p><strong>3.</strong> Exploiter calls init() again to re-initialize - this time with a “real” token (i.e. tokens in DODO’s pools)</p><p><strong>4.</strong> Exploiter uses a flash loan to transfer all real tokens from the pools and bypass the flash loan check</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/dodo-suspects.png"/></figure></p><p><strong>In summary, there are two individuals involved in this exploit. We will refer to them as Individual A and Individual B.</strong></p><p>Individual B has all the hallmarks of a frontrunning bot, because:</p><ul><li>They constructed their contract address with a prefix of several 0s</li><li>They use the CHI gastoken</li><li>They set extremely high gas prices; in one instance they raise configured the transaction to use 93,148 gwei.</li></ul><p>In addition, Individual B’s exploits preceded Individual A’s successful exploits by roughly ten minutes.</p><p><strong>Individual A</strong></p><p><a href="https://etherscan.io/address/0x368a6558255bccac517da5106647d8182c571b23">Individual A</a> has already contacted the DODO team through samczsun and offered to send back the funds removed from DODO pools. Here is a detailed account of Individual A’s actions:</p><blockquote><p>Individual A interacted with a centralized exchange.</p></blockquote><p>Individual A <a href="https://etherscan.io/tx/0x970b32a8c81dd3fc47fa118621726fc418ec3526c4379470a4000ed7b448360f">withdrew</a> 0.46597 ETH from Binance:</p><p>Individual A <a href="https://etherscan.io/tx/0x300de107cbca466abe121112848daaf7f5f0d15625d54773dd0bbbff4e276e93">executed</a>, in quick succession, 7 BUSD withdrawal transactions (see the link for one example), possibly involving the Binance Bridge:</p><blockquote><p>Individual A transfer their funds to another wallet address.</p></blockquote><p>Individual A transferred 67,416 BUSD to 0xa305fab8bda7e1638235b054889b3217441dd645 twice - <a href="https://etherscan.io/tx/0x306d08f3d8af85dfdea7a6edb336d7504e8ecc7c609e4b940d188ba68e11cab5">ONE</a> - <a href="https://etherscan.io/tx/0x56dbf6421c6e6bd779ab0c12fd49e1f7714dd85023aa74abae1940f8d88669cf">TWO</a></p><p>Individual A transferred 59,245.324743 USDT to 0xa305fab8bda7e1638235b054889b3217441dd645 twice: <a href="https://etherscan.io/tx/0xbee2f507b2f4b4321927a9762dac757df12fe1ba2d6f85314273b9ea542a5c13">ONE</a> <a href="https://etherscan.com/tx/0xaf80cf58c88f0e0f2f44e3902e4c7cd2c17122511fbc6c2d9b2cd43fbc4199b9">TWO</a></p><p>Individual A executed two exploits against DODO smart contracts.</p><p>The first one was against the DODO-USDT test contract, and funds were <a href="https://etherscan.io/address/0x328410f276d4fe83fc78fa56ad32d9821a5e5c1c#tokentxns">transferred</a> to 0xa305fab8bda7e1638235b054889b3217441dd645.</p><p>The second one was against the WCRES-USDT contract, and funds were <a href="https://etherscan.com/address/0x910fd17b9bfc42a6eea822912f036ef5a080be8a#tokentxns">transferred</a> to 0x56178a0d5f301baf6cf3e1cd53d9863437345bf9.</p><p><strong>The funds are now in the following two addresses:</strong></p><p><a href="https://etherscan.io/address/0xa305fab8bda7e1638235b054889b3217441dd645">0xa305fab8bda7e1638235b054889b3217441dd645</a></p><p><a href="https://etherscan.io/address/0x56178a0d5f301baf6cf3e1cd53d9863437345bf9">0x56178a0d5f301baf6cf3e1cd53d9863437345bf9</a></p><p><strong>Individual B</strong></p><p>Individual B is most likely a bot. <em>(a robododo)</em></p><p><strong>Suspected bot smart contract:</strong> 0x00000000e84f2bbdfb129ed6e495c7f879f3e634</p><p><strong>Trigger account address:</strong> 0x3554187576ec863af63eea81d25fbf6d3f3f13fc</p><p><strong>Individual B executed 3 exploits against DODO contracts:</strong></p><p><strong>ETHA-USDT:</strong> <a href="https://etherscan.io/tx/0x0b062361e16a2ea0942cc1b4462b6584208c8c864609ff73aaa640aaa2d92428">0x0b062361e16a2ea0942cc1b4462b6584208c8c864609ff73aaa640aaa2d92428</a></p><p><strong>WSZO-USDT:</strong> <a href="https://etherscan.io/tx/0xff9b3b2cb09d149762fcffc56ef71362bec1ef6a7d68727155c2d68f395ac1e8">0xff9b3b2cb09d149762fcffc56ef71362bec1ef6a7d68727155c2d68f395ac1e8</a></p><p><strong>vETH-WETH, with 93,148 gwei:</strong> <a href="https://etherscan.io/tx/0x561f7ccb27b9928df33fa97c2fb99ea3750593e908f9f0f8baf22ec7ca0c5c4a">0x561f7ccb27b9928df33fa97c2fb99ea3750593e908f9f0f8baf22ec7ca0c5c4a</a></p><p><strong>The funds are currently in the following two addresses:</strong></p><p><a href="https://etherscan.io/address/0x00000000e84f2bbdfb129ed6e495c7f879f3e634">0x00000000e84f2bbdfb129ed6e495c7f879f3e634</a></p><p><a href="https://etherscan.io/address/0x3554187576ec863af63eea81d25fbf6d3f3f13fc">0x3554187576ec863af63eea81d25fbf6d3f3f13fc</a></p><p>The DODO team are currently trying to contact the owners of the above addresses.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/dodo-linebreak2.png"/></figure></p><p><strong>A relatively small sum of $2 million taken by an anonymous actor.</strong></p><p>It’s likely that the colour of the hat changes according to the sums of money that are available.</p><blockquote><p>Small sum = white hat for clout - Big sum = take it and add it to the other millions.</p></blockquote><p><strong>We can only imagine the personal treasuries that these individuals are accumulating.</strong> There is so much opportunity out there, and not just for those who choose to learn to code.</p><p>It’s noteworthy that even the teams themselves rely on Twitter for updates on their own protocols. This serves as a reminder that we truly are still in the early stages of this industry.</p><blockquote><p>The opportunity to make your name is clear - what you do with the power remains up to you.</p></blockquote><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/dodo-conc.png"/></figure></p><p>Image credits - <a href="https://harrikallio.com/portfolio/dodo-mauritius-island/">harrikallio.com</a> &amp; <a href="https://twitter.com/BxST23">@BxST23</a></p>