<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/yearn2-header.png"/></figure></p><p><strong>rekt in prod.</strong></p><p><em>…eventually.</em></p><p><strong>Over two years since its <a href="https://rekt.news/yearn-rekt/">first leaderboard entry</a>, Yearn has landed back on <a href="https://rekt.news/">rekt.news</a> having lost over $10M.</strong></p><p>Considered by many as one of DeFi’s most reliable, secure platforms, Yearn made it’s name by offering some of the sector’s simplest farming opportunities.</p><p>The immutable yUSDT contract that was attacked was <a href="https://etherscan.io/tx/0x947dfc6f73cccba391f2eb3fce5bc3be87bea3727ba5a23425f9f44db7f74d7a">deployed</a> over three years ago, back when Yearn was Andre Cronje’s iearn finance.</p><p>While the strategy was superceded by newer versions, plenty of funds still remained in the original contract. Later Yearn vault contracts <a href="https://twitter.com/iearnfinance/status/1646436798086672385">are not affected</a>.</p><p><em>Despite a last-minute <a href="https://twitter.com/urbittesweet/status/1646391151900114944">warning</a> on Twitter, immutable contracts can’t be saved.</em></p><p>Team member storming0x <a href="https://twitter.com/storming0x/status/1646408774477922305">acknowledged</a> the attack before Yearn <a href="https://twitter.com/iearnfinance/status/1646436798086672385">reassured</a> users that current contracts were unaffected.</p><p><strong>1156 days to spot a multimillion dollar vulnerability in one of DeFi’s longest established protocols.</strong></p><p><em>How did it take so long?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/09/rekt-investigates-linebreak.png"/></figure></p><p>Credit: <em><a href="https://twitter.com/samczsun/status/1646404331967778820">Samczsun</a>, <a href="https://twitter.com/osec_io/status/1646411672175939585">OtterSec</a>, <a href="https://twitter.com/SlowMist_Team/status/1646455406808666113">SlowMist</a></em></p><p><strong>The attacker exploited a misconfiguration in the iearn <a href="https://etherscan.io/address/0x83f798e925bcd4017eb265844fddabb448f1707d">yUSDT token contract</a>.</strong></p><p>The token generated yield via an underlying basket of yield-bearing tokens, including USDT positions on Aave, Compound, DYDX and BzX’s Fulcrum.</p><p>However, since launch, the yUSDT has contained what appears to be a copy/paste error whereby the Fulcrum USDC <a href="https://etherscan.io/address/0xF013406A0B1d544238083DF0B93ad0d2cBE0f65f">address</a> was used instead of the Fulcrum USDT contract.</p><p><strong>The exploiter was able to take advantage of the misconfiguration to vastly manipulate the underlying share prices of yUSDT, and mint a large quantity (1.2 quadrillion) of yUSDT using just 10k USDT.</strong></p><p>Theori’s junomon.eth <a href="https://twitter.com/junorouse/status/1646424901602123776">provided</a> the step-by-step analysis:</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/yearn2-steps.png"/></figure></p><p>Exploiter address 1: <strong><a href="https://etherscan.io/address/0x5bac20beef31d0eccb369a33514831ed8e9cdfe0">0x5bac20beef31d0eccb369a33514831ed8e9cdfe0</a></strong></p><p>Exploiter address 2: <strong><a href="https://etherscan.io/address/0x16af29b7efbf019ef30aae9023a5140c012374a5">0x16af29b7efbf019ef30aae9023a5140c012374a5</a></strong></p><p>Exploiter address 3: <strong><a href="https://etherscan.io/address/0x6f4a6262d06272c8b2e00ce75e76d84b9d6f6ab8">0x6f4a6262d06272c8b2e00ce75e76d84b9d6f6ab8</a></strong></p><p>Attack transaction 1: <strong><a href="https://etherscan.io/tx/0xd55e43c1602b28d4fd4667ee445d570c8f298f5401cf04e62ec329759ecda95d">0xd55e43c1…</a></strong></p><p>Attack transaction 2: <strong><a href="https://etherscan.io/tx/0x8db0ef33024c47200d47d8e97b0fcfc4b51de1820dfb4e911f0e3fb0a4053138">0x8db0ef33…</a></strong></p><p>The minted yUSDT was then swapped for other stables totalling $11.4M, BlockSec <a href="https://twitter.com/MetaSleuth/status/1646441750918217728">provided</a> the following breakdown:</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/yearn2-funds.png"/></figure></p><p>The attacker was <a href="https://etherscan.io/tx/0x8b3c6f46f0d52787d8ded61549237df4e22cda56aa785c09b6166491aa64d829">funded</a> via Tornado Cash and <a href="https://etherscan.io/address/0x16af29b7efbf019ef30aae9023a5140c012374a5?toaddress=0xd90e2f925da726b50c4ed8d0fb90ad053324f31b">redeposited 1000 ETH</a> for laundering. At the time of writing, the first two exploiter addresses contain approximately $1.5M of assets each, and address 3 contains 7.4M DAI.</p><p><em>Certik conducted an <a href="https://github.com/yearn/yearn-audits/blob/master/Certik%20-%20itoken-finance-audit-report-1.1.0.pdf">audit</a> of iearn finance in Feb 2020, however it appears that only the yDAI contract was investigated.</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p><strong>The test in prod attitude, Cronje’s preferred method, has been responsible for plenty of incidents, providing much of rekt.news’ early content.</strong></p><p><em>Generally, though, new protocols and features got rekt within hours or days, not years…</em></p><p><strong>In the wake of each attack, a <a href="https://rekt.news/decentralised-monopoly/">decentralised monopoly</a> began to grow.</strong></p><p>The wider Cronje-verse has experienced enough incidents to have its own leaderboard, as we <a href="https://rekt.news/cream-rekt-2/">discussed</a> after CREAM Finance was hacked for the second time, in October 2021.</p><p>Despite the significant losses, it’s lucky that this case only affected an old and deprecated strategy, and didn’t threaten the <a href="https://defillama.com/protocol/yearn-finance">$450M of TVL</a> across current Yearn strategies.</p><p>As we wrote <a href="https://rekt.news/yearn-rekt/">last time</a>:</p><blockquote><p>No protocol is too big to fail.</p></blockquote><p><em>First <a href="https://rekt.news/sushi-yoink-rekt/">Sushi</a>, now Yearn.</em></p><p><strong>It’s a big week for DeFi stalwarts getting rekt.</strong></p><p><em>Who will be next?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/rekt-outline-conc.png"/></figure></p>