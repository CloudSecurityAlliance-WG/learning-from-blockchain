<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/05/value2-header2png.png"/></figure></p><p><strong>2 for 1, that’s Value DeFi: The first protocol to feature twice on the <a href="https://www.rekt.news/leaderboard/">rekt leaderboard</a>.</strong></p><p>When we <a href="https://www.rekt.news/value-defi-rekt/">first covered</a> Value in November of 2020, they had just lost $7,000,000 after bragging about their “flash loan protection”.</p><p>Back then we learned that Value DeFi <em>did not really know flash loan</em>. Now they have lost another $10,000,000, and we find out that Value DeFi <em>do not really know copy paste</em> either, as they report the exploit was made possible due to losing a line of code by “human error”</p><p>Ten million dollars lost due to basic mistakes by the team, yet the native token <a href="https://www.coingecko.com/en/coins/value-defi">$VALUE</a> barely dumped at all.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/05/value2-price.png"/></figure></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/05/value2-investigates.png"/></figure></p><p><strong>The following analysis is taken from the official post-mortem.</strong></p><p>On May 5th 2021, 3:22 AM UTC, the exploiter <a href="https://bscscan.com/tx/0xd3382252bc204fdc32a6b3add8c639850882b70a798399d6e00a542cdf769040">re-initialized</a> the pool and set the operator role to himself and _stakeToken to HACKEDMONEY.</p><p>By doing so, the exploiter took control of the pool and called the method governanceRecoverUnsupported() and drained the original stake token (vBWAP/BUSD LP).</p><p>The exploiter then <a href="https://bscscan.com/tx/0x9ba0454c2301ad5780795ae7477e9fa7e38226be16cc282158624479e66389b6">removed 10,839.16 vBWAP/BUSD LP</a>, then burned the LP tokens and received 7342.75 vBSWAP and 205,659.22 BUSD.</p><p>The exploiter then sold all 7342.75 vBSWAP for 8790.77 BNB at 1inch.</p><p>The exploiter used both BNB and BUSD to buy renBTC and used renBridge to move the funds back to BTC, sent to the following address: <a href="https://www.blockchain.com/btc/address/1Cm6WGvXQ9EgvvWX5dRsBxE2NvxFjfbcVF">1Cm6WGvXQ9EgvvWX5dRsBxE2NvxFjfbcVF</a></p><p>The actions can be verified on-chain <a href="https://bscscan.com/tokentxns?a=0xef63ad578e75d498d0723e5420fa1962b1d28764">here</a>.</p><p>The <a href="https://bscscan.com/address/0x7a8ac384d3a9086afcc13eb58e90916f17affc89#code">affected pool contract</a> had an initialize() function that should have been activated after deployment.</p><p>The line: <strong>initialized = true</strong>; is missing from the function.</p><p>This meant anyone could re-initialize the pool and set themself as owner, thereby taking full control. As owner, the exploiter used the <strong>governanceRecoverUnsupported()</strong>, which is used for recovering pool funds in the event of a bug or undesired event.</p><p>During set up of the profit-sharing vStake pool, the code was not written from scratch but migrated from the old implementation of the Value DeFi Reserve Fund, which had the correct setting. When merging the code, the line was not included.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p><strong>In the end, the hacker was the only one who got their value for their money, a ten million dollar prize without even taking out a loan.</strong></p><p><em>The Value DeFi team however, just got another spot on our <a href="https://www.rekt.news/leaderboard/">leaderboard</a>.</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-text-linebreak.png"/></figure></p>