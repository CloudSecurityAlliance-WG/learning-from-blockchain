<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/05/bearn-header.png"/></figure>
<strong>Every weekend another one falls.</strong></p><p>Binance Smart Chain provides the easiest prey for the anonymous apex predator.</p><p>Hard-hearted hackers are fast to feast on copied code from developers keen to cut corners.</p><p><strong>Another week finished and another protocol with it.</strong></p><p><em>$18 million gone from bEarnFi.</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/05/bearn-investigates.png"/></figure></p><p>The following is taken from the <a href="https://peckshield.medium.com/bearn-fi-incident-inconsistent-asset-denomination-between-vault-strategy-9b24b68ab1c0">Peckshield</a> and <a href="https://bearn-defi.medium.com/bvaults-busd-alpaca-strategy-exploit-post-mortem-and-bearn-s-compensation-plan-b0b38c3b5540">bEarn analysis</a>.</p><p><strong>Starting at 10:36:20 AM +UTC, May 16, 2021, BearnFi’s BvaultsBank contract was exploited and approximately $18M funds were drained from the pool.</strong></p><p>The incident was made possible due to a bug in the internal withdraw logic, which inconsistently read the same input amount, but with different asset denominations between the BvaultsBank and the associated strategy BvaultsStrategy.</p><p>The BvaultsBank's withdraw logic assumes the withdrawn amount is denominated in BUSD while the BvaultsStrategy's withdraw logic assumes the withdrawn amount is denominated in ibBUSD.</p><p><strong>However, <a href="https://bscscan.com/token/0x7c9e73d4c71dae564d41f78d56439bb4ba87592f">ibBUSD</a> is an interest-bearing token and is more expensive than <a href="https://bscscan.com/token/0xe9e7cea3dedca5984780bafc599bd69add087d56">BUSD</a>.</strong></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/05/bearn-step.png"/></figure></p><p><strong>1:</strong> Borrow a flashloan from CREAM with 7,804,239.111784605253208456 BUSD, which is returned at the last step with necessary fee to cover the flash loan cost.</p><p><strong>2:</strong> Deposit the borrowed funds into BvaultsBank, which are immediately sent to the associated BvaultsStrategy strategy, then to Alpaca Vault for yield. Due to the above deposit, the Alpaca Vault mints 7,598,066.589501626344403426 ibBUSD back to BvaultsStrategy.</p><p><strong>3:</strong> Farm with the received 7,598,066.589501626344403426 ibBUSD via the Alpaca FairLaunch.</p><p><strong>4:</strong> Withdraws the 7,804,239.111784605253208533 BUSD from BvaultsBank, which is interpreted as withdrawing 7,804,239.111784605253208533 ibBUSD, the equivalent of 8,016,006.09792806917101481 BUSD.</p><p><strong>5:</strong> In the next round, the user still deposits 7,804,239.111784605253208533 BUSD into BvaultsBank, cascadingly to BvaultsStrategy. But with the previous leftover from the last round, BvaultsStrategy credits the user with 8,016,006.09792806917101481 BUSD, which is used for yield again via Alpaca.</p><p><strong>6:</strong> Repeat the above steps to continue accumulating the credit and finally exits by draining the pool.</p><p><strong>7:</strong> Return the flash loan with 7,806,580.383518140634784418 BUSD.</p><p>The attacker’s funds from the above exploitations were initially held in this wallet: <a href="https://bscscan.com/address/0x47f341d896b08daacb344d9021f955247e50d089">47f3</a>.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p><strong>Another week begins. Has the hacker returned richer to their day job, or do they attack on weekends as they expect less attention?</strong></p><p>The boom in BSC code copies has created a wealth of new opportunities for any developer who seeks to exploit protocols.
As we watch the rapid rise and fall of TVL on BSC, it becomes even more apparent that time is the most valuable audit of all.</p><p>Longevity suggests security, and vice versa.</p><p><em>How long until the next rekt comes along?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/05/bearn-conc.png"/></figure></p><blockquote><p>Photography by <a href="https://www.lesdoucheslagalerie.com/en/artists/2218-ray-k.-metzker/works/1302-ray-k.-metzker-early-philadelphia-1963/">Ray Metzker</a></p></blockquote>