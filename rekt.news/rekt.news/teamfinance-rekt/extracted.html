<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2022/10/teamfi-header.png"/></figure></p><p><strong>Four projects got rugged through their shared anti-rug mechanism.</strong></p><p><a href="https://twitter.com/TeamFinance_">Team Finance</a>, the self-proclaimed “<em>Industry Leader In Project Security &amp; Automation</em>”, lost <a href="https://twitter.com/peckshield/status/1585587858978623491?s=20&amp;t=JIa5322R7nAnqNfbcBT_ag">$15.8M</a> of funds that it was supposed to be safeguarding.</p><p>Of the four pools drained, <a href="https://twitter.com/FEGtoken">FEG</a>, <a href="https://twitter.com/CommunityCaw">Caw</a>, and <a href="https://twitter.com/Kondux_KNDX">Kondux</a> were the worst hit. <a href="https://twitter.com/Dejitaru_Tsuka/">Tsuka</a> was also affected, but experienced less price impact due to a secondary <a href="https://twitter.com/Dejitaru_Tsuka/status/1585578999484399618">liquidity pool on Uniswap v3.</a></p><p>The project’s website claims to protect over $2.5B of assets, but considering the low liquidity of their selection of shitcoins, we can consider this claim to be optimistic at best.</p><p><strong>#46 on the <a href="https://rekt.news/leaderboard/">leaderboard</a>.</strong></p><p><em>Teamwork.</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/09/rekt-investigates-linebreak.png"/></figure></p><p><em>Credit: <a href="https://twitter.com/peckshield/status/1585587858978623491">Peckshield</a></em></p><p>The <a href="https://twitter.com/TeamFinance_/status/1585562380591063043">announcement</a> of the hack explained that the exploit targeted “<em>the audited v2 to v3 migration function.</em>”</p><p>The vulnerability was contained in one of the <a href="https://docs.team.finance/token-locks/liquidity-locks">Liquidity Locks</a>’ “bulletproof smart contracts” which allowed projects to migrate locked LP positions from Uni v2 to Uni v3.</p><p>According to Peckshield’s <a href="https://twitter.com/peckshield/status/1585587858978623491">analysis</a>:</p><blockquote><p>The protocol has a flawed migrate() that is exploited to transfer real UniswapV2 liquidity to an attacker-controlled new V3 pair with skewed price, resulting in huge leftover as the refund for profit. Also, the authorized sender check is bypassed by locking any tokens.</p></blockquote><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2022/10/teamfi-code.png"/></figure></p><p><strong>The breakdown of the loss to each project’s Uniswap v2 pool is as follows:</strong></p><p>$11.5M CAW</p><p>$1.7M TSUKA</p><p>$0.7M KNDX</p><p>$1.9M FEG</p><p><strong>Exploiter address 1:</strong> <a href="https://etherscan.io/address/0x161cebb807ac181d5303a4ccec2fc580cc5899fd">0x161cebb807ac181d5303a4ccec2fc580cc5899fd</a></p><p><strong>Exploiter address 2 (containing stolen funds):</strong> <a href="https://etherscan.io/address/0xba399a2580785a2ded740f5e30ec89fb3e617e6e">0xba399a2580785a2ded740f5e30ec89fb3e617e6e</a></p><p><strong>Attack tx:</strong> <a href="https://etherscan.io/tx/0xb2e3ea72d353da43a2ac9a8f1670fd16463ab370e563b9b5b26119b2601277ce">0xb2e3ea72…</a></p><p><strong>Attacker’s contract:</strong> <a href="https://etherscan.io/address/0xcff07c4e6aa9e2fec04daaf5f41d1b10f3adadf4">0xcff07c4e6aa9e2fec04daaf5f41d1b10f3adadf4</a></p><p>The vulnerable migrate() function was included in Zokyo Security’s <a href="https://github.com/trustswap/audits/blob/main/TrustSwap%20(token%20lock)%20audit%20report.pdf">audit</a> of Team Finance contracts from August this year.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p><strong>“DAO tooling” was amongst the most popular buzzwords throughout the last cycle.</strong></p><p>For small, anon teams working on innovative protocols, it may be tempting to outsource trust to a third party. But given the array of shitcoins “secured” by Team Finance, the vaults seem more likely to be a way for projects to appear trustworthy by proxy.</p><p><strong>Now that it’s clear that trust has been lost.</strong></p><p><em>Will this protocol take one for the team and reimburse the victims, or is it every man for himself?</em></p><p><strong>There’s no $ in Team.</strong></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/rekt-outline-conc.png"/></figure></p>