<!DOCTYPE html><html lang="en"><head><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><script>!function(){try{let t=document.documentElement,e=window.localStorage,u=!!e&&e.getItem("REKT_THEME"),l=!u||"null"===u;l?t.setAttribute("data-theme","light"):t.setAttribute("data-theme",u),l?e.setItem("REKT_THEME","light"):e.setItem("REKT_THEME",u)}catch(t){console.error(t)}}();</script><title>Rekt - Poly Network - REKT</title><meta name="description" content="DeFi / Crypto - This is it rekt readers; the big one. $611M stolen from Poly Network, but has the hacker had a change of heart? They&#x27;re returning the money bit by bit."/><meta charSet="utf-8"/><link rel="icon" href="https://raw.githubusercontent.com/RektHQ/Assets/main/images/favicon.png" type="image/png"/><link rel="canonical" href="https://www.rekt.news/"/><meta name="HandheldFriendly" content="True"/><meta name="MobileOptimized" content="320"/><meta name="viewport" content="initial-scale=1.0, width=device-width"/><meta name="og:title" content="Rekt - Poly Network - REKT"/><meta property="og:description" content="DeFi / Crypto - This is it rekt readers; the big one. $611M stolen from Poly Network, but has the hacker had a change of heart? They&#x27;re returning the money bit by bit."/><meta property="og:image" content="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/poly-header.png"/><meta property="og:url" content="https://www.rekt.news/"/><meta property="og:type" content="website"/><meta property="og:site_name" content="rekt"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Rekt - Poly Network - REKT"/><meta name="twitter:description" content="DeFi / Crypto - This is it rekt readers; the big one. $611M stolen from Poly Network, but has the hacker had a change of heart? They&#x27;re returning the money bit by bit."/><meta name="twitter:image" content="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/poly-header.png"/><meta name="twitter:url" content="https://www.rekt.news/"/><meta name="twitter:site" content="@RektHQ"/><link rel="preconnect" href="https://fonts.gstatic.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-5T3NB49M5Z"></script><script async="">function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-5T3NB49M5Z");</script><meta name="next-head-count" content="25"/><link rel="preload" href="/_next/static/css/9c013821832ca464.css" as="style"/><link rel="stylesheet" href="/_next/static/css/9c013821832ca464.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-c66a1cc0a3689c22.js" defer=""></script><script src="/_next/static/chunks/framework-91d7f78b5b4003c8.js" defer=""></script><script src="/_next/static/chunks/main-21be7f478156ec90.js" defer=""></script><script src="/_next/static/chunks/pages/_app-98c26249b3577d95.js" defer=""></script><script src="/_next/static/chunks/1bfc9850-ae7db91564636cad.js" defer=""></script><script src="/_next/static/chunks/496-567bdf7e1a65088d.js" defer=""></script><script src="/_next/static/chunks/797-4f7bae3bf88a8fc0.js" defer=""></script><script src="/_next/static/chunks/397-40bc52d4d845e709.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bslug%5D-a276320282c1bc83.js" defer=""></script><script src="/_next/static/WkT8kkBHr4E_kKmh-8mlL/_buildManifest.js" defer=""></script><script src="/_next/static/WkT8kkBHr4E_kKmh-8mlL/_ssgManifest.js" defer=""></script><script src="/_next/static/WkT8kkBHr4E_kKmh-8mlL/_middlewareManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css2?family=Roboto+Mono:ital,wght@0,400;0,500;0,600;0,700;1,400&display=swap">@font-face{font-family:'Roboto Mono';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xoDF4xlVMF-BfR8bXMIjhOsXG-q2oeuFoqFrlnAOW-.woff) format('woff')}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vqPQA.woff) format('woff')}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_7PqPQA.woff) format('woff')}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_AP2PQA.woff) format('woff')}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_Of2PQA.woff) format('woff')}@font-face{font-family:'Roboto Mono';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xoDF4xlVMF-BfR8bXMIjhOsXG-q2oeuFoqFrlnANW3Cp-eTIwsa4YaDA.woff) format('woff');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto Mono';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xoDF4xlVMF-BfR8bXMIjhOsXG-q2oeuFoqFrlnANW-Cp-eTIwsa4YaDA.woff) format('woff');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto Mono';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xoDF4xlVMF-BfR8bXMIjhOsXG-q2oeuFoqFrlnANW5Cp-eTIwsa4YaDA.woff) format('woff');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Roboto Mono';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xoDF4xlVMF-BfR8bXMIjhOsXG-q2oeuFoqFrlnANW1Cp-eTIwsa4YaDA.woff) format('woff');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto Mono';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xoDF4xlVMF-BfR8bXMIjhOsXG-q2oeuFoqFrlnANW0Cp-eTIwsa4YaDA.woff) format('woff');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto Mono';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xoDF4xlVMF-BfR8bXMIjhOsXG-q2oeuFoqFrlnANW6Cp-eTIwsa4Y.woff) format('woff');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSV0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSx0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSt0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSd0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSZ0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSh0me8iUI0.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSV0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSx0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSt0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSd0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSZ0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSh0me8iUI0.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSV0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSx0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSt0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSd0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSZ0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSh0me8iUI0.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSV0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSx0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSt0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSd0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSZ0me8iUI0lkQ.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v23/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSh0me8iUI0.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next" data-reactroot=""><div class="post-template"><header class="site-head"><div class="site-head-content inner"><a href="/"><img class="site-logo inv-asset" src="https://raw.githubusercontent.com/rekthq/assets/main/images/logo.svg" alt="logo"/></a><nav><a class="nav-item " href="/termAndConditions/">T&amp;C</a><span class="divider"></span><a class="nav-item " href="/leaderboard/">leaderboard</a><span class="divider"></span><span class="theme-picker nav-item">dark</span><span class="divider"></span><div class="lang-picker"><span class="lang-picker-selected">en<span class="lang-picker-arrow">▼</span></span><div class="lang-picker-options"></div></div></nav></div></header><main class="content" role="main"><article class="post"><header class="post-header"><h1 class="post-title">Poly Network - REKT</h1><hr/><span class="post-meta"><time>Wednesday, August 11, 2021</time><p><span><a href="/?tag=Poly+Network">Poly Network</a></span><span> - <a href="/?tag=REKT">REKT</a></span></p></span><hr/><span class="post-meta">read this article also in<!-- -->:<p><span><a href="/polynetwork-rekt/">en</a></span><span> - <a href="/es/polynetwork-rekt/">es</a></span><span> - <a href="/fr/polynetwork-rekt/">fr</a></span><span> - <a href="/ko/polynetwork-rekt/">ko</a></span><span> - <a href="/ru/polynetwork-rekt/">ru</a></span><span> - <a href="/tr/polynetwork-rekt/">tr</a></span><span> - <a href="/zh/polynetwork-rekt/">zh</a></span></p></span></header><section class="post-content"><p><figure><img src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/poly-header.png" alt=""/></figure></p><p><strong>This is it rekt readers; the big one.</strong></p><p><em>$611 million dollars stolen.</em></p><p>That’s more than the <a href="https://www.bloomberg.com/news/articles/2014-02-28/mt-gox-exchange-files-for-bankruptcy">Mt Gox hack</a>. More than the GDP of several small countries. More than the entire rekt.news leaderboard added together.</p><p><strong>The biggest cryptocurrency hack... <em>ever</em>.</strong></p><blockquote><p><a href="https://twitter.com/PolyNetwork2/status/1425130017546149891">Poly Network</a> = rekt.</p></blockquote><p><em>But how?</em></p><p><figure><img src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/poly-investigates.png" alt=""/></figure></p><p><em>Credit:</em><a href="https://www.breadcrumbs.app/reports/671">breadcrumbs.app</a>, <a href="https://twitter.com/SlowMist_Team/status/1425197809058254849?s=20">slowmist</a>, <a href="https://blocksecteam.medium.com/the-initial-analysis-of-the-polynetwork-hack-270ac6072e2a">blocksec</a></p><p><strong>Attacker ETH:</strong> <a href="https://etherscan.io/address/0xc8a65fadf0e0ddaf421f28feab69bf6e2e589963">0xc8a65fadf0e0ddaf421f28feab69bf6e2e589963</a></p><p><strong>Attacker BSC:</strong> <a href="https://bscscan.com/address/0x0D6e286A7cfD25E0c01fEe9756765D8033B32C71">0x0D6e286A7cfD25E0c01fEe9756765D8033B32C71</a></p><p><strong>This was not the usual smart contract flash loan / arbitrage affair.</strong></p><p><strong>The hacker exploited the Proxy Lock Contracts of Poly Network on three different chains.</strong></p><p><strong>Ethereum:</strong><a href="https://etherscan.io/address/0x250e76987d838a75310c34bf422ea9f1ac4cc906">0x250e76987d838a75310c34bf422ea9f1ac4cc906</a></p><p><strong>BSC:</strong><a href="https://bscscan.com/address/0x05f0fDD0E49A5225011fff92aD85cC68e1D1F08e">0x05f0fDD0E49A5225011fff92aD85cC68e1D1F08e</a></p><p><strong>Polygon:</strong><a href="https://polygonscan.com/address/0x28FF66a1B95d7CAcf8eDED2e658f768F44841212">0x28FF66a1B95d7CAcf8eDED2e658f768F44841212</a></p><blockquote><p>Credit: <a href="https://twitter.com/kelvinfichter">@kelvinfichter</a></p></blockquote><p><strong>&quot;Poly has a contract called the &quot;<strong>EthCrossChainManager</strong>&quot;. It&#x27;s a privileged contract that has the right to trigger messages from another chain. It&#x27;s a standard thing for cross-chain projects.</strong></p><p>It has a function named <strong>verifyHeaderAndExecuteTx</strong> that anyone can call to execute a cross-chain transaction.</p><p>It (1) verifies that the block header is correct by checking signatures (seems the other chain was a poa sidechain or) and then (2) checks that the transaction was included within that block with a Merkle proof. <a href="https://github.com/polynetwork/eth-contracts/blob/d16252b2b857eecf8e558bd3e1f3bb14cff30e9b/contracts/core/cross_chain_manager/logic/EthCrossChainManager.sol#L127">Here&#x27;s the code.</a></p><p>One of the last things the function does is call <strong>executeCrossChainTx</strong>, which makes the call to the target contract. This is where the critical flaw sits. <a href="https://github.com/polynetwork/eth-contracts/blob/d16252b2b857eecf8e558bd3e1f3bb14cff30e9b/contracts/core/cross_chain_manager/logic/EthCrossChainManager.sol#L185">Poly checks</a> that the target is a contract, but they forgot to prevent users from calling a very important target... the <a href="https://github.com/polynetwork/eth-contracts/blob/master/contracts/core/cross_chain_manager/data/EthCrossChainData.sol"><strong>EthCrossChainData</strong> contract</a></p><p>By sending this cross-chain message, the user could trick the <strong>EthCrossChainManager</strong> into calling the <strong>EthCrossChainData</strong> contract, passing the <strong>onlyOwner</strong> check. Now the user just had to craft the right data to be able to trigger the function that changes the public keys…</p><p>The only remaining challenge was to figure out how to make the <strong>EthCrossChainManager</strong> call the right function. Now comes a little bit of complexity around how Solidity picks which function you&#x27;re trying to call.</p><p>The first four bytes of transaction input data is called the &quot;signature hash&quot; or &quot;sighash&quot; for short. It&#x27;s a short piece of information that tells a Solidity contract what you&#x27;re trying to do.</p><p>The sighash of a function is calculated by taking the first four bytes of the hash of &quot;<!-- -->&lt;function name&gt;<!-- -->(<!-- -->&lt;function input types&gt;<!-- -->)&quot;. For example, the sighash of the ERC20 transfer function is the first four bytes of the hash of &quot;transfer(address,uint256)&quot;.</p><p>Poly&#x27;s contract was willing to call any contract. However, it would only call the contract function that corresponded to the following sighash:</p><p><figure><img src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/poly-sighash.png" alt=""/></figure></p><p>Errr but wait... <strong>&quot;_method&quot;</strong> here was user input. All the attacker had to do to call the right function was figure out <em>some</em> value for &quot;<strong>_method</strong>&quot; that, when combined with those other values and hashed, had the same leading four bytes as the sighash of our target function.</p><p>With just a little bit of grinding, you can easily find some input that produces the right sighash. You don&#x27;t need to find a full hash collision, you&#x27;re only checking the first four bytes. So is this theory correct?</p><p>Well... here&#x27;s the actual sighash of the target function:</p><blockquote><p><a href="http://ethers.utils.id">http://ethers.utils.id</a> (&#x27;putCurEpochConPubKeyBytes(bytes)&#x27;).slice(0, 10)</p></blockquote><p>&#x27;0x41973cd9&#x27;</p><p>And the sighash that the attacker crafted...</p><blockquote><p><a href="http://ethers.utils.id">http://ethers.utils.id</a> (&#x27;f1121318093(bytes,bytes,uint64)&#x27;).slice(0, 10)</p></blockquote><p>&#x27;0x41973cd9&#x27;</p><p><strong>Fantastic. No private key compromise required! Just craft the right data and boom... the contract will just hack itself!</strong></p><p>One of the biggest design lessons that people need to take away from this is: if you have cross-chain relay contracts like this, <strong>MAKE SURE THAT THEY CAN&#x27;T BE USED TO CALL SPECIAL CONTRACTS.</strong> The <strong>EthCrossDomainManager</strong> shouldn&#x27;t have owned the <strong>EthCrossDomainData</strong> contract.</p><p>Separate concerns. If your contract absolutely needs to have special privileges like this, make sure that users can&#x27;t use cross-chain messages to call those special contracts.&quot;</p><p><figure><img src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png" alt=""/></figure></p><blockquote><p>On the Ethereum blockchain, the hacker stole</p></blockquote><p><strong>USDC</strong> - 96,389,444</p><p><strong>WBTC</strong> - 1,032</p><p><strong>DAI</strong> - 673,227</p><p><strong>UNI</strong> - 43,023</p><p><strong>SHIBA</strong> - 259,737,345,149</p><p><strong>renBTC</strong>- 14.47</p><p><strong>USDT</strong> - 33,431,197</p><p><strong>wETH</strong> - 26,109</p><p><strong>FEI USD</strong> - 616,082</p><blockquote><p>On BSC, the hacker stole:</p></blockquote><p><strong>BNB</strong> - 6,613.44</p><p><strong>USDC</strong> - 87,603,373</p><p><strong>ETH</strong> - 299</p><p><strong>BTCB</strong> - 26,629</p><p><strong>BUSD</strong> - 1,023</p><blockquote><p>On the Polygon blockchain, the hacker stole:</p></blockquote><p><strong>USDC</strong> - 85,089,610</p><blockquote><p>TOTAL VALUE LOST - ~$611,000,000</p></blockquote><p><em>At the time of writing, the stolen funds are located in the following wallets:</em></p><p><strong>ETH:</strong> <a href="https://etherscan.io/address/0xC8a65Fadf0e0dDAf421F28FEAb69Bf6E2E589963">0xC8a65Fadf0e0dDAf421F28FEAb69Bf6E2E589963</a></p><p><strong>BSC:</strong> <a href="https://bscscan.com/address/0x0D6e286A7cfD25E0c01fEe9756765D8033B32C71">0x0D6e286A7cfD25E0c01fEe9756765D8033B32C71</a></p><p><strong>Polygon:</strong> <a href="https://polygonscan.com/address/0x5dc3603C9D42Ff184153a8a9094a73d461663214">0x5dc3603C9D42Ff184153a8a9094a73d461663214</a></p><p><figure><img src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png" alt=""/></figure></p><p><strong>DeFi storylines are rarely straightforward, and this one is no exception.</strong></p><p><em>Even anonymous actors adore attention.</em></p><p>Shortly after the exploit, an unexpected protagonist appeared, going by the name of <a href="https://etherscan.io/address/0xf8b5c45c6388c9ee12546061786026aaeaa4b682">hanashiro.eth.</a></p><p>hanashiro.eth first gained attention when they <a href="https://etherscan.io/tx/0xae2442c5b5721df8c190fd8f59b53b6dc56a875fb03035ad34276a598ddf7d31">sent the hacker</a> a tip about how to handle USDT, for which they <a href="https://etherscan.io/tx/0xdf3afc47c7914e06ddb1be19afcd769e558111d353e55273a62c4a96e6a6090f">received 13.37 Ether</a> from the hacker as a reward.</p><p><strong><a href="https://twitter.com/JustDoingItBig/status/1425115724209655812?s=20">Many others</a> sent messages to the hacker afterwards, but none were quite as successful as hanashiro.eth.</strong></p><p>With a truly crypto native level of philanthropic showmanship, hanashiro.eth went on to donate their stolen money to a few of the foundational organisations which support our industry, such as Infura, Etherscan, and <a href="https://www.rekt.news/">rekt.news</a>.</p><p><em>But not all of the funds were so freely accessible.</em></p><p><a href="https://twitter.com/paoloardoino/status/1425090760609832978?s=20">Tether froze all of the 33M USDT</a> that were stolen on the Ethereum chain.</p><p><strong>Their coin - their choice… A fact worth remembering if you use USDT.</strong></p><p>By this point the shit had really hit the fan; and all eyes were on <a href="https://twitter.com/PolyNetwork2/status/1425123153009803267">Poly Network, who resorted to posting an open letter</a> to the attacker begging them to return the funds.</p><p><strong>A single tweet asking a criminal to return six hundred million dollars... Maybe Gensler was right when he said we are in the <a href="https://www.reuters.com/technology/us-sec-chair-gensler-calls-congress-help-rein-crypto-wild-west-2021-08-03/">“Wild West”</a> phase of cryptocurrency.</strong></p><p>Consider the mindset of the attacker at this point in the story. Which do you think they felt more; euphoria, or terror?</p><p><strong>Stealing 600 million dollars whilst sat at your computer must be a surreal experience.</strong></p><p><em>The experience of then trying to launder that money must be equally intense.</em></p><p>Aside from JPEGS, tornado.cash would be the obvious starting point, and that’s exactly where our hacker went.</p><p>They <a href="https://twitter.com/UnderTheBreach/status/1425119885978447875?s=20">sent themself a transaction</a> containing the message;</p><blockquote><p>Wonder why Tornado? Will miners stop me? Teach me please</p></blockquote><p><strong>Was that psyops or stupidity? In crypto it’s never quite clear...</strong></p><p><strong>On the run with 600 million, and broadcasting messages to an audience of thousands.</strong></p><p><em>The hacker was growing too confident.</em></p><p><figure><img src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/poly-fallout.png" alt=""/></figure></p><p><strong>When <a href="https://twitter.com/wardbradt/status/1425112492397764609?s=20">@WardBradt</a> tweeted the following;</strong></p><blockquote><p>Did the PolyNetwork Exploiter accidentally use the wrong sender address for this tx <a href="https://t.co/SXS7F6iJsM?amp=1">0xb12681d9e</a>? The sender address is tied to FTX, Binance, Okex accounts.</p></blockquote><p><strong>Suddenly the attacker&#x27;s attitude changed.</strong></p><p>Surely a hacker who feels confident enough to attempt an attack of this scale wouldn’t make such a basic OPSEC error? Or maybe they used fake KYC documents…</p><p><em>Either way, we began to see signs of fear from the attacker.</em></p><p>The hacker <a href="https://twitter.com/UnderTheBreach/status/1425127303353356293?s=20">began to suggest</a> that they might return <em>&quot;some tokens&quot;</em> or even abandon them, saying that they were <em>&quot;not so interested in the money&quot;.</em></p><p><a href="https://twitter.com/sniko_/status/1425135792658255877?s=20">Then the hacker considered the idea</a> of creating a DAO to distribute the stolen funds.</p><p><strong>Finally, the pressure became too much, and the hacker announced that they were <a href="https://etherscan.io/tx/0x7b6009ea08c868d7c5c336bf1bc30c33b87a0eedd59dac8c26e6a8551b20b68a">“READY TO SURRENDER”</a></strong></p><p><strong>In an unexpected and unprecedented move, the attacker is now returning the funds to Poly Network.</strong></p><p>They announced that they were <a href="https://etherscan.io/tx/0x7b6009ea08c868d7c5c336bf1bc30c33b87a0eedd59dac8c26e6a8551b20b68a">&quot;READY TO RETURN THE FUNDS!&quot;</a> in an Ethereum transaction that was sent from the same wallet used for the attack.</p><p>Before sending the first return transaction, the hacker created a token called &quot;The hacker is ready to surrender&quot; and sent this token to Poly Network who announced that they had set up a <a href="https://twitter.com/PolyNetwork2/status/1425321860539949056">multisig controlled by ‘’known Poly addresses’’</a>.</p><p><a href="https://docs.google.com/spreadsheets/u/1/d/11LUJwLoHX8ZCyfjhg5YZ0V99iU6PafMNL_NET45FSVc/htmlview?pru=AAABe1lDAS0*CdZKWo5WZNYwj5Qca8505A#gid=0">A summary of the hackers&#x27; communication with Poly Network can be found here.</a></p><p><strong>At the time of writing, the hacker has returned the following:</strong></p><p>On the Ethereum blockchain: <a href="https://etherscan.io/address/0x71fb9db587f6d47ac8192cd76110e05b8fd2142f#tokentxns">$2.6M</a></p><p>On the BSC: <a href="https://bscscan.com/address/0xEEBb0c4a5017bEd8079B88F35528eF2c722b31fc">$1.1M</a></p><p>On the Polygon blockchain: <a href="https://polygonscan.com/address/0xa4b291ed1220310d3120f515b5b7accaecd66f17">$1M</a></p><p><strong>Will the hacker continue to return the funds, or is this just another stunt?</strong></p><p><em>Can they really just return the money and be forgiven?</em></p><p><figure><img src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png" alt=""/></figure></p><p><strong>Poly Network. 611 million.</strong></p><p><em>And you thought you knew all the big protocols in DeFi.</em></p><p><strong>This industry has grown bigger than our echo chamber can handle.</strong></p><p>This may be the first, but it won’t be the last hack of this size that we will see over the coming years. Yet the market seems unfazed, and rightly so.</p><p>For <a href="https://finance.yahoo.com/news/coinbase-crushes-q2-expectations-notes-210643795.html">better</a> or for <a href="https://www.coindesk.com/bitmex-announces-100m-cftc-fincen-settlement">worse</a>, crypto will make the news, and the <a href="https://twitter.com/NeerajKA/status/1423721468123287556?s=20">world will have to take notice</a> as our industry becomes the norm.</p><p><em>This is just another inevitable part of the progress.</em></p><p><figure><img src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/poly-conc.png" alt=""/></figure></p><div id="mc_embed_signup"><hr/><form action="https://doshbot.us8.list-manage.com/subscribe/post?u=4db8948c1d40f1c0e7af494fd&amp;id=798585766e" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate=""><div id="mc_embed_signup_scroll" class="newsletter-form"><h2 class="newsletter-header">SUBSCRIBE<!-- --> <!-- -->NOW</h2><div class="newsletter-group"><div class="newsletter-input-group"><label>email address<!-- --> <span class="asterisk">*</span></label><input type="email" placeholder="anon@rekt.news" name="EMAIL" class="required email newsletter-input" id="mce-EMAIL" value=""/></div><div class="newsletter-submit"><input type="submit" value="subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"/></div></div><div style="position:absolute;left:-5000px" aria-hidden="true"><input type="text" name="b_4db8948c1d40f1c0e7af494fd_798585766e" value=""/></div></div></form></div><footer class="post-footer"><p>share this article</p><section><a target="_blank" rel="noopener noreferrer" href="https://twitter.com/share?text=Poly Network - REKT&amp;url=false"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></a><a target="_blank" rel="noopener noreferrer" href="https://www.facebook.com/sharer/sharer.php?u=false"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M279.14 288l14.22-92.66h-88.91v-60.13c0-25.35 12.42-50.06 52.24-50.06h40.42V6.26S260.43 0 225.36 0c-73.22 0-121.08 44.38-121.08 124.72v70.62H22.89V288h81.39v224h100.17V288z"></path></svg></a><a target="_blank" rel="noopener noreferrer" href="https://t.me/share/url?url=false"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M446.7 98.6l-67.6 318.8c-5.1 22.5-18.4 28.1-37.3 17.5l-103-75.9-49.7 47.8c-5.5 5.5-10.1 10.1-20.7 10.1l7.4-104.9 190.9-172.5c8.3-7.4-1.8-11.5-12.9-4.1L117.8 284 16.2 252.2c-22.1-6.9-22.5-22.1 4.6-32.7L418.2 66.4c18.4-6.9 34.5 4.1 28.5 32.2z"></path></svg></a></section></footer><p>REKT serves as a public platform for anonymous authors, we take no responsibility for the views or content hosted on REKT.</p><p><strong>donate<!-- --> (ETH / ERC20):<!-- --> <a href="https://etherscan.io/address/0x3C5c2F4bCeC51a36494682f91Dbc6cA7c63B514C">0x3C5c2F4bCeC51a36494682f91Dbc6cA7c63B514C</a></strong></p><p>disclaimer<!-- -->: </p><p>REKT is not responsible or liable in any manner for any Content posted on our Website or in connection with our Services, whether posted or caused by ANON Author of our Website, or by REKT. Although we provide rules for Anon Author conduct and postings, we do not control and are not responsible for what Anon Author post, transmit or share on our Website or Services, and are not responsible for any offensive, inappropriate, obscene, unlawful or otherwise objectionable content you may encounter on our Website or Services. REKT is not responsible for the conduct, whether online or offline, of any user of our Website or Services.</p></section><div class="recommended-template"><p class="recommended-title">you might also like<!-- -->...</p><div class="recommended-posts"><article class="post recommended-post"><header class="post-header"><h5 class="post-title"><a href="/poly-network-rekt2/"> <!-- -->Poly Network - REKT 2</a></h5><hr/><span class="post-meta"><time>07/03/2023</time><p><span><a href="/[slug]/?tag=Poly+Network">Poly Network</a></span><span> - <a href="/[slug]/?tag=Bridge">Bridge</a></span><span> - <a href="/[slug]/?tag=REKT">REKT</a></span></p></span><hr/></header><section class="post-excerpt"><p>Poly Network is back. Almost two years after topping the leaderboard, this time the hacker got away with just $4.4M. How many more bridges will get rekt because of a handful of compromised keys?</p><p class="post-excerpt-more"><a href="/poly-network-rekt2/">MORE</a></p></section></article><article class="post recommended-post"><header class="post-header"><h5 class="post-title"><a href="/zkasino-rekt/"> <!-- -->ZKasino - Rekt</a></h5><hr/><span class="post-meta"><time>04/22/2024</time><p><span><a href="/[slug]/?tag=ZKasino">ZKasino</a></span><span> - <a href="/[slug]/?tag=REKT">REKT</a></span><span> - <a href="/[slug]/?tag=Rugpull">Rugpull</a></span></p></span><hr/></header><section class="post-excerpt"><p>The house always wins and ZKasino hit the jackpot, making off with a $33 million rug over the weekend.</p><p class="post-excerpt-more"><a href="/zkasino-rekt/">MORE</a></p></section></article><article class="post recommended-post"><header class="post-header"><h5 class="post-title"><a href="/hedgey-finance-rekt/"> <!-- -->Hedgey Finance - Rekt</a></h5><hr/><span class="post-meta"><time>04/19/2024</time><p><span><a href="/[slug]/?tag=Hedgey+Finance">Hedgey Finance</a></span><span> - <a href="/[slug]/?tag=REKT">REKT</a></span></p></span><hr/></header><section class="post-excerpt"><p>Not a good strategy to hedge your bets. Hedgey Finance rocked by $44.7 million flash loan attack across both the Arbitrum and Ethereum platforms.</p><p class="post-excerpt-more"><a href="/hedgey-finance-rekt/">MORE</a></p></section></article></div></div></article></main><footer class="site-footer"><div class="inner"><a class="subscribe" href="http://eepurl.com/hd4HkP" target="_blank">SUBSCRIBE</a><div><section class="copyright ">all content copyright<!-- --> <a href="/">rekt</a> © <!-- -->2024<!-- --> • <!-- -->all rights reserved<!-- -->.</section><section class="poweredby">donate<!-- --> (ETH/ERC20):<a target="_blank" rel="noopener noreferrer" href="https://etherscan.io/address/0x3C5c2F4bCeC51a36494682f91Dbc6cA7c63B514C">0x3C5c2F4bCeC51a36494682f91Dbc6cA7c63B514C</a></section><section class="poweredby">run by<!-- --> <a href="https://twitter.com/RektHQ">RektHQ</a>. <!-- -->founded by<!-- --> <a target="_blank" rel="noopener noreferrer" href="https://twitter.com/bneiluj">Julien Bouteloup</a></section></div></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"title":"Poly Network - REKT","date":"08/11/2021","rekt":{"amount":611000000,"audit":"Unaudited","date":"08/10/2021"},"tags":["Poly Network","REKT"],"excerpt":"This is it rekt readers; the big one. $611M stolen from Poly Network, but has the hacker had a change of heart? They're returning the money bit by bit.","banner":"https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/poly-header.png"},"content":"![](https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/poly-header.png)\n\n**This is it rekt readers; the big one.** \n\n_$611 million dollars stolen._ \n\nThat’s more than the [Mt Gox hack](https://www.bloomberg.com/news/articles/2014-02-28/mt-gox-exchange-files-for-bankruptcy). More than the GDP of several small countries. More than the entire rekt.news leaderboard added together.\n\n**The biggest cryptocurrency hack... _ever_.**\n\n\u003e[Poly Network](https://twitter.com/PolyNetwork2/status/1425130017546149891) = rekt.\n\n_But how?_\n\n![](https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/poly-investigates.png)\n\n_Credit:_[breadcrumbs.app](https://www.breadcrumbs.app/reports/671), [slowmist](https://twitter.com/SlowMist_Team/status/1425197809058254849?s=20), [blocksec](https://blocksecteam.medium.com/the-initial-analysis-of-the-polynetwork-hack-270ac6072e2a)\n\n**Attacker ETH:** [0xc8a65fadf0e0ddaf421f28feab69bf6e2e589963](https://etherscan.io/address/0xc8a65fadf0e0ddaf421f28feab69bf6e2e589963)\n\n**Attacker BSC:** [0x0D6e286A7cfD25E0c01fEe9756765D8033B32C71](https://bscscan.com/address/0x0D6e286A7cfD25E0c01fEe9756765D8033B32C71) \n\n**This was not the usual smart contract flash loan / arbitrage affair.** \n\n**The hacker exploited the Proxy Lock Contracts of Poly Network on three different chains.**\n\n**Ethereum:**[0x250e76987d838a75310c34bf422ea9f1ac4cc906](https://etherscan.io/address/0x250e76987d838a75310c34bf422ea9f1ac4cc906)  \n\n**BSC:**[0x05f0fDD0E49A5225011fff92aD85cC68e1D1F08e](https://bscscan.com/address/0x05f0fDD0E49A5225011fff92aD85cC68e1D1F08e)  \n\n**Polygon:**[0x28FF66a1B95d7CAcf8eDED2e658f768F44841212](https://polygonscan.com/address/0x28FF66a1B95d7CAcf8eDED2e658f768F44841212)  \n\n\u003eCredit: [@kelvinfichter](https://twitter.com/kelvinfichter)\n\n**\"Poly has a contract called the \"**EthCrossChainManager**\". It's a privileged contract that has the right to trigger messages from another chain. It's a standard thing for cross-chain projects.**\n\nIt has a function named **verifyHeaderAndExecuteTx** that anyone can call to execute a cross-chain transaction.\n\nIt (1) verifies that the block header is correct by checking signatures (seems the other chain was a poa sidechain or) and then (2) checks that the transaction was included within that block with a Merkle proof. [Here's the code.](https://github.com/polynetwork/eth-contracts/blob/d16252b2b857eecf8e558bd3e1f3bb14cff30e9b/contracts/core/cross_chain_manager/logic/EthCrossChainManager.sol#L127)\n\nOne of the last things the function does is call **executeCrossChainTx**, which makes the call to the target contract. This is where the critical flaw sits. [Poly checks](https://github.com/polynetwork/eth-contracts/blob/d16252b2b857eecf8e558bd3e1f3bb14cff30e9b/contracts/core/cross_chain_manager/logic/EthCrossChainManager.sol#L185) that the target is a contract, but they forgot to prevent users from calling a very important target... the [**EthCrossChainData** contract](https://github.com/polynetwork/eth-contracts/blob/master/contracts/core/cross_chain_manager/data/EthCrossChainData.sol)\n\nBy sending this cross-chain message, the user could trick the **EthCrossChainManager** into calling the **EthCrossChainData** contract, passing the **onlyOwner** check. Now the user just had to craft the right data to be able to trigger the function that changes the public keys…\n\nThe only remaining challenge was to figure out how to make the **EthCrossChainManager** call the right function. Now comes a little bit of complexity around how Solidity picks which function you're trying to call. \n\nThe first four bytes of transaction input data is called the \"signature hash\" or \"sighash\" for short. It's a short piece of information that tells a Solidity contract what you're trying to do.\n\nThe sighash of a function is calculated by taking the first four bytes of the hash of \"\u003cfunction name\u003e(\u003cfunction input types\u003e)\". For example, the sighash of the ERC20 transfer function is the first four bytes of the hash of \"transfer(address,uint256)\".\n\nPoly's contract was willing to call any contract. However, it would only call the contract function that corresponded to the following sighash:\n  \n![](https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/poly-sighash.png)\n\nErrr but wait... **\"_method\"** here was user input. All the attacker had to do to call the right function was figure out *some* value for \"**_method**\" that, when combined with those other values and hashed, had the same leading four bytes as the sighash of our target function.\n\nWith just a little bit of grinding, you can easily find some input that produces the right sighash. You don't need to find a full hash collision, you're only checking the first four bytes. So is this theory correct?\n\nWell... here's the actual sighash of the target function:\n\u003ehttp://ethers.utils.id ('putCurEpochConPubKeyBytes(bytes)').slice(0, 10)\n'0x41973cd9'\n\nAnd the sighash that the attacker crafted...\n\u003e http://ethers.utils.id ('f1121318093(bytes,bytes,uint64)').slice(0, 10)\n'0x41973cd9'\n\n**Fantastic. No private key compromise required! Just craft the right data and boom... the contract will just hack itself!**\n\nOne of the biggest design lessons that people need to take away from this is: if you have cross-chain relay contracts like this, **MAKE SURE THAT THEY CAN'T BE USED TO CALL SPECIAL CONTRACTS.** The **EthCrossDomainManager** shouldn't have owned the **EthCrossDomainData** contract.\n\nSeparate concerns. If your contract absolutely needs to have special privileges like this, make sure that users can't use cross-chain messages to call those special contracts.\"\n\n![](https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png) \n\n\u003eOn the Ethereum blockchain, the hacker stole\n\n**USDC** - 96,389,444\n  \n**WBTC** - 1,032\n  \n**DAI** - 673,227\n  \n**UNI** - 43,023\n  \n**SHIBA** - 259,737,345,149\n  \n**renBTC**- 14.47\n  \n**USDT** - 33,431,197\n  \n**wETH** - 26,109\n  \n**FEI USD** - 616,082\n\n\u003eOn BSC, the hacker stole:\n\n**BNB** - 6,613.44\n  \n**USDC** - 87,603,373 \n  \n**ETH** - 299\n  \n**BTCB** - 26,629\n  \n**BUSD** - 1,023\n\n\u003eOn the Polygon blockchain, the hacker stole:\n\n**USDC** - 85,089,610\n\n\u003eTOTAL VALUE LOST - ~$611,000,000\n\n_At the time of writing, the stolen funds are located in the following wallets:_\n\n**ETH:** [0xC8a65Fadf0e0dDAf421F28FEAb69Bf6E2E589963](https://etherscan.io/address/0xC8a65Fadf0e0dDAf421F28FEAb69Bf6E2E589963)\n  \n**BSC:** [0x0D6e286A7cfD25E0c01fEe9756765D8033B32C71](https://bscscan.com/address/0x0D6e286A7cfD25E0c01fEe9756765D8033B32C71)\n  \n**Polygon:** [0x5dc3603C9D42Ff184153a8a9094a73d461663214](https://polygonscan.com/address/0x5dc3603C9D42Ff184153a8a9094a73d461663214)\n\n![](https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png) \n\n**DeFi storylines are rarely straightforward, and this one is no exception.**\n\n_Even anonymous actors adore attention._ \n\nShortly after the exploit, an unexpected protagonist appeared, going by the name of [hanashiro.eth.](https://etherscan.io/address/0xf8b5c45c6388c9ee12546061786026aaeaa4b682) \n\nhanashiro.eth first gained attention when they [sent the hacker](https://etherscan.io/tx/0xae2442c5b5721df8c190fd8f59b53b6dc56a875fb03035ad34276a598ddf7d31) a tip about how to handle USDT, for which they [received 13.37 Ether](https://etherscan.io/tx/0xdf3afc47c7914e06ddb1be19afcd769e558111d353e55273a62c4a96e6a6090f) from the hacker as a reward.\n\n**[Many others](https://twitter.com/JustDoingItBig/status/1425115724209655812?s=20) sent messages to the hacker afterwards, but none were quite as successful as hanashiro.eth.**\n\nWith a truly crypto native level of philanthropic showmanship, hanashiro.eth went on to donate their stolen money to a few of the foundational organisations which support our industry, such as Infura, Etherscan, and [rekt.news](https://www.rekt.news/). \n\n_But not all of the funds were so freely accessible._\n\n[Tether froze all of the 33M USDT](https://twitter.com/paoloardoino/status/1425090760609832978?s=20) that were stolen on the Ethereum chain. \n\n**Their coin - their choice… A fact worth remembering if you use USDT.**\n\nBy this point the shit had really hit the fan; and all eyes were on [Poly Network, who resorted to posting an open letter](https://twitter.com/PolyNetwork2/status/1425123153009803267) to the attacker begging them to return the funds. \n  \n**A single tweet asking a criminal to return six hundred million dollars... Maybe Gensler was right when he said we are in the [“Wild West”](https://www.reuters.com/technology/us-sec-chair-gensler-calls-congress-help-rein-crypto-wild-west-2021-08-03/) phase of cryptocurrency.**\n\nConsider the mindset of the attacker at this point in the story. Which do you think they felt more; euphoria, or terror?\n\n**Stealing 600 million dollars whilst sat at your computer must be a surreal experience.**\n\n_The experience of then trying to launder that money must be equally intense._\n\nAside from JPEGS, tornado.cash would be the obvious starting point, and that’s exactly where our hacker went.\n  \nThey [sent themself a transaction](https://twitter.com/UnderTheBreach/status/1425119885978447875?s=20) containing the message;\n\n\u003eWonder why Tornado? Will miners stop me? Teach me please\n\n**Was that psyops or stupidity? In crypto it’s never quite clear...**\n\n**On the run with 600 million, and broadcasting messages to an audience of thousands.** \n\n_The hacker was growing too confident._\n  \n![](https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/poly-fallout.png) \n  \n**When [@WardBradt](https://twitter.com/wardbradt/status/1425112492397764609?s=20) tweeted the following;**\n\n\u003eDid the PolyNetwork Exploiter accidentally use the wrong sender address for this tx [0xb12681d9e](https://t.co/SXS7F6iJsM?amp=1)? The sender address is tied to FTX, Binance, Okex accounts.\n\n**Suddenly the attacker's attitude changed.** \n\nSurely a hacker who feels confident enough to attempt an attack of this scale wouldn’t make such a basic OPSEC error? Or maybe they used fake KYC documents… \n\n_Either way, we began to see signs of fear from the attacker._\n\nThe hacker [began to suggest](https://twitter.com/UnderTheBreach/status/1425127303353356293?s=20) that they might return _\"some tokens\"_ or even abandon them, saying that they were _\"not so interested in the money\"._\n\n[Then the hacker considered the idea](https://twitter.com/sniko_/status/1425135792658255877?s=20) of creating a DAO to distribute the stolen funds.\n\n**Finally, the pressure became too much, and the hacker announced that they were [“READY TO SURRENDER”](https://etherscan.io/tx/0x7b6009ea08c868d7c5c336bf1bc30c33b87a0eedd59dac8c26e6a8551b20b68a)**\n  \n**In an unexpected and unprecedented move, the attacker is now returning the funds to Poly Network.**\n\nThey announced that they were [\"READY TO RETURN THE FUNDS!\"](https://etherscan.io/tx/0x7b6009ea08c868d7c5c336bf1bc30c33b87a0eedd59dac8c26e6a8551b20b68a) in an Ethereum transaction that was sent from the same wallet used for the attack.\n \nBefore sending the first return transaction, the hacker created a token called \"The hacker is ready to surrender\" and sent this token to Poly Network who announced that they had set up a [multisig controlled by ‘’known Poly addresses’’](https://twitter.com/PolyNetwork2/status/1425321860539949056).  \n\n[A summary of the hackers' communication with Poly Network can be found here.](https://docs.google.com/spreadsheets/u/1/d/11LUJwLoHX8ZCyfjhg5YZ0V99iU6PafMNL_NET45FSVc/htmlview?pru=AAABe1lDAS0*CdZKWo5WZNYwj5Qca8505A#gid=0)\n  \n**At the time of writing, the hacker has returned the following:**\n\nOn the Ethereum blockchain: [$2.6M](https://etherscan.io/address/0x71fb9db587f6d47ac8192cd76110e05b8fd2142f#tokentxns) \n  \nOn the BSC: [$1.1M](https://bscscan.com/address/0xEEBb0c4a5017bEd8079B88F35528eF2c722b31fc)\n  \nOn the Polygon blockchain: [$1M](https://polygonscan.com/address/0xa4b291ed1220310d3120f515b5b7accaecd66f17) \n\n**Will the hacker continue to return the funds, or is this just another stunt?**\n\n_Can they really just return the money and be forgiven?_ \n\n![](https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png) \n  \n**Poly Network. 611 million.**\n\n_And you thought you knew all the big protocols in DeFi._ \n\n**This industry has grown bigger than our echo chamber can handle.** \n\nThis may be the first, but it won’t be the last hack of this size that we will see over the coming years. Yet the market seems unfazed, and rightly so.\n\nFor [better](https://finance.yahoo.com/news/coinbase-crushes-q2-expectations-notes-210643795.html) or for [worse](https://www.coindesk.com/bitmex-announces-100m-cftc-fincen-settlement), crypto will make the news, and the [world will have to take notice](https://twitter.com/NeerajKA/status/1423721468123287556?s=20) as our industry becomes the norm.  \n\n_This is just another inevitable part of the progress._\n\n![](https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/poly-conc.png)  \n  \n","recommended":{"posts":[{"date":"07/03/2023","featured":false,"title":"Poly Network - REKT 2","rekt":{"amount":4400000,"audit":"N/A","date":"07/01/2023"},"tags":["Poly Network","Bridge","REKT"],"excerpt":"Poly Network is back. Almost two years after topping the leaderboard, this time the hacker got away with just $4.4M. How many more bridges will get rekt because of a handful of compromised keys?","banner":"https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/poly2-header.png","slug":"poly-network-rekt2"},{"date":"04/22/2024","featured":true,"title":"ZKasino - Rekt","rekt":{"amount":33000000,"audit":"Certik","date":"04/20/2024"},"tags":["ZKasino","REKT","Rugpull"],"excerpt":"The house always wins and ZKasino hit the jackpot, making off with a $33 million rug over the weekend.","banner":"https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/zkasino-header.png","slug":"zkasino-rekt"},{"date":"04/19/2024","featured":false,"title":"Hedgey Finance - Rekt","rekt":{"amount":44700000,"audit":"Consensys Diligence","date":"04/19/2024"},"tags":["Hedgey Finance","REKT"],"excerpt":"Not a good strategy to hedge your bets. Hedgey Finance rocked by $44.7 million flash loan attack across both the Arbitrum and Ethereum platforms.","banner":"https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/hedgey-finance-header.png","slug":"hedgey-finance-rekt"}],"count":3},"slug":"polynetwork-rekt"},"__N_SSG":true},"page":"/[slug]","query":{"slug":"polynetwork-rekt"},"buildId":"WkT8kkBHr4E_kKmh-8mlL","isFallback":false,"gsp":true,"locale":"en","locales":["en","de","es","fr","ja","ko","ru","tr","zh"],"defaultLocale":"en","scriptLoader":[]}</script></body></html>