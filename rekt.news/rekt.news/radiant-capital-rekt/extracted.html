<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/radiant-header.png"/></figure></p><p><em>2024 is off to a bright start...</em></p><p><strong>Lending protool Radiant Capital lost 1900 ETH ($4.5M), yesterday, to a known bug affecting freshly-launched markets.</strong></p><p>Radiant, a fork of Aave V2, operates on Arbitrum and BSC, with the hack occurring on the Arbitrum deployment’s new native USDC market.</p><p><em>It appears the attacker had been lying in wait, <a href="https://twitter.com/lemiscate/status/1742338944057114972">likely having identified</a> the vulnerability in Aave-forks via updates to the Aave protocol itself.</em></p><p>The <a href="https://twitter.com/delucinator/status/1742314791795068993">attacker’s address</a>, as well as <a href="https://twitter.com/solvingKasada/status/1742316833867550918">Discord screenshots</a>, were posted to Twitter, raising the alarm. An <a href="https://twitter.com/RDNTCapital/status/1742338729925112272">official confirmation</a> came later, adding:</p><blockquote><p>No current funds are at risk.</p></blockquote><p><em>So, just the $4.5M that had already been stolen, then?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/09/rekt-investigates-linebreak.png"/></figure></p><p>Credit: <em><a href="https://twitter.com/peckshield/status/1742334242120466580">Peckshield</a>, <a href="https://twitter.com/AnciliaInc/status/1742323976251273332">Ancilia</a></em></p><p><strong>The issue in forked Aave V2 code affects recently-launched (and therefore <em>empty</em>) markets.</strong></p><p>A potential attacker has a brief window after launch to use a flash loan to manipulate the value of collateral, thanks to the combination of a rounding error and a totalSupply value of 0.</p><p><em>The exploiter wasted no time, <a href="https://arbiscan.io/tx/0x81a1414641bc823cd623208ba4c19a6cfc94f363050487bb122c15dceadc8937">deploying</a> their <a href="https://arbiscan.io/address/0x39519c027b503f40867548fb0c890b11728faa8f">attack contract</a> just six seconds after the new <a href="https://arbiscan.io/address/0x3a2d44e354f2d88ef6da7a5a4646fd70182a7f55">market</a> was <a href="https://arbiscan.io/tx/0x0e5330ad77b9b806cb9f6ea595d58552f341dbad0691e0599ab5f1caf214c247">activated</a>.</em></p><p>The bug was previously mitigated in the original Aave protocol by simply including an initial deposit with the creation of new markets, ensuring they are never sitting empty.</p><p>Given the speed of the attack, the attacker had clearly prepared everything in advance whilst waiting for the <a href="https://community.radiant.capital/t/proposal-gauntlet-usdc-e-migration-parameter-adjustment-recommendation/1478">proposal to add the market</a> (which <a href="https://snapshot.org/#/radiantcapital.eth/proposal/0xf1822c8cded8bef5c16334413bc02463104e9c67d9ad06dce7f7f277aad72ba5">passed</a> on December 25th) to be enacted.</p><p>Attacker’s address: <strong><a href="https://arbiscan.io/address/0x826d5f4d8084980366f975e10db6c4cf1f9dde6d">0x826d5f4d8084980366f975e10db6c4cf1f9dde6d</a></strong></p><p>Attack contract: <a href="https://arbiscan.io/address/0x39519c027b503f40867548fb0c890b11728faa8f">0x39519c027b503f40867548fb0c890b11728faa8f</a></p><p>Attack tx 1: <a href="https://arbiscan.io/tx/0x1ce7e9a9e3b6dd3293c9067221ac3260858ce119ecb7ca860eac28b2474c7c9b">0x1ce7e9a9…</a></p><p>Attack tx 2: <a href="https://arbiscan.io/tx/0x2af556386c023f7ebe7c662fd5d1c6cc5ed7fba4723cbd75e00faaa98cd14243">0x2af55638…</a></p><p>Attack tx 3: <a href="https://arbiscan.io/tx/0xc5c4bbddec70edb58efba60c1f27bce6515a45ffcab4236026a5eeb3e877fc6d">0xc5c4bbdd…</a></p><p>The Radiant Team has sent an <a href="https://arbiscan.io/tx/0xcd1865e3bf185fc5fe0b5fb055f6d74cfa68ee50335ff92ad721063538922664">on-chain message</a> to the hacker’s address (where funds remain), and appear confident that they’re dealing with a whitehat “<em>for various reasons</em>”.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p><strong>Despite <a href="https://docs.radiant.capital/radiant/contracts-and-security/audits/v2-audits">four audits</a>, from OpenZeppelin, BlockSec, Peckshield and Zokyo, a constantly-evolving security landscape means updates <em>must</em> be made in a timely manner.</strong></p><p><em>Especially when dealing with forked code.</em></p><p>We've discussed the risks of forks plenty of times, with multiple <a href="https://rekt.news/leaderboard/">leaderboard entries</a> down to vulnerabilities patched in one place before being exploited elsewhere.</p><p>When copy-pasting an established project, more eyes are focused on the original project’s larger TVL, providing an early warning system for bugs like these.</p><p><strong>But if <a href="https://twitter.com/ChainLight_io/status/1742561576077709405">lessons aren’t learned</a>, there’s little to be done.</strong></p><p><em>Are any other forked protocols planning to launch new markets soon?</em></p><p><em>Are they up to date on the risks?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/rekt-outline-conc.png"/></figure></p>