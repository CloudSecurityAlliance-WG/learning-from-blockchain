<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/05/merlin-header.png"/></figure>
<strong>Security looser than a wizard's sleeve.</strong></p><p>The <a href="https://www.rekt.news/pancakebunny-rekt/">PancakeBunny</a> attack pulled the rabbit out of the hat, now a surprisingly similar string of attacks emerges from <a href="https://www.rekt.news/bsc-the-bridge-to-defi/">Binance Smart Chain</a>.</p><p><strong>$680,000 taken from <a href="https://twitter.com/MerlinLab_">Merlin Lab</a>.</strong></p><p>We have to set ourselves some standards here at <a href="https://www.rekt.news/">rekt.news</a> - generally we won’t report on hacks concerning less than $1M, but when there’s something worth saying we’ll say it.</p><p><strong>The same technique has been used three times in one week.</strong></p><p><em>BSC developers must try harder.</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/05/merlin-investigates.png"/></figure></p><blockquote><p>Credit: <a href="https://twitter.com/WatchPug_">watchpug</a></p></blockquote><p><strong>On May 26, 2021, 03:59:05 AM +UTC, less than 48 hrs after the <a href="https://www.rekt.news/autoshark-rekt/">Autoshark</a> hack. Merlin Lab, (another fork of PancakeBunny), was attacked in a similar fashion to the Bunny and the Autoshark hack.</strong></p><p>As a result, the hacker was able to remove ~240 ETH (~680K USD).</p><p><a href="https://bscscan.com/tx/0x8e20a1118a669d03b66c5eca2d937646bd855a998afb1e94b94ff6303456ff97">Transaction Details on BscScan.</a></p><p><strong>1:</strong> Add a small sum of deposit to the LINK-BNB Vault (with this transaction).</p><p><strong>2:</strong> Send 180 CAKE to the LINK-BNB Vault contract. (This is the key that leads to the hack.)</p><p><strong>3:</strong> Call getReward with the deposit of LINK-BNB Vault from the first step.</p><p><strong>4:</strong> With the large amount of CAKE token in the wallet balance of the vault contract (sent by the hacker in step 2), it returns a large amount of profit. As a result, the system minted 100 MERL as a reward to the hacker.</p><p><strong>5:</strong> Repeat 36 times. Receive 49K of MERL token in total.</p><p><strong>6:</strong> Swapped MERLIN token into 240 ETH and transferred out of BSC using Anyswap.</p><p><em>The hacker used the wallet balance of CAKE as the profit (performanceFee) which can be easily tampered with by just sending the CAKE token to the vault contract.</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p><strong>We don’t document these attacks to help the hackers, although sometimes they might <a href="https://twitter.com/RektHQ/status/1397195892327858181?s=20">thank us for our work</a>.</strong></p><p>Each attack provides a lesson for the protocols that remain.</p><p>If these lessons are ignored, meaning users' funds are lost, then what does that say about the founders and the auditors?</p><p><strong>Merlin Labs was audited by <a href="https://merlinlab.com/15052021_Merlin_SC_SecondReview_Audit_Report.pdf">Hacken</a> on May 15th, just 11 days before this exploit.</strong></p><p>Now they both take a spot at the bottom of our <a href="https://www.rekt.news/leaderboard/">leaderboard</a>.</p><p><em>Must try harder.</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-text-linebreak.png"/></figure></p>