<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/11/monox-header.png"/></figure></p><p><strong>rekt by their own token.</strong></p><p><em>Over $31 million stolen, across two chains, via a price manipulation of the project’s native token, <a href="https://www.coingecko.com/en/coins/monox">MONO</a>.</em></p><p><a href="http://monox.finance">MonoX</a>, which launched <a href="https://twitter.com/MonoXFinance/status/1450825924040134664">last month</a> on Polygon and Ethereum, is a DEX based on Single Token Liquidity pools. Rather than the standard pool model of paired assets deposited by LPs, MonoX pools function by grouping a deposited token “<em>into a virtual pair with our virtual cash stablecoin (vCASH)</em>”.</p><p><strong>One of the benefits that MonoX claimed their virtual pool model brought was streamlined swap routing.</strong></p><p>How convenient for today’s hacker who, manipulating a pricing bug, was able to inflate the price of the platform's native token and make a <em>streamlined cash-out</em> into the other deposited tokens.</p><p><strong><a href="https://twitter.com/FrankResearcher/status/1465679352448917504">Two attacks</a> hit the protocol in swift succession.</strong></p><p>First, ~$19.4M was stolen on Polygon and just 17 minutes later, the same attack vector was used on Ethereum, taking a further ~$12M.</p><p>The team provided a <a href="https://t.me/MonoXAnnouncement/116">statement</a> via the MonoX Announcements channel on Telegram, and later via <a href="https://twitter.com/MonoXFinance/status/1465692925791137799">Twitter</a>.</p><blockquote><p><em>...A method in the swap contract was exploited and boosted MONO token price to sky high. The attacker then used $MONO to purchase all the other assets in the pool...</em></p><p><em>...We also really wish to have a chance in talking with the "attacker". We value very much for what we've built for the current and future MonoX, and most importantly our users and their funds; PLEASE reach out to us!</em></p></blockquote><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/11/monox-investigates.png"/></figure></p><p><em>Credit: <a href="https://twitter.com/BlockSecTeam/status/1465690478414761992">@BlockSecTeam</a></em></p><p>The protocol’s <a href="https://twitter.com/MonoXFinance/status/1462410267233505281">recently</a>-launched MONO token was used in the exploit. The hacker was able to massively inflate its value owing to a bug in the <em>swapTokenForExactToken</em> code in the Monoswap contract (<a href="https://polygonscan.com/address/0x3826367A5563eCE9C164eFf9701146d96cC70AD9">Polygon</a>, <a href="https://etherscan.io/address/0xC36a7887786389405EA8DA0B87602Ae3902B88A1">Ethereum</a>).</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/11/monox-code.png"/></figure></p><p><strong>The function _<em>updateTokenInfo</em> was used to update token prices following swaps through MonoX pools. However, there was nothing to restrict the use of the same asset for both <em>tokenIn</em> and <em>tokenOut</em>.</strong></p><p>By doing just this with the platform’s native token, the hacker created a loop in which the price of <em>tokenOut</em> would overwrite the price of <em>tokenIn</em>, pumping the price of MONO over the course of many “swaps”.</p><p>Once the price had been manipulated, the attacker cashed out the overvalued MONO for almost all the other tokens deposited in the platform’s Single Token Liquidity pools.</p><p><strong>Both Halborn and Peckshield conducted <a href="https://docs.monox.finance/library/audits">audits</a> of the Monoswap contract. How did they both miss this simple bug? Was it deliberate, or just careless?</strong></p><p><strong>Total assets stolen:</strong></p><p><strong>5.7M MATIC</strong> ($10.5M)</p><p><strong>3.9k WETH</strong> ($18.2M)</p><p><strong>36.1 WBTC</strong> ($2M)</p><p><strong>1.2k LINK</strong> ($31k)</p><p><strong>3.1k GHST</strong> ($9.1k)</p><p><strong>5.1M DUCK</strong> ($257k)</p><p><strong>4.1k MIM</strong> ($4.1k)</p><p><strong>274 IMX</strong> ($2k)</p><p><strong>Exploit transactions:</strong> <a href="https://polygonscan.com/tx/0x5a03b9c03eedcb9ec6e70c6841eaa4976a732d050a6218969e39483bb3004d5d">Polygon</a>, <a href="https://etherscan.io/tx/0x9f14d093a2349de08f02fc0fb018dadb449351d0cdb7d0738ff69cc6fef5f299">Ethereum</a>.</p><p><strong>Exploit contracts:</strong> <a href="https://polygonscan.com/address/0x119914de3ae03256fd58b66cd6b8c6a12c70cfb2">Polygon</a>, <a href="https://etherscan.io/address/0xf079d7911c13369e7fd85607970036d2883afcfd">Ethereum</a></p><p><strong>Stolen funds:</strong> ($31.4M total) <a href="https://polygonscan.com/address/0x8f6a86f3ab015f4d03ddb13abb02710e6d7ab31b#tokentxns">Polygon</a> ($19.4M), <a href="https://etherscan.io/address/0x8f6a86f3ab015f4d03ddb13abb02710e6d7ab31b#tokentxns">Ethereum</a> ($12M).</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/11/monox-linebreak.png"/></figure></p><p><strong>Over $30M lost on a protocol barely one month old. In fact, the project had passed $30M TVL just <a href="https://twitter.com/MonoXFinance/status/1464673862562557964">3 days prior</a> to the exploit.</strong></p><p>While the rate at which projects are now able to attract value is impressive, the insecurity that comes with investing in DeFi is a stark reminder of the immaturity of the space.</p><p>With time, casualties like these build a base of knowledge on which best practises can be established.</p><p>But for now, experiments will continue to be launched.</p><p><em>And some of them will fail.</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/rekt-outline-conc.png"/></figure></p>