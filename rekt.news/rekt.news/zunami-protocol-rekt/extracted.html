<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/zunami-header.png"/></figure></p><p><strong>NOTE:</strong> This article has been edited to remove reference to Ackee Blockchain, who audited an <a href="https://ackeeblockchain.com/blog/zunami-uzd-audit-summary/">earlier version</a> of the protocol before the attacked MimCurveStakeDAO strategy was added.</p><hr/><p><em>The Curve ecosystem can't catch a break…</em></p><p><strong>Yesterday, <a href="https://twitter.com/ZunamiProtocol/">Zunami Protocol</a> lost $2.1M as the project’s Ether- and USD-pegged stablecoins came under a price manipulation attack.</strong></p><p><em>Although Curve itself was unaffected, the exploiter drained Zunami’s zETH and UZD liquidity pools on Curve, causing the ‘zStables’ to depeg by <a href="https://www.coingecko.com/en/coins/zunami-ether">85%</a> and <a href="https://www.coingecko.com/en/coins/zunami-usd">99%</a>, respectively.</em></p><p>Peckshield <a href="https://twitter.com/peckshield/status/1690857760412610560">raised the alarm</a> but, after the recent <a href="https://www.dlnews.com/articles/defi/blocksec-criticised-for-live-tweeting-curve-exploit-details/">BlockSec/Curve debacle</a>, was careful not to provoke criticism and opted not to provide transaction hashes or addresses.</p><p>Shortly after, Zunami <a href="https://twitter.com/ZunamiProtocol/status/1690863406079696896">confirmed</a> the exploit:</p><blockquote><p>It appears that zStables have encountered an attack. The collateral remain secure, we delve into the ongoing investigation.</p></blockquote><p><strong>First <a href="https://rekt.news/conic-finance-rekt/">Conic Finance</a>, then <a href="https://rekt.news/curve-vyper-rekt/">JPEG’D, Alchemix and Curve itself</a>, now Zunami…</strong></p><p><em>Could the <a href="https://rekt.news/curve-wars/">Curve Wars</a> be proving even more lucrative for hackers than for protocols?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/09/rekt-investigates-linebreak.png"/></figure></p><p>Credit: <em><a href="https://twitter.com/peckshield/status/1690877589005778945">Peckshield</a>, <a href="https://twitter.com/BlockSecTeam/status/1690931111776358400">BlockSec</a></em></p><p><strong>Just over an hour after the initial alert, and presumably after confirming no further funds were at risk, Peckshield followed up with <a href="https://twitter.com/peckshield/status/1690877589005778945">more detail</a>:</strong></p><blockquote><p>It is a price manipulation issue, which can be exploited by donation to incorrectly calculate the price as shown in the following figures.</p></blockquote><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/zunami-code.png"/></figure>
<figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/zunami-tx.png"/></figure></p><p><strong>The attacker used flash loans to execute large token swaps (e.g. SDT), causing slippage in the pool which could be used to manipulate LP token prices. The root cause was a flawed price calculation via the totalHoldings function.</strong></p><p>BlockSec provided the following step-by-step:</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/zunami-steps.png"/></figure></p><p><em>The proceeds (1184 ETH or $2.1M) were quickly <a href="https://etherscan.io/advanced-filter?fadd=0x5f4c21c9bb73c8b4a296cc256c0cde324db146df&amp;tadd=0xd90e2f925da726b50c4ed8d0fb90ad053324f31b&amp;txntype=0&amp;qt=1">deposited</a> into Tornado Cash.</em></p><p>The protocol itself and the UZD and zETH contracts were <a href="https://zunamilab.gitbook.io/product-docs/risks-and-security/audits">audited</a> by <a href="https://twitter.com/HashExOfficial/">Hashex</a>.</p><p>Attacker’s address: <strong><a href="https://etherscan.io/address/0x5f4c21c9bb73c8b4a296cc256c0cde324db146df">0x5f4c21c9bb73c8b4a296cc256c0cde324db146df</a></strong></p><p>Exploit tx (zETH): <a href="https://etherscan.io/tx/0x2aec4fdb2a09ad4269a410f2c770737626fb62c54e0fa8ac25e8582d4b690cca">0x2aec4fdb…</a></p><p>Exploit tx (UZD): <a href="https://etherscan.io/tx/0x0788ba222970c7c68a738b0e08fb197e669e61f9b226ceec4cab9b85abe8cceb">0x0788ba22…</a></p><p><strong>The Sushiswap SDT pool, although used by the hacker during the price manipulation, is safe (<em>despite what a certain relentless bear-poster might like to <a href="https://twitter.com/napgener/status/1690859664009768960">imply</a></em>).</strong></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p><strong>Peckshield may have been careful not to include sensitive information in their alert, but others <a href="https://twitter.com/Ironblocks_/status/1690869728204533760">weren’t</a> so <a href="https://twitter.com/AnciliaInc/status/1690857336158695425">cautious</a>.</strong></p><p>Following BlockSec’s public announcement of the root cause behind the <a href="https://twitter.com/vyperlang/status/1685692973051498497">Vyper bug</a> last month, the <a href="https://twitter.com/LefterisJP/status/1685752260465180673">backlash</a> prompted a debate about how many security firms apparently chase Twitter clout while potentially aiding hackers.</p><p>The discussion, and <a href="https://twitter.com/peckshield/status/1689228812477939712">calls</a> for feedback, appear to have led to tweaked <a href="https://twitter.com/BlockSecTeam/status/1690377651540942848">alerting standards</a> which prioritise only the crucial information to alert users who may need to withdraw funds, but without giving away any clues which bad actors may take advantage of.</p><p>Another step forwarded is the <a href="https://twitter.com/samczsun/status/1688613385565528064">SEAL 911 hack hotline</a>; the Telegram bot aims to use its <a href="https://gist.github.com/samczsun/366b853a54391a97ab13cd2e3ca2d7c9">list of members</a> is a fast-response for any concerned whitehat looking to alert a potentially vulnerable protocol’s team.</p><p><strong>Security teams do important work in DeFi, where exploiters are lurking around every corner.</strong></p><p><em>Not least BlockSec, with their <a href="https://rekt.news/saddle-finance-rekt2/">impressive</a> <a href="https://rekt.news/sushi-yoink-rekt/">whitehacking</a> <a href="https://rekt.news/platypus-finance-rekt/">record</a>.</em></p><p>But keeping DeFi safe is a constant game of cat-and-mouse, one that can’t always be won.</p><p><em>Who will be next to fall prey?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/rekt-outline-conc.png"/></figure></p>