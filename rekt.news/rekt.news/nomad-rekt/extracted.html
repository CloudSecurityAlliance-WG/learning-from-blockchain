<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2022/07/nomad-header.png"/></figure></p><p><strong>The vultures had a busy night.</strong></p><p><a href="https://www.nomad.xyz/">Nomad Bridge</a> has been torn apart, with $190M of liquidity drained in a savage attack lasting two and a half hours.</p><p><em>This is the 100th incident to make it onto the rekt.news <a href="https://rekt.news/leaderboard/">leaderboard</a>.</em></p><p><strong>Staying true to DeFi principles, this hack was permissionless - <em>anyone could join in</em>.</strong></p><p>Once the fatal blow had been struck, the <a href="https://twitter.com/spreekaway/status/1554219768462426115">news spread</a>, and many began to fight over the scraps.</p><p><strong>Cross-chain bridges continue to be a weak point for DeFi and a juicy target for exploiters. And when they go, it's often a <a href="https://defillama.com/protocol/nomad">total collapse</a>.</strong></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2022/07/nomad-tvlchart.png"/></figure></p><p><em>$190M... devoured.</em></p><p>The collateral damage from the unbacked assets is also severely affecting the chains that depended on Nomad. <a href="https://twitter.com/MoonbeamNetwork/status/1554245102071123968">Moonbeam</a>, <a href="https://twitter.com/EvmosOrg/status/1554275898156670976">EVMOS</a> and <a href="https://twitter.com/Milkomeda_com/status/1554302195763269632">Milkomeda</a> have all taken a significant hit to their TVLs.</p><p>This incident is distinct in its every-man-for-himself nature, but many who exploited the bug have declared themselves whitehats‚Ä¶ Rekt is looking forward to seeing how much is eventually returned‚Ä¶</p><p><strong>Even so, with four of our <a href="https://rekt.news/leaderboard/">leaderboard‚Äôs top 5</a> entries being cross-chain attacks, it gets ever more difficult to agree with Nomad‚Äôs slogan ‚Äú<em>The future of cross-chain communication is optimistic</em>‚Äù.</strong></p><p><em>But what started the feeding frenzy?</em></p><p><em>And how were so many able to continue picking the bones?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/09/rekt-investigates-linebreak.png"/></figure></p><p><em>Credit: <a href="https://twitter.com/samczsun/status/1554252024723546112">samczsun</a>, <a href="https://twitter.com/Zellic_io/status/1554296729050025984">Zellic.io</a></em></p><p>Following a routine upgrade in June, the bridge‚Äôs <a href="https://etherscan.io/address/0xB92336759618F55bd0F8313bd843604592E27bd8#code">Replica contract</a> was <a href="https://etherscan.io/tx/0x53fd92771d2084a9bf39a6477015ef53b7f116c79d98a21be723d06d79024cad">initialised</a> with a fatal security flaw leading to the incident. The 0x00 address was set as a trusted root, meaning that all messages were read as valid by default.</p><p>After a failed first <a href="https://twitter.com/sniko_/status/1554221434628706304">attempt</a> (costing $350k in gas), the original attacker‚Äôs <a href="https://etherscan.io/tx/0xb1fe26cc8892f58eb468f5208baaf38bac422b5752cca0b9c8a871855d63ae28">exploit tx</a>, which was copied by those that followed, was able to call the process() function directly, without having first ‚Äòproved‚Äô its validity.</p><p>The process() function is responsible for the execution of all cross-chain messages and has an internal requirement (<a href="https://etherscan.io/address/0xB92336759618F55bd0F8313bd843604592E27bd8#code">line 185</a>) to check the validity of the merkle root of all messages to be processed.</p><p><strong>However, the upgrade inadvertently caused transactions with a ‚Äòmessages‚Äô value of 0 (invalid, according to legacy logic) to be read by default as 0x00 which was defined in the upgrade as a trusted root, passing the validation requirement as ‚Äòproven‚Äô.</strong></p><p>This meant any process() calls could be executed as valid. In fact, a more sophisticated exploiter could have written a contract to drain the whole bridge for themselves.</p><p>Copycat attackers simply had to copy/paste the same process() function call via Etherscan, swapping out their address in place of the previous exploiter‚Äôs.</p><p><strong>The incident quickly proved to be a chaotic mixture of word-of-mouth crowdhacking, frantic whitehat activity and MEV-bot carnage.</strong></p><p>For example, <a href="https://etherscan.io/address/0x9634445e293a87ab77ca3cf5b43da94aabc544b6#tokentxns">üçâüçâüçâ.eth</a> managed to extract a total of $4M from the bridge, but fortunately claims to be <a href="https://etherscan.io/tx/0xba0b139e450b0438e9c986ed00d209f9c289416000712a62a33e9feda045ca10">acting as whitehat</a>:</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2022/07/nomad-txmsg.png"/></figure></p><p>However, other names stood out for the wrong reasons. There was a notable repeat offender in the Rari Capital (Arbitrum) exploiter from <a href="https://rekt.news/fei-rari-rekt/">April‚Äôs article</a>, who got away with <a href="https://etherscan.io/address/0x65760288f19cff476b80a36a61f9dedab16bab49#tokentxns">almost $3M</a> in stablecoins, which went straight into Tornado Cash.</p><p>Of the <a href="https://dune.com/beetle/nomad-bridge-assets">multiple exploiters</a>, the top three addresses (with 95M between them) are the following:</p><p><a href="https://etherscan.io/address/0x56D8B635A7C88Fd1104D23d632AF40c1C3Aac4e3">0x56D8B635A7C88Fd1104D23d632AF40c1C3Aac4e3</a> ($47M)</p><p><a href="https://etherscan.io/address/0xBF293D5138a2a1BA407B43672643434C43827179">0xBF293D5138a2a1BA407B43672643434C43827179</a> ($40M)</p><p><a href="https://etherscan.io/address/0xB5C55f76f90Cc528B2609109Ca14d8d84593590E">0xB5C55f76f90Cc528B2609109Ca14d8d84593590E</a> ($8M)</p><p><strong>A full list of exploiter addresses is available <a href="https://twitter.com/PeckShieldAlert/status/1554350737957998592">here</a>.</strong></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p>The project completed a <a href="https://certificate.quantstamp.com/full/nomad">Quantstamp audit</a> in June, with issue QSP-19 foreshadowing a similar vulnerability:</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2022/07/nomad-audit.png"/></figure></p><p>The auditor‚Äôs remarks that ‚Äú<em>We believe the Nomad team has misunderstood the issue</em>‚Äù speak to a worrying attitude towards security that the project docs‚Äô ‚Äú<a href="https://docs.nomad.xyz/the-nomad-protocol/security/long-term-security">Long-Term Security</a>‚Äù plan appears to confirm:</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2022/07/nomad-todo.png"/></figure></p><p>Concerns were also raised around the response time of the team facing a live and public exploit; the team‚Äôs <a href="https://twitter.com/nomadxyz_/status/1554246853348036608">official acknowledgement</a> came three hours after the exploit began.</p><p>The exploit was <a href="https://twitter.com/YannickCrypto/status/1554265378360000515">eventually halted</a> by simply ‚Äú<em>removing the Replica contract as owner</em>‚Äù, but after such a delay it was too late to save the funds.</p><p><em>Blockchains may be closed systems, but alt L1 are only as strong as their weakest link.</em></p><p>The Harmony chain is still <a href="https://talk.harmony.one/t/reimbursement-proposal-horizon-incident/20665/2">in disarray</a> since its bridge <a href="https://rekt.news/harmony-rekt/">lost $100M</a> in late June, in an attack <a href="https://hub.elliptic.co/analysis/the-100-million-horizon-hack-following-the-trail-through-tornado-cash-to-north-korea/">linked</a> to the <a href="https://rekt.news/big-phish/">Lazarus Group</a>.</p><p><em>What will the future hold for the ecosystems affected by Nomad‚Äôs collapse?</em></p><p>So far, <a href="https://defillama.com/chain/Moonbeam">Moonbeam‚Äôs TVL</a> has dropped from $300M to $135M, <a href="https://defillama.com/chain/Evmos">EVMOS‚Äôs</a> from ~$7M to ~$3M, and <a href="https://defillama.com/chain/Milkomeda">Milkomeda‚Äôs</a> from $31M to $20M.</p><p><em>But crucially, the loss of confidence may prove to do far more damage than the missing $190M.</em></p><p>Building in an nascent, experimental industry is tough, and cross-chain infrastructure has many moving parts to secure. The damage done by bridge attacks are often the most painful, as they can contaminate a whole ecosystem, or more.</p><p><strong>But nomadic liquidity has no permanent home, users will always roam to new lands in search of the ‚Äúnext big thing‚Äù, and will continue to get stung whenever vigilance becomes stretched too thin.</strong></p><p>With each of the 100 entries on the rekt.news <a href="https://rekt.news/leaderboard/">leaderboard</a>, the industry learns a harsh lesson, slowly growing stronger.</p><p><strong>But for now, DeFi still has plenty of easy prey‚Ä¶</strong></p><p><em>‚Ä¶and scavengers continue to circle overhead.</em></p><p><em>Will it ever change?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/rekt-outline-conc.png"/></figure></p>