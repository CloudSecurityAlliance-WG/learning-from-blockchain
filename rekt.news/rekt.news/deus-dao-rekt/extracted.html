<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2022/03/deus-header.png"/></figure></p><p><strong>Deus rekt machina.</strong></p><p>An unexpected plot twist saw <a href="https://twitter.com/DeusDao/status/1503652836978143242?s=20&amp;t=7KOBNi8X9vonyspyd2rC0A">Deus DAO</a> users liquidated via a flash loan attack on the recently launched DEI <a href="https://ftmscan.com/address/0xec1fc57249cea005fc16b2980470504806fca20d#code">lending contract</a>, with <a href="https://ftmscan.com/address/0xb8f5c9e18abbb21dfa4329586ee74f1e2b685009">the attacker</a> making ~$3M profit.</p><p>Five months have passed since we <a href="https://rekt.news/cream-rekt-2/">last reported</a> a flash loan attack, but they used to be commonplace.</p><p><em>Is DeFi growing stronger?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/09/rekt-investigates-linebreak.png"/></figure></p><p><strong>A flash loan <a href="https://ftmscan.com/tx/0xe374495036fac18aa5b1a497a17e70f256c4d3d416dd1408c026f3f5c70a3a9c">attack</a> was used to manipulate the balance of the Solidex USDC/DEI pool, which is used as an oracle for collateral value on Deus Finance’s $DEI lending contract.</strong></p><p>This resulted in user positions becoming insolvent, which the <a href="https://ftmscan.com/address/0xb8f5c9e18abbb21dfa4329586ee74f1e2b685009">hacker’s contract</a> liquidated, before repaying the flash loan.</p><p><em>Credit: <a href="https://twitter.com/peckshield/status/1503632734299701250">Peckshield</a></em></p><p><strong>1:</strong> Flashloan 9,739342 DEI via SPIRIT-LP_USDC_DEI</p><p><strong>2:</strong> Flashloan 24,772,798 DEI out of the sAMM-USDC/DEI pair (used as price oracle to calculate collateral value)</p><p><strong>3:</strong> Liquidate the users who become insolvent from Step 2</p><p><strong>4:</strong> Repay the borrowed 24,772,798 DEI to the sAMM-USDC/DEI pair</p><p><strong>5:</strong> Burn the liquidated LP token to get 5,218,173 USDC + 5,246,603 DEI</p><p><strong>6:</strong> Swap 5,218,173 USDC to 5,170,594 DEI</p><p><strong>7:</strong> Repay flashloan with 3,001,552 DEI as hack profit</p><p><strong>Attack tx:</strong></p><p><a href="https://ftmscan.com/tx/0xe374495036fac18aa5b1a497a17e70f256c4d3d416dd1408c026f3f5c70a3a9c">0xe374495036fac18aa5b1a497a17e70f256c4d3d416dd1408c026f3f5c70a3a9c</a></p><p><strong>The attacker then went on to <a href="https://ftmscan.com/tx/0x09dc3a1afd1dae211c31d7ad4b5cd6f68c9350727fa5d4c7c63efb9d287e3210">send</a> 3M USDC via Multichain from an <a href="https://ftmscan.com/address/0x1ed5112b32486840071b7cdd2584ded2c66198dd">FTM address</a> to <a href="https://etherscan.io/address/0x1ed5112b32486840071b7cdd2584ded2c66198dd">ETH address</a>, and from there 1.1k ETH and 200k DAI to Tornado cash, totalling ~$3M gained.</strong></p><p>The project’s token, <a href="https://www.coingecko.com/en/coins/deus-finance">DEUS</a>, dropped ~40% in the hour following the attack and, despite some recovery, remains volatile.</p><blockquote><p>Deus <a href="https://twitter.com/lafachief/status/1503678891386359808">have announced</a> that they will be reimbursing affected users who return their DEI debts, returning their liquidated collateral.</p></blockquote><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p><strong><a href="https://rekt.news/on-flash-loans/">Flash loan season</a> taught even non-technical users about the importance of price oracles.</strong></p><p>Security standards emerged from our baptism of fire, and the industry learned and moved forward.</p><p>We know that these <a href="https://samczsun.com/so-you-want-to-use-a-price-oracle/">attacks can be mitigated</a> by using decentralised or TWAP <a href="https://docs.uniswap.org/protocol/V2/concepts/core-concepts/oracles">oracles.</a></p><p><em>Why didn’t Deus DAO have a more robust system in place?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2022/03/deus-conc.png"/></figure></p>