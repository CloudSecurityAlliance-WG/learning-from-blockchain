<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2022/12/raydium-header.png"/></figure></p><p><em>The latest entry on our <a href="https://rekt.news/leaderboard/">leaderboard</a> comes from a post-FTX wasteland, once a promising hive of VC-backed dev activity.</em></p><p><strong>On Friday, <a href="https://raydium.io/">Raydium</a>, a Solana-based AMM, lost a total of ~$4.4M in fees from its liquidity pools.</strong></p><p>The alarm was <a href="https://twitter.com/prism_ag/status/1603752282083950592">raised</a> by the DEX aggregator PRISM, also on Solana:</p><blockquote><p>There seems to be a wallet is draining LP Pools from Raydium liquidity pools using admin wallet as a signer without having/burning LP tokens.</p><p>We withdrew protocol provided PRISM/USDC liquidity from Raydium</p><p>WITHDRAW YOUR PRISM/USDC LIQUIDITY FROM RAYDIUM</p></blockquote><p>The <a href="https://twitter.com/RaydiumProtocol/status/1603762271028748289">official announcement</a> came 40 minutes later, stating that “<em>authority has been halted on AMM &amp; farm programs for now</em>”. In a follow-up <a href="https://twitter.com/RaydiumProtocol/status/1603860540153028625">post</a>, the team assured users that “<em>a patch is in place preventing further exploits from the attacker.</em>”</p><p>While this incident doesn’t look to have caused a total protocol meltdown, losing millions is never a good look.</p><p><em>But who’s still using Solana anyway?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/09/rekt-investigates-linebreak.png"/></figure></p><p><em>Credit: <a href="https://twitter.com/RaydiumProtocol/status/1603860540153028625">Raydium</a>, <a href="https://twitter.com/osec_io/status/1603763023151509505">OtterSec</a></em></p><p><strong>According to OtterSec, the incident appears to have been down to a compromised private key to the owner account of Raydium contracts.</strong></p><p>Raydium <a href="https://twitter.com/RaydiumProtocol/status/1603860543302950918">suspect</a> “<em>a trojan attack and compromised private key for the pool owner account</em>”.</p><p>The account had authority over certain functions of Raydium’s pools, allowing the attacker to drain accumulated trading/protocol fees via the withdraw_pnl instruction. The hacker also changed the SyncNeedTake parameter to increase expected fees and withdraw extra funds.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2022/12/raydium-code.png"/></figure></p><p><strong>The following pools were affected for a total protocol loss of $4.4M:</strong></p><p>SOL-USDC</p><p>SOL-USDT</p><p>RAY-USDC</p><p>RAY-USDT</p><p>RAY-SOL</p><p>stSOL-USDC</p><p>ZBC-USDC</p><p>UXP-USDC</p><p>whETH-USDC</p><p>The majority of funds were bridged to Ethereum, swapped to ETH and have been deposited into Tornado Cash. 100k SOL ($1.4M) remains in the attacker’s Solana address.</p><p><strong>Attacker’s SOL address <a href="https://solana.fm/address/AgJddDJLt17nHyXDCpyGELxwsZZQPqfUsuwzoiqVGJwD/transfers">AgJddDJLt17nHyXDCpyGELxwsZZQPqfUsuwzoiqVGJwD</a></strong></p><p><strong>Attacker’s ETH address <a href="https://etherscan.io/address/0x7047912c295cd54d6617b5d0d6d8b324a11c91db">0x7047912c295cd54d6617b5d0d6d8b324a11c91db</a></strong></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p>As ever with cases of “compromised keys” we must ask ourselves if this could simply have been an insider looking for a bit on the side.</p><p>The bear market promises a long, tough road ahead for many smaller teams, especially in this context...</p><p><em>The future of Solana feels uncertain.</em></p><p>Following the <a href="https://rekt.news/ftx-yikes/">collapse</a> of FTX and <a href="https://rekt.news/sbf-mask-off/">downfall</a> of the now-imprisoned SBF with whom the ecosystem was so closely associated, it’s easy to see how an ecosystem dev might be sick from the fallout and be tempted to take the easy way out.</p><p><strong>As with so many of the <a href="https://rekt.news/leaderboard/">cases</a> we’ve covered, we’ll likely never know.</strong></p><p><em>Who’s next?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/rekt-outline-conc.png"/></figure></p>