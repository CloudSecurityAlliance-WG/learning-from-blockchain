<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/7/pancbunny2-header.png"/></figure>
<strong><a href="https://twitter.com/RektHQ/status/1399714766785028098?s=20">We sent it back,</a> and then they lost it.</strong></p><p><strong>How <a href="https://www.rekt.news/pancakebunny-rekt/">earitating.</a></strong></p><p>Two months ago PancakeBunny got rekt on BSC, now the same thing has happened on Polygon.</p><p>$2.4 million lost, and their second entry earned on our <a href="https://www.rekt.news/leaderboard/">leaderboard. (#33)</a></p><p>They say there’s a plan to compensate their users, so it seems they’re not ready to give up yet.</p><p>Despite the growing accusations of it being “an inside job”, the <a href="https://defillama.com/protocol/bunny">PancakeBunny TVL</a> is slowly returning.</p><p><em>Try not to lose it this time.</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/7/pancbunny2-investigates2.png"/></figure></p><p><em>From the <a href="https://pancakebunny.medium.com/polybunny-post-mortem-compensation-42b5c35ce957">official post-mortem.</a></em></p><p><strong>Attacker’s Address:</strong> <a href="https://polygonscan.com/address/0xa6021d8c36b2de6ceb4fe281b89d37d2be321431">0xa6021d8c36b2de6ceb4fe281b89d37d2be321431</a></p><p><strong>Attack TX Log:</strong> <a href="https://polygonscan.com/tx/0x25e5d9ea359be7fc50358d18c2b6d429d27620fe665a99ba7ad0ea460e50ae55">0x25e5d9ea359be7fc50358d18c2b6d429d27620fe665a99ba7ad0ea460e50ae55</a></p><p>The attacker made a small deposit in one of the Bunny Vaults and at the same time, made a large deposit directly to MiniChefV2 (SushiSwap)</p><p>They then called the function <em>withdrawAll</em> to execute the attack, using the amount deposited in the MiniChefV2 as interest.</p><p><strong>The attacker followed the following steps to exploit the polyBUNNY minter:</strong></p><p>Deposit 0.000000009416941138 SLP (~19,203 USD) into the polygon.pancakebunny USDT-USDC Vault.</p><p>Deposit 0.000023532935903931 SLP (~47,990,975 USD) to the USDT-USDC MiniChefV2 contract on SushiSwap.</p><p>This generated a performance fee of 0.000007006743943544 SLP (~14,284,950 USD) and minted 2.1 million polyBUNNY to the attacker</p><p>Dump polyBUNNY for WETH</p><p>Repay AAVE’s flashloan and exit the attack, gaining 1,281.702952074137533313 ETH.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/7/pancbunny2-price.png"/></figure></p><blockquote><p>The price of <a href="https://www.coingecko.com/en/coins/pancake-bunny-polygon">polyBunny</a> fell from $10 to $1.78.</p></blockquote><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p><strong>This <a href="https://twitter.com/peckshield/status/1415187038605758464?s=20">same exploit</a> was used on <a href="https://aperocket.medium.com/moving-forward-24b9ae22c428">“ApeRocketFi”</a>, a direct fork of PancakeBunny, just 2 days ago.</strong></p><p>ApeRocket lost $260K on BSC and $1M on Polygon, yet PancakeBunny didn’t prevent the same thing from happening to them.</p><p><em>Was somebody using the smaller protocol as a test, to check that their technique worked?</em></p><p>If so, why would they risk alerting PancakeBunny to the loophole? Perhaps somehow they knew that wouldn’t be an issue...</p><p>Of course, it’s possible that the attackers were not the same person, or that they didn’t realise the same attack vector was possible in the original code.</p><p><em>Somehow that seems unlikely.</em></p><p><strong>Who will send money to PancakeBunny now?</strong></p><p>We wish we hadn’t...</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/7/pancbunny2-conc.png"/></figure></p>