<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/09/daomaker-header.png"/></figure>
<strong>DAO Maker meets their maker.</strong></p><p><em>Again.</em></p><p>Less than a month ago <a href="https://medium.com/daomaker/dao-maker-statement-thursday-12th-of-august-2c3bb0d1bb69">they lost $7M.</a></p><p><strong>Now they’ve lost another $4M.</strong></p><p><strong>We didn’t cover the first exploit, but if you get rekt on repeat then we’ve got to say something.</strong></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/09/daomaker-investigates.png"/></figure></p><blockquote><p><em>Credit: <a href="https://twitter.com/mudit__gupta/status/1434059922774237185?s=28">Mudit Gupta</a></em></p></blockquote><p>DAOMaker’s init() function was left vulnerable, allowing the attacker to reinitialise 4 token contracts with malicious data. Then, the emergencyExit() function was used to withdraw the funds from each.</p><p>The four contracts and the withdrawal transactions are listed below:</p><p><a href="https://etherscan.io/address/0x6e70c88be1d5c2a4c0c8205764d01abe6a3d2e22">0x6e70c88be1d5c2a4c0c8205764d01abe6a3d2e22</a> - <a href="https://etherscan.io/tx/0xcb5be97496995d58da6f97491845040547b878e53a7b71f907a13408f3a54e5f">emergencyExit</a> with 13.5M CAPS</p><p><a href="https://etherscan.io/address/0xd6c8dd834abeeefa7a663c1265ce840ca457b1ec">0xd6c8dd834abeeefa7a663c1265ce840ca457b1ec</a> - <a href="https://etherscan.io/tx/0x4c273c2403aafd97e4b553f0e381cf1c63e5f2efebbe2ded7642a06f2b68c879">emergencyExit</a> with 2.5M CPD, <a href="https://etherscan.io/tx/0xec2115ddb7f5020b2410978bb13cd23a9a38291d35be310d7825e7faeb6df1f4">twice</a></p><p><a href="https://etherscan.io/address/0xdd571023d95ff6ce5716bf112ccb752e86212167">0xdd571023d95ff6ce5716bf112ccb752e86212167</a> - <a href="https://etherscan.io/tx/0x1692a57f19b5e8e4bc6a372ac3c83c77cd4a1ea78414377ea66d3d59f4a7d2b7">emergencyExit</a> with 1.44M DERC</p><p><a href="https://etherscan.io/address/0xa43b89d5e7951d410585360f6808133e8b919289">0xa43b89d5e7951d410585360f6808133e8b919289</a> - <a href="https://etherscan.io/tx/0xdd0176475165b83c702d49a876d4dc888b73477ad8833582c72aa6ca5e0bacc3">emergencyExit</a> with approx 20.6M SHO</p><p><strong>After the exploit and swap routine, the attacker then made init() calls on two more contracts.</strong></p><p>Both contracts, however, had already been called by a <a href="https://etherscan.io/address/0xcf28556ee95be8c52ad2f3480149128cca51dac1">new address</a>, whose transaction history shows a series of <strong>init()-emergencyExit()</strong> calls, extracting millions of SHO, as well as ALPHR and LSS.</p><p><strong>The final four transactions in this address show the extracted tokens being returned, then an ownership transfer; maybe some belated whitehat behaviour, or the devs trying to save what was left.</strong></p><p><strong>The attacker went on to sell each token:</strong></p><p><strong>Ternoa:</strong> <a href="https://etherscan.io/tx/0xbf38346aacf261f5e169a87ed874c33c21efb060c4a393e2b1443a3ac5d6e3fd">13.5M CAPS for 378,189 DAI</a> on 1inch</p><p><strong>Coinspaid:</strong> <a href="https://etherscan.io/tx/0x3436af2c84d67254a4b81adc350c91d1b98ae52b2ff84645d14d4245c2d08c27">5M CPD for 158,216 DAI</a> on 1inch</p><p><strong>DeRace:</strong> <a href="https://etherscan.io/tx/0xc586a6b94e09556abf46ae3aa8cffa8e46dfcb0c22bce0b024d5e01743ceba9e">1.44M DERC for 997,833 DAI</a> on 1inch</p><p><strong>Showcase:</strong> <a href="https://etherscan.io/tx/0x76163daf6cf0c815c02fb1a98f5c6283ee7a922cbad41218eb7a6452c91824c8">20.6M SHO for 67,663 DAI via MetaMask Swap Router</a></p><p><strong>Price effects (at time of writing).</strong></p><p><strong><a href="https://www.coingecko.com/en/coins/ternoa">Ternoa CAPS</a></strong> dropped to -45%, now -11%</p><p><strong><a href="https://www.coingecko.com/en/coins/coinspaid">CoinsPaid CPD</a></strong> dropped to -60% and now -25%.</p><p><strong><a href="https://www.coingecko.com/en/coins/derace">DeRace DERC</a></strong> dropped to -75% initially, now trading around -25%,</p><p><strong><a href="https://www.coingecko.com/en/coins/showcase-token">Showcase SHO</a></strong> trading at approx. -75%</p><p><em>The prices of all tokens involved have recovered somewhat since the exploit, although not as much as <a href="https://twitter.com/TheDaoMaker/status/1433994197380567041">claimed by DAO Maker.</a></em></p><p><strong>The DAO Maker source code is not public. Was it exposed to an outsider, or is there an insider who should not be trusted?</strong></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/09/daomaker-machine.gif"/></figure></p><p><em>Live footage of a DAO Maker developer getting rekt by their own protocol.</em></p><p><strong>As <a href="https://twitter.com/Mudit__Gupta/status/1434059928252006402?s=20">Mr Gupta</a> tweeted on Twitter;</strong></p><blockquote><p>DaoMaker claimed that they had audits from 3 firms but looking at <a href="https://t.co/9uTnNl5Z0K?amp=1">learn.daomaker.com/audits</a>, 2 of the audits seem to be for unrelated contracts while the third one from <a href="https://twitter.com/certik_io">@certik_io</a> points to a dead link.</p></blockquote><p><em>We await clarification from Certik.</em></p><p><strong>Even if all three audits were real and relevant, no hacked protocol should try and pass the blame to their auditors.</strong></p><p>Good security has to come from the team, not outsourced to an audit company.</p><p><em>Every step has to be perfect.</em></p><p>Hiring, spec design, code reviews, testing, fuzzing, formal verification, bug bounty program, incident handling, the list goes on…</p><p><strong>But perhaps it’s too late for DAO Maker, who will just have to make dao and mend.</strong></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/09/daomaker-mend.gif"/></figure>
<figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-text-linebreak.png"/></figure></p>