<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/05/burgerswap-header.png"/></figure></p><p>The hackers are really spoiling us this week with our fourth helping of the exact same meal.</p><p><strong>Can you ever really get tired of a classic?</strong></p><p>BurgerSwap was the next in a growing line of protocols to fall victim to the same hack that has been causing issues in recent weeks.</p><p>Since the market crash, this type of Drive-thru convenience exploit has been flavour of the month, and yet protocols still seem completely oblivious to this weakness in the contract. It’s as if they welcome these hacks with open arms, turning their backs to the counter and feigning surprise as people leave without paying.</p><p>It certainly appears as though even the easiest jobs can be royally messed up. BurgerSwap simply had to copy UniSwap’s code and yet there was something missing from their order.</p><p><strong>The question has to be asked, was this negligence? Or something a little seedier?</strong></p><p>Back to flipping burgers...</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/05/burgerswap-investigates.png"/></figure></p><p>At around 3 am on May 28th (UTC+8), $7.2M was stolen from #BurgerSwap in just 14 servings.</p><p>Thieves managed to make off with the following:</p><ul><li>4.4k WBNB ($1.6M)</li><li>22k BUSD ($22k)</li><li>2.5 ETH ($6.8k)</li><li>1.4M USDT ($1.4M)</li><li>432k BURGER ($3.2M)</li><li>142k xBURGER ($1M)</li><li>95k ROCKS</li></ul><p>And each attack looked like this:</p><ol><li><p>Flash swap 6k WBNB ($2M) from PancakeSwap.</p></li><li><p>Swap almost all WBNB to 92k BURGER on BurgerSwap.</p></li></ol><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/05/burgerswap-hack-1.png"/></figure></p><ol start="3"><li><p>Hackers created their own fake coin (a non-standard BEP-20 token) and formed a new trading pair with $BURGER of 100 fake tokens and 45k BURGER.</p></li><li><p>The 100 fake tokens were then swapped to 4.4k WBNB through the pool from step 3.</p></li><li><p>Attacker then made another swap from 45k BURGER to 4.4k WBNB.</p></li></ol><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/05/burgerswap-hack-2.png"/></figure></p><ol start="6"><li><p>In total the attacker received 8.8k WBNB for the two latest steps.</p></li><li><p>Swap 493 WBNB to 108.7k BURGER on BurgerSwap.</p></li><li><p>Repay flash swap.</p></li></ol><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/05/burgerswap-hack-3.png"/></figure>
Credit: <a href="https://twitter.com/FrankResearcher">@FrankResearcher</a></p><p>This exploit was made possible by the fact that the attacker could do reentrance and make a second swap before reserves, which are used to calculate the number of tokens in swaps, were updated.</p><p>Interestingly though, this seems to have been enabled by by a missing x*y=k check. Something which was present in the original univ2pair contract but was seemingly removed in this instance.</p><p>It seems unlikely that the developers at BurgerSwap would be so careless in their coding but what is the alternative? With the x*y&gt;k check removed, anyone can trigger a swap of any output size while paying only one unit of the input token, a deal straight from the saver menu.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/05/burgerswap-conc.png"/></figure></p><p>The number of hacks we have seen of projects on the BSC over the past week has been off the charts. This whole situation is eerily reminiscent of what happened in Autumn last year on ETH. A disappointing special offer which no-one wanted to see make a return.</p><p>While no-one likes to see the customers get short changed, it is increasingly difficult to <a href="https://twitter.com/burger_swap/status/1398205523141427200">find sympathy</a> for rogue, copycat entrepreneurs who try to emulate and profit from a tried and tested recipe, but who don’t care enough about the consumer to check the ingredients of their products, risking the health of the very people they derive profit from.</p><p><strong>That said, if you eat at a McDaniels or Burger Duke, are you not at least partly responsible for your own indigestion?</strong></p><p>BurgerSwap claims they are in the process of producing a detailed compensation plan for their customers. A welcome relief for many whose stomachs have been turned by this whole affair.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/05/burgerswap-footer.png"/></figure></p>