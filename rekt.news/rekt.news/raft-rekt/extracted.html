<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/raft-header.png"/></figure></p><p><strong>On Friday, <a href="https://twitter.com/raft_fi/">Raft</a> fell victim to an on-chain pirate raid, causing the project’s <a href="https://www.coingecko.com/en/coins/r">R stablecoin</a> to depeg.</strong></p><p>Although the infinite mint exploit should have netted a tidy $3.3M profit, the clumsy crypto corsair dropped the loot overboard.</p><p><strong>1570 ETH sent to the burn address and around $8k out of pocket <a href="https://twitter.com/0xngmi/status/1723073285263380924">overall</a>.</strong></p><p><em>An embarrassing, but ultra-sound, self-rekt.</em></p><p>Ancilia <a href="https://twitter.com/AnciliaInc/status/1723055359034568828">raised the alarm</a>, with the Raft team quickly <a href="https://twitter.com/raft_fi/status/1723057566664548623">acknowledging</a> the incident. An hour after the initial response, came the following <a href="https://twitter.com/raft_fi/status/1723073536909099302">update</a>:</p><blockquote><p>Update: Further minting of R has been paused.</p><p>Existing users are still able to repay their positions and receive their collateral.</p></blockquote><p>The next day, the team <a href="https://twitter.com/raft_fi/status/1723317254480425028">informed</a> users that a recovery plan is in the works (<em><a href="https://twitter.com/FrankResearcher/status/1723519462995898787">rugging</a> a <a href="https://rekt.news/bald-rekt/">rug-artist</a>, perhaps?</em>), while reminding users who had minted R that they are still able to recover collateral.</p><p><strong>The team also advised against speculating on the now-partially-unbacked stablecoin, adding:</strong></p><blockquote><p>The current version of Raft will be sunsetted.</p></blockquote><p><em>Will they manage to keep themselves afloat for a v2?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/09/rekt-investigates-linebreak.png"/></figure></p><p>Credit: <em><a href="https://twitter.com/AnciliaInc/status/1723055359034568828">Ancilia</a>, <a href="https://twitter.com/FrankResearcher/status/1723099971824582713">Igor Igamberdiev</a>, <a href="https://twitter.com/BlockSecTeam/status/1723224079170478142">BlockSec</a></em></p><p><strong>The hack involved inflating the value of collateral by liquidating previously opened positions from an address holding excess ETH (sourced via flash loan).</strong></p><p>The over-valued collateral then allowed the attacker to mint 6.7M R stablecoin, which were dumped for (<em>what should have been</em>) over $3M profit.</p><p><em>For a full technical breakdown of the exploit, see threads by <a href="https://twitter.com/AnciliaInc/status/1723055359034568828">Ancilia</a>, <a href="https://twitter.com/FrankResearcher/status/1723099971824582713">Igor Igamberdiev</a> and <a href="https://twitter.com/BlockSecTeam/status/1723224079170478142">BlockSec</a>. See also the team's <a href="https://mirror.xyz/0xa486d3a7679D56D545dd5d357469Dd5ed4259340/_Nk6_1_VvInyC0pdvHiZuAXiqm6tYSsGYGHSfOhcO1I">post-mortem</a>.</em></p><p><strong>The freshly minted R tokens were dumped into the existing liquidity pool, causing the price to tumble:</strong></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/raft-chart.png"/></figure></p><p><strong>The token’s collateral reserves were not affected, and any users who have a CDP on Raft should be able to return R and withdraw their collateral.</strong></p><p>Attacker address: <strong><a href="https://etherscan.io/address/0xc1f2b71a502b551a65eee9c96318afdd5fd439fa">0xc1f2b71a502b551a65eee9c96318afdd5fd439fa</a></strong></p><p>Attack tx: <a href="https://etherscan.io/tx/0xfeedbf51b4e2338e38171f6e19501327294ab1907ab44cfd2d7e7336c975ace7">0xfeedbf51…</a></p><p>Preparatory tx: <a href="https://etherscan.io/tx/0xa1378a4d61e81339daaf2c7c8bb669be42002919f10379c616d0aee34047794e">0xa1378a4d…</a></p><p>Exploited contract: <a href="https://etherscan.io/address/0x9ab6b21cdf116f611110b048987e58894786c244">0x9ab6b21cdf116f611110b048987e58894786c244</a></p><p>The profits, however, were not collected by the attacker, and were sent to the ETH <a href="https://etherscan.io/address/0x0000000000000000000000000000000000000000">null address 0x0000</a> instead. Igor Igamberdiev <a href="https://twitter.com/FrankResearcher/status/1723099982633332959">explains</a>:</p><blockquote><p>The problem is that the code for converting R to ETH and transferring it to the exploiter was called from another contract using delegatecall</p><p>But delegatecall looks at the storage of the parent contract, in which the slot with the exploit address was not initialized</p></blockquote><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/raft-oops.png"/></figure></p><p><strong><em><a href="https://twitter.com/peckshield/status/1723136855749873761/">Oops</a> indeed.</em></strong></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p><em>Despite how badly this exploit went for the attacker, they certainly <a href="https://twitter.com/giraffe0x/status/1723157477745967614">aren’t stupid</a>.</em></p><p><strong>Raft had been <a href="https://docs.raft.fi/additional-information/security">extensively</a> audited by four organisations, including <a href="https://github.com/trailofbits/publications/blob/master/reviews/2023-04-tempus-raft-securityreview.pdf">Trail of Bits</a> and a <a href="https://hatsfinance.medium.com/raft-finance-audit-competition-final-note-16e87dce23a2">Hats Finance</a> contest.</strong></p><p>As we’ve said before, even the best audits are <a href="https://twitter.com/trailofbits/status/1724344137065886183">no silver bullet</a>; incidents like these show the value of continued investment in a <a href="https://twitter.com/thebensams/status/1723485454627143784">full suite</a> of security practices.</p><p><em>But when vulnerabilities are still being <a href="https://twitter.com/aave/status/1720868368331219100">found in DeFi giants</a>, it reminds us that <strong>nowhere is truly safe.</strong></em></p><p><strong>When braving DeFi's stormy seas, we all must choose our vessel.</strong></p><p><em>Would you trust a Raft?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/rekt-outline-conc.png"/></figure></p>