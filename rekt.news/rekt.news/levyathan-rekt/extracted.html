<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/levy-header.png"/></figure></p><p><strong>Another TVL taken by a mysterious monster.</strong></p><p><a href="https://www.levyathan.finance/">Levyathan.finance</a> sank last week, along with its TVL of $1.5M.</p><p>The team have since issued a few tone-deaf tweets and long-winded Medium posts trying to shift the blame, but we’ll tell you how we see it.</p><p><strong>The Levyathan developers left the private keys to a wallet with minting capability available on Github.</strong></p><p><a href="https://github.com/levyathan-finance/governance/blob/master/hardhat.config.ts">~Four months</a> later, these keys were used to mint and dump LEV into oblivion.</p><p>Afterwards, when users tried to redeem what was left of their money, a bug in the withdrawal mechanism meant that their worthless tokens were also irretrievable...</p><blockquote><p>“Have a nice day”</p></blockquote><p><em><a href="https://twitter.com/Levyathan_index/status/1421194683900891136?s=20">Said</a> the Levyathan admins.</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/levy-price.png"/></figure></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/levy-investigates.png"/></figure></p><p><strong>The <a href="https://levyathan-index.medium.com/post-mortem-levyathan-c3ff7f9a6f65">official post-mortem</a> is almost irrelevant when you realise that they made it so easy for anyone to mint their token.</strong></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/levy-privkeys.png"/></figure></p><p><strong>As a result of the exploit, users were forced to use emergencyWithdraw() to attempt to retrieve their staked tokens.</strong></p><p>However, the emergencyWithdraw() logic contained a bug which referenced rewardDebt (a variable related to reward calculation) instead of user.amount as the quantity of tokens to be withdrawn.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/levy-withdraw.png"/></figure></p><p><strong>Some users who were quick to <a href="https://bscscan.com/tx/0x03c1ba947d451a8c7beff8ba09d6b505c84d8fee31462bb02ee0b07e9ca4c06b">withdraw</a> in this way noticed that they were receiving more tokens than expected, and continued to withdraw more and more LEV, depleting the contract and leaving nothing for those who came later.</strong></p><p>In their post mortem Levyathan provided an <a href="https://bscscan.com/address/0x6cadA45b257DA674f1169B4e68A59765226Fc9aE">address</a> to which users could return funds ”in an anonymous manner", which has received 3 billion dog tokens and one PLUGANAL.</p><p>The team later on provided a second <a href="https://www.bscscan.com/address/0xf3381970372fcA75270C0d67956Fd8D6304377D7">address</a> which has so far received ~150,000 BUSD <em>(<a href="https://bscscan.com/token/0xe9e7cea3dedca5984780bafc599bd69add087d56?a=0x3b5d5bb99258990313d9d620bf5ffb68603cfff9">coming from the first address provided by the Levyathan team</a>)</em>.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/levy-linebreak.png"/></figure></p><p><strong>What a shitshow.</strong></p><p>Leaving clearly labelled private keys visible on a public repo is unthinkable.</p><p>Especially when they grant access to total control <em>(no multisig)</em> over your protocol’s native token.</p><p>In their latest clumsy <a href="https://levyathan-index.medium.com/levyathan-what-future-for-the-project-1e345539972d">communication</a>, the Levyathan team pointed out the fact that as the private keys were publicly available, we can be sure “that it was not an inside job”.</p><p>Until they said that, we had assumed incompetence, but could the Levyathan team be stupid enough to to try and set up this “exposed keys” situation as an alibi?</p><p><em>You decide...</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/rekt-outline-conc.png"/></figure></p>