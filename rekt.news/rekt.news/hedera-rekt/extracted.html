<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/hedera-header.png"/></figure></p><p><strong>A nebulous threat rattled the entire <a href="https://hedera.com/">Hedera</a> ecosystem, yesterday.</strong></p><p><em>Fear, rumour and suspicion took hold as both users and devs attempted to make sense of the chaos.</em></p><p>The “<em>proof-of-stake public ledger</em>”, built on blockchain-alternative <a href="https://hedera.com/learning/hedera-hashgraph/what-is-hashgraph-consensus">Hashgraph</a>, saw its <a href="https://defillama.com/chain/Hedera">TVL plunge</a> by a third since the attack, from $36.8M to $24.6M.</p><p>The HBAR Foundation <a href="https://twitter.com/HBAR_foundation/status/1633803120328208386">announced</a> “<em>network irregularities</em>” and, given the widespread nature of the attack, users frantically sought a safe haven for their funds.</p><p>Dapps from across the network were affected, including AMMs <a href="https://twitter.com/Pangolin_Hedera/status/1633771791415132162">Pangolin</a> and <a href="https://twitter.com/HeliSwap_DEX/status/1633783357703061504">Heliswap</a>. After an initial <a href="https://twitter.com/SaucerSwapLabs/status/1633796307289505793">panic</a>, the larger SaucerSwap <a href="https://twitter.com/SaucerSwapLabs/status/1633845705638031362">stated</a> that their users had not been affected. The Hashport bridge was <a href="https://twitter.com/HashportNetwork/status/1633771330280767488">deactivated</a> in response to the attack.</p><p><strong>The lack of certainty caused chaos, and what turned out to be around $515k stolen by the attacker, turned into $12M of damage to the ecosystem.</strong></p><p>Later, Hedera <a href="https://twitter.com/hedera/status/1633925272830623746">announced</a> it would be “<em>turning off network proxies on mainnet, making it inaccessible</em>” to users. At the time of writing, Hedera <a href="https://status.hedera.com/">remains down</a> while investigations continue.</p><p><em>When will users get some clarity?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/09/rekt-investigates-linebreak.png"/></figure></p><p><strong>Details remain scant on exactly how the exploit worked, however, it is clear that the issue was in the network’s Smart Contract Service code.</strong></p><p>In a Twitter thread, Hedera <a href="https://twitter.com/hedera/status/1634055353435561986">explained</a> that “<em>The attacker targeted accounts used as liquidity pools on multiple DEXs that use Uniswap v2-derived contract code ported over to use the <a href="https://hedera.com/token-service">Hedera Token Service</a></em>”. HTS was audited by <a href="https://www.fpcomplete.com/blog/hedera-platform-audit/">FP Complete</a> in 2021.</p><p>The head of Pangolin <a href="https://twitter.com/jtrollip/status/1634057932882186240">published</a> a preliminary writeup which states the teams believed that the exploit was “<em>only affecting Hashport tokens. This proved to be false. Further investigation revealed all hts [Hedera Token Service] tokens were at risk</em>”.</p><p>This allowed the attacker to burn bridged/wrapped tokens, as well as remove LP positions from the affected DEXs. According to the report, some funds were bridged back to ETH, after the Hashport team deactivated the bridge, the attacker turned to CEXs.</p><p><strong>Attacker’s address: <a href="https://hashscan.io/mainnet/account/0.0.2015717?p2=1">https://hashscan.io/mainnet/account/0.0.2015717?p2=1</a></strong></p><p>The report puts losses from Pangolin at $120k. HeliSwap lost just $2K, according to their <a href="https://www.heliswap.io/news/hedera-vulnerability-event-log">rundown</a> of events.</p><p><strong>The attacker’s alleged addresses contain a total of around $515k;</strong> ~$60k of HBAR and $280k of HTS stablecoins <a href="https://hashscan.io/mainnet/account/0.0.2015717?p2=1">on Hedera</a>, and $175k of ETH <a href="https://etherscan.io/address/0x2fd2a8d39fd7c4751fea109a86fa4cdd989e6ad3">on Ethereum</a>.</p><p><em>Despite the news, the network’s native token, <a href="https://www.coingecko.com/en/coins/hedera">HBAR</a>, lost less than the rest of the (currently tanking) market.</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p><strong>In an industry known for its frequency of multimillion dollar hacks, striking a balance between a clear warning and sowing panic is tricky.</strong></p><p>Especially following the MyAlgo wallet-draining <a href="https://twitter.com/myalgo_/status/1632862464244162560">fiasco</a> last week, the realisation that this incident was not contained to any one protocol was bound to cause chaos.</p><p>While the pausing of the chain may have saved some user funds, it’s a worrying move which damages claims of legitimacy as a DeFi platform.</p><p>One <a href="https://hedera.com/">look</a> at Hedera’s “<em>decentralized and transparent governing body</em>” gives an idea of the kind of organisations involved. The likes of Boeing, Dell and Ubisoft don’t strike us as hardcore DeFi idealogues.</p><p>We may see some clarity over the next few days as to the exact mechanism of the exploit, but the damage has likely been done.</p><p><strong>DeFi users spook easily…</strong></p><p><em>…and with <a href="https://rekt.news/leaderboard/">good reason</a>.</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/rekt-outline-conc.png"/></figure></p>