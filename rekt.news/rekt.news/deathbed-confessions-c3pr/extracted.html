<section class="post-content"><p><figure><img alt="" src="https://lh6.googleusercontent.com/TLkLMvzALcncoyVu5MGEumqmlOqk7KWADtRJ8Uj62TXUWi_SZg_gw9iiF9hVi_vgMp55Jvpy5Bl0d_ZxOcmJfZnEALbmRDkcrfbNPaO3F4b-qsIEjOfU3Tp4bKk54JN2wzTCVDhE"/></figure>
<strong>The rekt reaper has a way of making people talk.</strong></p><p>In the final moments, as TVL approaches zero, and the drawdown becomes unbearable, a faceless figure enters the chat.</p><p>When a protocol is wounded beyond repair, and it’s time has come to shuffle off this mortal coil, the fourth and final horseman arrives to guide them to the afterlife, presenting himself in .gif format.</p><p><strong><a href="http://compounder.finance/">Compounder.finance</a> was rug pulled for over $12,000,000.</strong></p><p>In our volatile community, greed and desperation are punished and rewarded in equal yet unpredictable ways.</p><p>Here there is hope for the sinner, whose transgressions are forgotten as they escape down-chain in their cloak of anonymity.</p><p>Rekt is here to shine a light on the sinful - to expose their methods so that we <em>all</em> can learn.</p><p><strong>The compounder.finance site and Twitter account were deleted instantly.</strong></p><p><strong>A completed security audit offered our detectives the only lead.</strong></p><p>These are busy times at <a href="https://twitter.com/RektHQ">RektHQ</a>, a few hours had already passed when we started to investigate… When we contacted the auditors for a quote, they were less than pleased to see us.
<figure><img alt="" src="https://lh4.googleusercontent.com/j_yn7CTMvy6RhjtNHFw7jRwsT0Eossl9zY3lzlm5Uq-hxz2AE-V1Zf97vT11BfwAU-HH1YVRhIEfA6YqwHpDAaSA_dVNpY_VoSvGcUgGXyRdHVVqVOX03YWiJ1AWkK48OKTX6Nsf"/></figure></p><blockquote><p><strong><em>Please don’t send death shit like that, you for real had me scared for my safety for a minute over here and weaker hands might report that or some shit.</em></strong></p></blockquote><p>After our detective offered some reassurance, Solidity.finance provided us with the full <a href="https://solidity.finance/audits/CP3R/ChatLogs.pdf">chat logs</a> of their conversation with compounder.finance.
<figure><img alt="" src="https://lh6.googleusercontent.com/jmSOsLERtND5cPjpj5zRKXEsyPg-vqXNGixs02ru1ZYLSMTjxSN4S8ZtDflMFHiI4ImG7ou-B6XA6P201hR94CjS09-Pk7rVkQ2WR4mu0u8SIpjnXx2FPXr99UBJMc8phplKmMlk"/></figure>
Other victims also reached out to us, showing early conversations with compounder admins where they voiced their concerns.
<figure><img alt="" src="https://lh5.googleusercontent.com/-wS-a_Bpwg90_-BScXqJTSVhYm1nsNF2WyFBwrTUUslw-wy4eYm_t2cb0LUCwny5jLWGmfJZNN6uDQxSkcbJVOakKBpJJMjXaWr9mLxrhxxFkm_SY_gWUfFq15bg3TUft-UlUBsl"/></figure>
Solidity.finance told us that they had only briefly spoken with the admins, and although they had indeed audited the contract, they had stated in the document that although the pools were treasury controlled by a timelock, that the timelock offered no protection.</p><p>The following message is from their chat logs.
<figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2020/12/image.png"/></figure>
At this stage in our investigation, solidity.finance was still a suspect. We wanted to know why they had thought that the compounder.finance team seemed ”very trustworthy”
<figure><img alt="" src="https://lh3.googleusercontent.com/zAnDE5lhy4th23b04O90LfyMOzuZNKVQpGJSbvm1l9nyik3ALWHNN9w2ESpA9vVgbhUr4mG8RKoWHJs9vA-xxlg5tSHWy0cdYedy26u46htRO2F6DM6ueioCBHkqYyA336fkbeNY"/></figure><figure><img alt="" src="https://lh4.googleusercontent.com/3cTLMXUqzGK79tC0tquzA-fJHOgDMyfrNrJywsKGRyCvSNUPI6C097QgqvUeOBASoWAnvVnx4GGcYpkJgD2rHxcrc9uBkkoToqtqzn1DNBOlmBmk6gP-ueO1kwfyQtYjfYerCmsK"/></figure>
When reading the chat logs, we noticed that although the accounts had been deleted, one username remained - “keccak”.
<figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2020/12/image-1.png"/></figure>
<figure><img alt="" src="https://lh6.googleusercontent.com/2Rer5ONASpGduNUGsKPIG7WjVnvSk0qldLQC3qKVl1GaC8H9eTkAEuwRxApHZV1-eRNs4z18n2lRWjM9_aKDwDjunZPqkUIn2cUh1APe3MTSUnpjhd1YkInL0NMzc9L391CWpNtN"/></figure>
Although solidity.finance said keccak had deleted their account, we had already found their account and were trying to make contact.
<figure><img alt="" src="https://lh4.googleusercontent.com/n843mEGRcOHYLt5WsOuC5CpMrwAyICOJ9Mj92qHGWjSUko2CSgUhwsRMQhTKUNj0mQnFebVnlX3GXJ9J6aEErSbqYIf0nAAjR7SargO3_dm1xuUIRiLP3mHlF23pxpMjVqZ-Bk6B"/></figure>
Unfortunately, Vlad didn’t want to talk on the phone, so we sent them a message, not expecting him to respond.</p><p>Until…
<figure><img alt="" src="https://lh6.googleusercontent.com/iCjWb4HeUCo8uB3eZLfksQFxFJdMEruvDsRzzFmwqYZcDzlXOePo-OmTAsbF1HMT89YxccN-Xs1pGl39sI8B4V4HkKx5EDMqSMxLLqiahIAcE9urNAvJUfcMbqAYSGuzEEOpnt2U"/></figure></p><p>Vlad was ready to talk. Unfortunately, he wasn’t very cooperative.
<figure><img alt="" src="https://lh6.googleusercontent.com/HE93DRIaDmYVHG4436QTGIPxZKsXJ0Ly4UXIojAKIPrpapwfQUyEJofxc4X2hZqyTwRkVnRALWfghAwR_BzCD6r0rPK1JQ-nQ5N2zpKhaLJuKVe8WYRj81PdojtL9oV9X9g4a75t"/></figure><figure><img alt="" src="https://lh5.googleusercontent.com/KnQgeeZ8ui5i0loOefPMXBmxwqOOWX0cJB9TZCWAmE9Mt1COguIZB9C8v6D3niEhzCNJuCbj68G0L5eslhSSa83M3XKpLAxSRJ-PUftnrtbN1sLy3fUCmM6JfCUYiySLc9d5wejK"/></figure>
Vlad / keccak can still be reached on Telegram via @keccak, however he no longer responds, and has since deleted the images on his account.
We attach his old avatars here for your consideration and investigation.</p><p>We have been informed that - <em>The wolf one is from a famous Ukrainian cartoon in Russian, which says “come by if something comes up”</em></p><p><em>The left one is a anti-nuclear-weapon poster.</em></p><p>Not much help for the affected users unfortunately.
<figure><img alt="" src="https://lh6.googleusercontent.com/-C_fEe5K7VtTZBgWbN1x0T08gdPgA644Vf_UlKT7ZpIwM8Yvg0-VF_NbIlm3B6aPfgFVcicuLn60v12XKHvN0IMPukME0JQS1wO15OBo0mG00qKujj9N8rM3dFCpkOZ5HTZVvR2q"/></figure></p><p><strong>Once it became clear Vlad wouldn’t talk, we visited the official Compounder telegram group, where it became apparent that our reputation precedes us.</strong>
<figure><img alt="" src="https://lh6.googleusercontent.com/Bgibey9mMbZwxbZvLI3RpEsUKgqENRRGjySROwVuypAQaVeNqCnW4ZjPLOyXkLuzFDdAFs0UOXCVjeRdgZhrC3Fwaemg-0Jjfb0QSDBzvcDI_xggCXfFiRg52tqg3GwHIRQ9Qz6d"/></figure>
As we scrolled through the content of the chat, we saw all the typical behaviours that are caused by a freshly pulled rug.
<figure><img alt="" src="https://lh6.googleusercontent.com/3NDRvDXQyKMx7QH_4iiJs6BwoganIn8R0YE0fqk1z0MH8cRljLJwu8hUBaj_HYldnAuLBU1cP9yw6mEOuWfesjjBnhzs4UVDbZ3QjI9EWV7RdifLXikt3fy5jsB2IOoNy2dZNd9D"/></figure></p><p><strong>Even large players are humbled by the power of a rug pull. This <a href="https://twitter.com/defiyield_info">group leader</a> lost $1,000,000 and has opened his own investigation <a href="https://t.me/compounderopsec">group</a> (686 members) in an attempt to have some revenge.</strong>
<figure><img alt="" src="https://lh4.googleusercontent.com/NymcDlq36Hf0ZJWBbN4BDjIlBI4rHhOTYmDMYGgvSNYjFLYG_Y6VWgubCqj9FTl7_AjBfx3uji0gstUdJkec4jTgzNPZT6lqT88cEj11ZchK9X8yPaNP7YTNmmif0D2ps8pkyR8T"/></figure>
The thread can be found <a href="https://twitter.com/defiyield_info/status/1333731633393004545?s=20">here</a>.</p><p><strong>The Statistics</strong></p><p>As part of our investigation, <strong>we introduced Solidity.finance to <a href="https://twitter.com/vasa_develop">@vasa_develop</a> from Stake Capital</strong> and asked them to work together to create a full post-mortem of the incident.</p><p>The following data is taken from their <a href="http://simpleaswater.com/cp3r">report</a>.</p><p><strong>Assets Rugged (8):</strong></p><ul><li>8,077.540667 Wrapped Ether ($4,820,030.07)</li><li>1,300,610.936154161964594323 yearn: yCRV Vault ($1,521,714.80)</li><li>0.016390153857154838 Compound (COMP) ($1.79)</li><li>105,102,172.66293264 Compound USDT ($2,169,782.85)</li><li>97,944,481.39815207 Compound USD Coin ($2,096,403.68)</li><li>1,934.23347357 Compound Wrapped BTC ($744,396.89)</li><li>23.368131489683158482 Aave Interest bearing YFI ($628,650.174379401)</li><li>6,230,432.06773805 Compound Uniswap ($466,378.99)</li></ul><p><strong>Wallets with the funds after rug-pull</strong></p><p><a href="https://etherscan.io/address/0x944f214a343025593d8d9fd2b2a6d43886fb2474">0x944f214a343025593d8d9fd2b2a6d43886fb2474</a></p><ul><li>1,800,000 DAI</li></ul><p><a href="https://etherscan.io/address/0x079667f4f7a0b440ad35ebd780efd216751f0758">0x079667f4f7a0b440ad35ebd780efd216751f0758</a></p><ul><li>5,066,124.665456504419940414 DAI</li><li>39.05381415 WBTC</li><li>4.38347845834390477 CP3R</li><li>0.004842656997849285 COMP</li><li>0.000007146621650034 UNI-V2</li><li></li></ul><p>From the time the Deployer was first <a href="https://etherscan.io/tx/0x2fc406e07328e04022b555b5cab69bc932d29d1115eca3d121cbd49da90fb817">funded via Tornado.cash</a> to the time of the rug pull, the Deployer sent ETH to 7 different addresses. Most of these were one-off payments. <a href="https://etherscan.io/address/0x8f332c9ffb2be270d5c1c0de3fdac3d993517593">One of these addresses</a>, however, received 4 separate payments on Nov 19th, 20th, 22nd, and 23rd. Much of the funds from that address ended up an <a href="https://etherscan.io/address/0xd6c35c1828a7062e21468768c546a64dd1be1602">another address</a> holding over 1 million KORE (Only 10k KORE existed before they rug pulled).</p><p>The main culprit(s) of this hack were the 7 malicious Strategy contracts that were added to the codebase after the audit.</p><p>A non-malicious withdraw() function from a Strategy contract looks something like this.</p><p><figure><img alt="" src="https://lh5.googleusercontent.com/t_BQNl6cnQmq98OvUsKf63yo8N93mJWbEOimWOmpkk8RyQHiOCXnBd7Q5iNRRzXZuemKX9vQ66bysjBdZFxaSClpp_jPERv2b6rH7XDgewnUUI6GWJrMEORb7S1339TOjV7nc8uL"/></figure></p><p>Notice that we have some checks like:</p><p><figure><img alt="" src="https://lh5.googleusercontent.com/ZKGym0FbW_OC44MliLLqmvMJjbr2RanORW_G8pcdXTnWby52DXxayqpkIXFeJOEtpxbRZdncWo7yzSXyyAIsRmtF1kDXh1MAPS6-LmHqyOgt3Cuh_3s0dA1nJAbzEzmmQpYip2LV"/></figure>
These checks were missing in the 7 malicious Strategy contracts. This allows the Controller contract (which was controlled by the <a href="https://etherscan.io/address/0x079667f4f7a0b440ad35ebd780efd216751f0758">rug-puller strategist</a>) to withdraw the assets from the Strategy.</p><p>(Note the missing checks below in the malicious withdraw function)</p><p><figure><img alt="" src="https://lh4.googleusercontent.com/LX2pt7hp6dieDg5bU-6hMQkIFeAh9ZCABSIADVQZ62Y6OXcF6lRk6eAWuYog5Hlz2GP2_o5tNmDhbKHF0bEYr1vjHRoOPCXn03Gdq-uyiSgushapH-slIkt87Dl7BSQC5QRHw0ou"/></figure>
The complete rug-pull can be explained in 4 steps.</p><p><strong>Step 1</strong></p><p><a href="https://etherscan.io/address/0x079667f4f7a0b440ad35ebd780efd216751f0758">Compounder.Finance: Deployer</a> deployed 7 Malicious Strategies with manipulated withdraw() functions.</p><p><strong>Step 2</strong></p><p><a href="https://etherscan.io/address/0x079667f4f7a0b440ad35ebd780efd216751f0758">Compounder.Finance: Deployer</a> Set and Approve 7 Malicious Strategies in StrategyController via Timelock (24h) transactions.</p><p><strong>Step 3</strong></p><p><a href="https://etherscan.io/address/0x079667f4f7a0b440ad35ebd780efd216751f0758">Compounder.Finance: Deployer</a> (strategist) called inCaseStrategyTokenGetStuck() on StrategyController which abuse the manipulated withdraw() function of the Malicious Strategies to transfer the tokens in the Strategies to the StrategyController. Do this for all 7 Malicious Strategies.</p><p><strong>Step 4</strong></p><p><a href="https://etherscan.io/address/0x079667f4f7a0b440ad35ebd780efd216751f0758">Compounder.Finance: Deployer</a> (strategist) called inCaseTokensGetStuck() on the StrategyController which transfers the tokens from the StrategyController to the <a href="https://etherscan.io/address/0x079667f4f7a0b440ad35ebd780efd216751f0758">Compounder.Finance: Deployer</a> (strategist) address. Now the <a href="https://etherscan.io/address/0x079667f4f7a0b440ad35ebd780efd216751f0758">Compounder.Finance: Deployer</a> (strategist) has full control over 8 assets valued at $12,464,316.329.</p><p>From here the assets have been transferred to multiple addresses listed<a href="https://www.notion.so/Compounder-Finance-Post-Mortem-Report-9bf6b17dc1304606bb975968039a6dc8"> here</a>.</p><p><strong>Excellent work from <a href="https://twitter.com/vasa_develop">@vasa_develop</a>.</strong></p><p><strong>If you are a whistleblower, cyber sleuth or Etherscan detective and you have something to contribute, contact us.</strong></p><hr/><p><figure><img alt="" src="https://lh3.googleusercontent.com/4Ov6KyZOXXKLhn3ia1GsHXTlqJrJufMyscsMjjs8Ndd7OF6aVv6ULbfwodnZRZN_00m-iF4Bd3IZgCy4_z29XT8544n1sPjSd3COIRottpQgTgZ-1eF9jcJ75U6bBoveI6cSlg5g"/></figure>
<strong>Judgement Day:</strong></p><p>Who is to blame?</p><p>After our analysis, <strong>we know it’s not the auditors,</strong> who dutifully completed <a href="https://solidity.finance/audits/CP3R/">their </a>task, making sure that Compounder Finance stayed safe from external attacks, while also voicing their concerns in their<a href="https://solidity.finance/audits/CP3R/"> audit report</a> and the<a href="https://solidity.finance/audits/CP3R/ChatLogs.pdf"> TG chat</a>.</p><p>Perhaps they could have voiced these concerns slightly louder, but in the end, the ultimate responsibility will always lie with the depositor.</p><p>Compounder.finance used a timelock as an indicator that they wouldn’t pull the rug. We know now that this method can’t be trusted. If it is used, an automated alert system or dashboard should be put in place to monitor transactions at that address.</p><p>24 hours appears to be insufficient to provide enough warning for users to remove funds.</p><p><strong>Not all projects with anonymous founders are scams. This entire industry was founded by an anon.</strong></p><p>However, nearly all scams are projects with anonymous founders. As a community, we need to be wary of these projects; especially those who use untraceable sources of funds like Tornado.cash.</p><p><strong>The mere existence of an audit report is not sufficient to assure a projects' safety or legitimacy.</strong> Audits often focus on risks from external attackers more than internal - perhaps this is an area where auditors need to improve.</p><p>Even with audits, timelocks and burnt keys, depositors are always at the mercy of other users, who may dump huge amounts of tokens onto the market at any time.
<figure><img alt="" src="https://lh5.googleusercontent.com/m44dt8mlCqX_pt-Pm7xDUEJJFvZ78tpUndfyCPqpOfsz40B0i8siXxY_TnFHZIati3P8IPlKtrsn4urG_lCY66X5hRagresLo5uRqwIbuDpkHW4-2C0ar1TOG7lqrpLvBCFK6MlF"/></figure>
<strong>Solidity.Finance: The Official Statement</strong></p><blockquote><p><em>The Compounder team swapped the safe/audited Strategy contracts and replaced them with malicious 'Evil Strategy' contracts that allowed them to steal users funds. They did this through a public, though clearly unmonitored,  24-hour timelock.</em></p><p><em>This issue of centralized control by the C3PR team was raised in our audit report and our discussions with their team. The team had the power to update strategy pools and they did so maliciously here to steal users’ funds. In an effort to be transparent, anyone can view our chat logs with the C3PR team <a href="https://solidity.finance/audits/CP3R/ChatLogs.pdf">here: </a></em></p><p><em>Historically, our audits have focused on the risks to projects from external attackers, with some discussion on risks posed by project teams as we did here. We will take this unfortunate event as a learning opportunity, and moving forward will provide more robust details in easy to understand language on risks stemming from developers’ control.</em></p></blockquote><p><figure><img alt="" src="https://lh4.googleusercontent.com/9YXkVrtF4HWEpH_Wyf9N7T6ttzQGR7m-Dfg5At40sFJV4Rz0FbF_7FLEn_E5SM2D6HSeG7iymcg7T9DSLJkBP8SSCL0EuTWdiia6nnGhXD1vy-4ChPhbQh_seYfFHXRb94Wh1ILc"/></figure></p><p>We all know we should read smart contracts before we invest, but the knowledge barrier is high. Not everyone knows what to look for, and those who do are not incentivised to share their findings.</p><p>In the case of C3PR, users who listened were made aware of the danger very early on, and the code that made the rugpull possible was always present.</p><p>Despite this, over $12,000,000 accumulated in the contract, which can now be labelled as one of the largest rug pulls of all time.
<figure><img alt="" src="https://lh5.googleusercontent.com/5GlWMNDDXxJnsVsr0MxTgGKLmHwwlEjF7ufbN7LefUMdNaGsPDSCExLRHjavO4Vg4lQkR_wzRNF4jFxOqH6v4BsMmFUS7UXF_wMyR8S1xdjGVloDBVwR-bS6EZ1bBnPDFtXDvdMt"/></figure></p>