<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/seneca-header.png"/></figure></p><p><strong>Over $6.4 million was stolen from users wallets on February 28, thanks to the bad tao of Seneca.</strong></p><p>First <a href="https://twitter.com/spreekaway/status/1762857769714012217">reported by spreekaway</a> on X, the attack involved a critical approval exploit,  affecting users on Arbitrum and Ethereum.</p><p><em>Roughly 80% of the funds were returned within a day, but the remainder has been transferred to 2 addresses, possibly as a bounty.</em></p><p>During the canceled audit contest this past November, a security researcher <a href="https://twitter.com/cawfree/status/1762895548426715419/photo/1">caught the same bug</a> behind the attack.</p><p><strong>“Seneca is using battle-tested code, publicly verifiable on <a href="https://github.com/SenecaDefi/SenecaProtocol">Seneca's GitHub</a>.” Seneca made this statement on X shortly after <a href="https://twitter.com/SenecaUSD/status/1724882009820893401">abruptly closing</a> their <a href="https://twitter.com/sherlockdefi/status/1721863251946856639">Sherlock audit contest</a> due to potential code licensing issues.</strong></p><p>Weeks later they went into battle and launched without fear, under the belief that they had enough armor thanks to the <a href="https://github.com/HalbornSecurity/PublicReports/blob/master/Solidity%20Smart%20Contract%20Audits/Seneca_SenecaDefi_Smart_Contract_Security_Assessment_Report_Halborn_Final.pdf">audit done by Halborn</a>  Security.</p><p>The source of the bug, the Chamber contract, was audited prior to deployment, according to Seneca. To note, some of Halborn’s findings were approval related, this exact issue was not highlighted.</p><p>Clearly the other warriors on the battlefield were up for the challenge, because it only took them less than 2 months to find cracks in Seneca’s armor.</p><p><em>Post-hack, others in the community claimed they were getting <a href="https://twitter.com/danielvf/status/1762862834252210224">booted from Discord</a> for reporting the bug.</em></p><p><strong>Clearly Seneca knew there were issues, but chose the reckless route.</strong></p><p>Revoke approvals if you were unfortunate to invest in this disaster.</p><p>Ethereum:</p><p>PT-ezETH: 0x529eBB6D157dFE5AE2AA7199a6f9E0e9830E6Dc1</p><p>apxETH: 0xD837321Fc7fabA9af2f37EFFA08d4973A9BaCe34</p><p>PT-weETH: 0xBC83F2711D0749D7454e4A9D53d8594DF0377c05</p><p>PT-rsETH: 0x65c210c59B43EB68112b7a4f75C8393C36491F06</p><p>Arbitrum:</p><p>PT-weETH: 0x11446bbb511e4ea8B0622CB7d1437C23C2f3489b</p><p>stEUR: 0x7C160FfE3741a28e754E018DCcBD25dB04B313AC</p><p>PT-aUSDC: 0x4D7b1A1900b74ea4b843a5747740F483152cbA5C</p><p>wstETH: 0x2d99E1116E73110B88C468189aa6AF8Bb4675ec9</p><p>PT-rsETH: 0x2216E32006BB80d20f7906b88876964F9AF68aFb</p><p><strong>Bad decisions or just another bad protocol?</strong></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/09/rekt-investigates-linebreak.png"/></figure><br/>Credit: <em><a href="https://twitter.com/0xAdamDecentral/status/1762893022302495224">Crypto Smith</a>, <a href="https://twitter.com/SenecaUSD/status/1762886130561630227">Seneca</a>, <a href="https://twitter.com/spreekaway/status/1762857769714012217">Spreek</a>, <a href="https://twitter.com/BeosinAlert/status/1763024503452611038">Beosin Alert</a></em></p><p>The exploit took advantage of a bug in Seneca's code to drain assets from users who had active approvals to certain contracts.</p><p><strong>The attacker used constructed calldata parameters to call transferfrom and transfer tokens that were approved to the project's contracts to the attacker's address.</strong></p><p>This allowed the exploiter to steal any undeployed LSTs from the user's wallet.</p><p><em>Contracts couldn’t be paused due to a <a href="https://twitter.com/peckshield/status/1762870782495985750">bad implementation</a> of the pause function. Because the pause and unpause <a href="https://twitter.com/ddimitrovv22/status/1762886306420379864">functions are internal</a>, there is no way to call them.</em><br/><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/seneca-transactions.png"/></figure></p><p><em>The exploiter even stole 50k senUSD from the <a href="https://arbiscan.io/tx/0x3fe4b1486f2a800aa39131b359c0fc4fda0f4aaf621710c6b6754b4107a00fd1">Seneca’s team’s address</a>. 50K that was approved <a href="https://arbiscan.io/tx/0x10857f92ac51ee6c6a4d8ce451cb2a52ec776c2e85457bee84bbb44bf13d1010">33 days earlier</a>, but never deployed. Should we wonder why?</em></p><p><strong>Over 1.9k of ETH was stolen involving various LSTs that were swapped for ETH. Currently being held in 3 addresses.</strong></p><p>Exploiter addresses 1: <a href="https://etherscan.io/address/0x94641c01a4937f2c8ef930580cf396142a2942dc">0x94641c01a4937f2c8ef930580cf396142a2942dc</a></p><p>Exploiter addresses 2: <a href="https://etherscan.io/address/0x5217c6923a4efc5bcf53d9a30ec4b0089f080ed0">0x5217c6923a4efc5bcf53d9a30ec4b0089f080ed0</a>Exploiter addresses 3: <a href="https://etherscan.io/address/0xe83b072433f025ef06b73e0caa3095133e7c5bd0">0xe83b072433f025ef06b73e0caa3095133e7c5bd0</a></p><p>Example attack tx: <a href="https://etherscan.io/tx/0x9f3712672be7a120757d42fbe15ceefe9578914946bacbd0f3531e7fb7305576">0x9f371267</a></p><p><em>Seneca <a href="https://twitter.com/SenecaUSD/status/1762886130561630227">addressed the exploit</a> a few hours after. Instructing users to revoke approvals. But the damage was already done.</em></p><p><strong>A few hours later, Seneca posted an <a href="https://etherscan.io/tx/0x6e81e21ae6345279060de5c2c27378e2dca4c27a83615c8d835d218c4f66ffbd">onchain</a> message <a href="https://twitter.com/SenecaUSD/status/1762999045109248461">on X</a> addressing a Whitehat, requesting the funds be returned for a 20% bounty.</strong></p><p>Shortly after, the <a href="https://twitter.com/SenecaUSD/status/1763181438113865960">hacker returned</a> 1,537 ETH to the <a href="https://etherscan.io/address/0xb7aF0Aa318706D94469d8d851015F9Aa12D9c53a">Gnosis Safe address</a> and transferred 300 ETH to 2 new addresses.</p><p>Address 1: <a href="https://etherscan.io/address/0x0c77350c4bde539ffcee261a149dbc6e6afda517">0x0C77350C4BDe539FfCee261A149dbc6e6afDA517</a></p><p>Address 2: <a href="https://etherscan.io/address/0xa07c64e55f52aaf5c361321cf01b316ecbddb5a9">0xa07c64E55F52AAf5c361321CF01b316eCbddB5A9</a></p><p>They claim a <a href="https://twitter.com/SenecaUSD/status/1762920309919740307">post-mortem</a> will be published once all of the information is collected.</p><p>The exploiter's address behind the attack was <a href="https://etherscan.io/tx/0x88f54ae9606ebf3632f65a94a2fe4676cca59ab2eb8931f3d61fc0fd615db132">funded</a> 5 months ago through <a href="https://fixedfloat.com/">FixedFloat</a>. It remained dormant, until shortly before the attack was carried out on Seneca.</p><p>Follow the <a href="https://metasleuth.io/result/eth/0x94641c01a4937f2c8ef930580cf396142a2942dc?source=8cf443b6-176d-4202-8122-a8b641ee7062">flow of funds</a>:<br/><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/seneca-funds.png"/></figure></p><p><strong>Will Seneca do their due diligence or continue the pattern of irresponsibility?</strong></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p>The warning signs were there from <a href="https://twitter.com/qedk_/status/1762903467255853394">several</a> in the Web3 security community. Everybody sounded the alarm, except Seneca.</p><p><em>Seneca acted bulletproof with their battle tested (i.e. forked) code. A team member, in a since <a href="https://twitter.com/0xTaylor_/status/1762901759805284607">deleted Tweet</a> bragged about their pristine code, all while trashing Sherlock in the process.</em></p><p><strong>Claiming <a href="https://twitter.com/0xAdamDecentral/status/1762895194893201466">no legal liability</a> is a nice shady cherry on top of this hot mess.</strong></p><p>There is a thin line between cockiness and ignorance and Seneca fell face first on one side. Which side do you think it is?</p><p><em>Maybe they should have spent more time getting their code locked tight instead of <a href="https://twitter.com/SenecaUSD/status/1762857953730719991">marketing</a> a broken project.</em></p><p>There is no such thing as having too many eyes on your code. The more audits, contests and security reviews the better.</p><p><em>The worst case scenario was likely avoided, thanks to the attacker returning most of the funds, but this could have been avoided.</em></p><p>If you don’t pay the white hats to try to break your code, they'll be forced to make an example of you.</p><p><strong>But given the way Seneca handled this situation, can you blame them?</strong></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/rekt-outline-conc.png"/></figure></p>