<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/socket-header.png"/></figure></p><p><em>Infinite approvals… the ultimate leap of faith.</em></p><p><strong>Socket’s Bungee bridge lost $3.3M yesterday to an attack draining addresses that had previously approved the <a href="https://etherscan.io/address/0x3a23f943181408eac424116af7b7790c94cb97a5">SocketGateway contract</a> on Ethereum.</strong></p><p>Shortly after the alarm was <a href="https://twitter.com/spreekaway/status/1747337879771033632">raised</a>, the team <a href="https://twitter.com/SocketDotTech/status/1747349422730813525">acknowledged</a> the hack, having <a href="https://etherscan.io/tx/0xac75adcc1cb3fef158c4f200c48fcbcbb9b6ce3250bdf3751d6231d41a9e604b">patched</a> the vulnerability just 14 minutes after the <a href="https://etherscan.io/tx/0xc6c3331fa8c2d30e1ef208424c08c039a89e510df2fb6ae31e5aa40722e28fd6">attack began</a>.</p><p>Wallet provider Rainbow also <a href="https://twitter.com/rainbowdotme/status/1747360808772792762">informed</a> their users, as Socket’s contracts are used by the in-app bridging feature. They urged users to check whether their address was affected and revoke approvals via <a href="https://twitter.com/RevokeCash/status/1747352408022245790">RevokeCash’s dedicated tool</a>.</p><p><strong>As the over <a href="https://rekt.news/orbit-bridge-rekt/">$80M NYE attack</a> on Orbit shows, bridges continue to be a prime target for blackhats, and must be subject to the highest levels of scrutiny whenever any changes are made.</strong></p><p><em>Why did a <a href="https://twitter.com/0xdface/status/1747355730603078081">known bug</a> make it to production on a live bridge?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/09/rekt-investigates-linebreak.png"/></figure></p><p>Credit: <em><a href="https://twitter.com/qckhp/status/1747344887425450475">qckhp</a>, <a href="https://twitter.com/peckshield/status/1747353782004900274">Peckshield</a>, <a href="https://twitter.com/BeosinAlert/status/1747450173675196674">Beosin</a></em></p><p><strong>The attack was due to a lack of validation of user input contained in a new route <a href="https://etherscan.io/tx/0x1df44e224c7a715da25fa33dcad2ca3a930d1a4dafd263e61c07b52673d505f4">added</a> to the bridging contract three days prior to the exploit.</strong></p><p>The vulnerable route’s <a href="https://etherscan.io/address/0xcc5fda5e3ca925bd0bb428c8b2669496ee43067e#code">contract</a> itself neglects to validate the swapExtraData parameter, <a href="https://twitter.com/qckhp/status/1747344887425450475">allowing</a> an exploiter to inject a transferFrom call, and send approved assets from victim addresses to their attack contract.</p><p>As Beosin <a href="https://twitter.com/BeosinAlert/status/1747450173675196674">points out</a>:</p><blockquote><p>It did not consider the case where the caller transfers in 0 WETH, allowing the caller to specify other functions in the call and still pass the balance check.</p></blockquote><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/socket-code.png"/></figure></p><p>Attacker’s address: <strong><a href="https://etherscan.io/address/0x50df5a2217588772471b84adbbe4194a2ed39066">0x50df5a2217588772471b84adbbe4194a2ed39066</a></strong></p><p>SocketGateway contract: <a href="https://etherscan.io/address/0x3a23f943181408eac424116af7b7790c94cb97a5">0x3a23f943181408eac424116af7b7790c94cb97a5</a></p><p>Socket contracts have audits by both <a href="https://github.com/SocketDotTech/audits/blob/c357981ecbd9f070bedd9260c2ec0d7726f820b4/Socket/Socket%20Liquidity%20Layer%20(prev.%20FundMovr)-Audit-Report-By-PeckShield.pdf">Peckshield</a> and <a href="https://consensys.io/diligence/audits/2023/02/socket/">Consensys Diligence</a>. However, given that the new route was added just three days prior to the exploit, neither audit examined the vulnerable code.</p><p><strong>Funds stolen include ETH, MATIC, WBTC, WETH and DAI totalling approximately $3.3M.</strong></p><p>The stolen assets remain in the attacker's address, which has received a <a href="https://etherscan.io/tx/0xff5e81a0191c53f1109442dcb3de47a2ac6be84dcc784bc0fa84e7db808d5192">message</a> threatening to dox the attacker if not paid off:</p><blockquote><p>100 ETH and I'll throw away the timing analysis routing through FixedFloat that doxxes you. After 6 hours I go to Zach. Act swiftly.</p></blockquote><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p><strong>Infinite approvals strike again.</strong></p><p>Despite Bungee’s response that “<em>Bungee doesn't request infinite approvals by default</em>”, other protocols which route via the affected contract must subscribe to the UI before security mindset.</p><p><em>Otherwise, it’s hard to believe that <a href="https://dune.com/queries/3356512">so many users</a> would be vulnerable.</em></p><p><strong>With the biggest loss at over $600K and the five hardest-hit victims each losing over $100K, this will have been a costly lesson in approvals hygiene for some.</strong></p><p>Without a regular revoking detox, token approvals sit waiting for a live (<em>or forgotten</em>) project to be exploited. And given that tokens are stolen directly from users’ wallets, there’s no need to have any funds deposited to fall victim.</p><p><strong>However, all this could have simply been avoided by not making risky, unaudited upgrades to an existing bridge contract.</strong></p><p><em>Have you <a href="https://revoke.cash/">checked</a> your approvals lately, anon?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/rekt-outline-conc.png"/></figure></p>