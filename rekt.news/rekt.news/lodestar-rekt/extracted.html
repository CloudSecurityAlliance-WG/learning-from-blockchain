<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2022/12/lodestar-header.png"/></figure></p><p><strong><a href="https://www.lodestarfinance.io/">Lodestar Finance</a>, a Compound fork on Arbitrum, is the latest victim of the mass market manipulation that has affected both people and protocols across our industry.</strong></p><p>On Saturday, the price oracle of plvGLP collateral was manipulated, allowing the attacker to drain their lending pools for a profit of ~$6.5M.</p><p>According to the <a href="https://twitter.com/lodestarfinance/status/1601686921566375936">official announcement</a>, “<em>2.8 Million of the GLP is recoverable, which is worth about $2.4 million.</em>” The team has <a href="https://twitter.com/LodestarFinance/status/1601697374937939968">appealed</a> to the hacker to negotiate a white-hat bounty.</p><p><strong>The incident saw the token <a href="https://www.coingecko.com/en/coins/lodestar">LODE</a> dump by ~70% and <a href="https://defillama.com/protocol/lodestar-finance">TVL</a> drop to just $11.</strong></p><p><em>That’s <a href="https://rekt.news/leaderboard/">#77 on the leaderboard</a> for Lodestar Finance.</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/09/rekt-investigates-linebreak.png"/></figure></p><p>Among Lodestar’s collateral assets is the yield-bearing plvGLP, representing GLP locked in <a href="https://plutusdao.io/">Plutus DAO</a>’s vault. Using flash loans, the attacker manipulated the plvGLP price reported by Lodestar’s GLPOracle contract, allowing them to “borrow” all the funds supplied on the platform.</p><p>The Lodestar <a href="https://docs.lodestarfinance.io/documentation/security">docs</a> state that:</p><blockquote><p>we are relying on Chainlink Oracles for accurate pricing <strong>(with the exception of plvGLP)</strong></p></blockquote><p><em>An inviting note for any would-be attackers…</em></p><p><strong><a href="https://twitter.com/SolidityFinance/status/1601684153740963840">Solidity Finance</a> summarised the root cause:</strong></p><blockquote><p>The GLPOracle did not properly take into account the impact of a user calling donate() on the GlpDepositor contract, which inflates the assets of the GlpDepositor contract, and therefore the oracle-delivered price of the plvGLP token.</p></blockquote><p>Lodestar’s preliminary post mortem <a href="https://blog.lodestarfinance.io/post-mortem-summary-13f5fe0bb336?gi=9d8175e9c79c">gives</a> further details of the exploit, as well as pointing out that “<em>the oracle can’t be allowed to undergo instantaneous change within the same block.</em>”</p><p>Certik’s <a href="https://www.certik.com/resources/blog/TqTyq4vYHl8JzS7zyJye9-lodestar-finance-incident-analysis">report</a> contains a full step-by-step of the attack flow.</p><p><strong>Attacker’s address <a href="https://arbiscan.io/address/0xc29d94386ff784006ff8461c170d1953cc9e2b5c">0xc29d94386ff784006ff8461c170d1953cc9e2b5c</a></strong></p><p><strong>Example exploit tx:</strong> <a href="https://arbiscan.io/tx/0xc523c6307b025ebd9aef155ba792d1ba18d5d83f97c7a846f267d3d9a3004e8c">0xc523c630…</a></p><p>The 343 ETH ($430k) necessary for the attack was bridged <a href="https://etherscan.io/address/0x7093486a8b4624b9f5501b7cd7a60545e02e9164">from</a> Polygon three months ago. Following the exploit, the funds were swapped to ETH, bridged back to mainnet and dispersed to <a href="https://etherscan.io/address/0xb50f58d50e30dfdaad01b1c6bcc4ccb0db55db13">multiple addresses</a>.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p><strong>Manipulating the price of collateral has been a popular attack technique since the beginning of DeFi, but especially in recent times, as this incident follows the attacks on both <a href="https://rekt.news/mango-markets-rekt/">Mango</a> and <a href="https://rekt.news/moola-markets-rekt/">Moola</a> Markets, who lost $115M, and $8.4M respectively, in October.</strong></p><p>The above examples had funds partially or fully returned, ensuring users didn’t totally lose out. Yet two days have now passed since the initial attack on Lodestar, and no mention of any planned reparations has yet been made.</p><p><em>Forking an existing project, even long-standing and resilient protocols, does not guarantee the same security.</em></p><p>But this paragraph in the Lodestar <a href="https://docs.lodestarfinance.io/documentation/security">documentation</a> suggests they may not have realised as such…</p><blockquote><p>Lodestar is a Compound fork at the core, and Compound has some of the most battle-tested contracts in all of DeFi. We have added code to support a few changes we have made, namely adding Arbitrum support, DPX, MAGIC and plvGLP support, tweaking some Interest Models, and a few other small changes.</p></blockquote><p><strong>Time is the best security audit of all, but smart contract changes render even the most time-tested protocols open to new vulnerabilities.</strong></p><p><em>Another market manipulated, more millions misplaced, and the market manipulators move on…</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/rekt-outline-conc.png"/></figure></p>