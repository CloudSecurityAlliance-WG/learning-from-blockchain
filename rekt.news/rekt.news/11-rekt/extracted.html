<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/06/11-header.png"/></figure></p><p><strong>This one almost struck a <a href="https://twitter.com/NerveFinance/status/1407481720220307456?s=20">nerve</a>.</strong></p><p><a href="https://eleven.finance/">Eleven.finance</a>, a yield aggregator on Binance Smart Chain (BSC) and Polygon (MATIC) was exploited for a total of $4.5M.</p><p>Some feared that it was the much larger Nerve Finance who was under attack, but it was in fact the NRV vault of Eleven Finance.</p><p><em>There’s no rest for the wicked - who would attack at such an ungodly hour?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/06/11-investigates.png"/></figure></p><p>Credit: <a href="https://twitter.com/0xdeadf4ce">0xdeadf4ce</a></p><p><a href="https://bscscan.com/tx/0xeaaa8f4d33b1035a790f0d7c4eb6e38db7d6d3b580e0bbc9ba39a9d6b80dd250">Transaction details here.</a></p><p><strong>The root cause was a function called emergencyBurn() in the intermediary vault used to track anySwap / Nerve-bridged assets nrvBTC, nrvETH and nrvFUSDT in the Eleven “MasterMind” farming contract.</strong></p><p>The attacker first took a Flashloan of each asset’s underlying token balance in the “MasterMind” contract (Binance-pegged BTC, ETH and USDT) to convert these into nrvBTC, nrvETH and nrvFUSDT respectively.</p><p><strong>Nerve 3Pool and PancakeSwap BUSD - NRV liquidity provider positions were also affected.</strong></p><p>A vulnerable function emergencyBurn() in the intermediate vault contract allowed the attacker to withdraw the deposited balance without having the withdrawal being accounted for internally.</p><p><strong>As a result the attacker was able to not only remove his own deposit but the full balance of the same amount that had been in the vault before as well.</strong></p><p>The attacker used the Nerve bridge to transfer out 2,293 ETH in proceeds to the address 0xdb2d590aCe7cAe51DF1fB3312738038Ec032Bf33.</p><p><strong>Steps</strong></p><p><strong>1:</strong> borrow underlying assets from PancakeSwap (Flash Swap)</p><p><strong>2:</strong> convert amount (mint) to Nerve asset</p><p><strong>3:</strong> deposit Nerve asset to “MasterMind” through intermediate vault</p><p><strong>4:</strong> call emergencyBurn() on intermediate vault, transferring an amount equal to the previously deposited amount (equal to vault balance before attack) to the attacker</p><p><strong>5:</strong> proceed with a regular withdrawal, transferring the previously deposited asset balance back to the attacker</p><p><strong>Funds lost</strong></p><p>30.75 BTCB
for ~$1.05M from nrvBTC</p><p>286 ETH
for ~$561K from nrvETH</p><p>2.241M BUSD
for ~$2.241M from NRV 3Pool LP</p><p>0.647M BUSD
for $647K from NRV - BUSD LP</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p><strong>$4.5 million gone, entering at position 27 on the ever expanding <a href="https://www.rekt.news/leaderboard/">rekt leaderboard.</a></strong></p><p><a href="https://twitter.com/peckshield/status/1407479655142100994?s=20">Peckshield</a> blamed this on a “dumb logic issue”; a shockingly simple way to lose over four million dollars.</p><p>Fear and greed is <a href="https://twitter.com/BitcoinFear/status/1407654240995057664?s=20">on the rise</a>, will we see more attacks now that honest work is harder to find?</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-text-linebreak.png"/></figure></p><blockquote><p>If you enjoy our work, please donate to our <a href="https://gitcoin.co/grants/1632/rektnews-the-dark-web-of-defi-journalism">Gitcoin grant.</a></p></blockquote><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/06/gitcoin-type.png"/></figure></p>