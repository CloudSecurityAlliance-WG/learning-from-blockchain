<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/unibot-header.png"/></figure></p><p><em>Unibot users woke up to seasonally scary news this morning.</em></p><p><strong>The trading bot’s brand new router was exploited to drain at least $640k from users who had approved the contract.</strong></p><p>An hour after Peckshield <a href="https://twitter.com/peckshield/status/1719223437024284978">raised the alarm</a>, the team’s <a href="https://twitter.com/TeamUnibot/status/1719239188514844735">response</a> gave the impression that the exploit was over:</p><blockquote><p>We experienced a token approval exploit from our new router and have paused our router to contain the issue.</p><p>Any funds lost due to the bug on our new router will be compensated. Your keys and wallets are safe.</p></blockquote><p>However, <a href="https://twitter.com/0xSleuth_/status/1719239097234178336">copycats</a> deployed cloned exploit contracts and <a href="https://twitter.com/Brentsketit/status/1719241757571895366">continued</a> to <a href="https://twitter.com/CollinsCustomIP/status/1719249605412712776">drain</a> funds after the official announcement.</p><p><strong>Any user with existing approvals to the new router contract remained vulnerable.</strong></p><p><em>Why didn’t the team warn users to revoke their approvals?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/09/rekt-investigates-linebreak.png"/></figure></p><p>Credit: <em><a href="https://twitter.com/BeosinAlert/status/1719230693782507993">Beosin</a>, <a href="https://twitter.com/BlockSecTeam/status/1719231743515832549">BlockSec</a></em></p><p>Unibot’s <a href="https://etherscan.io/address/0x126c9FbaB3A2FCA24eDfd17322E71a5e36E91865">new router contract</a>, which had been deployed on Saturday and remains unverified on Etherscan, contained a vulnerability which allows an attacker to insert a transferFrom() call to drained approved tokens directly from Unibot user wallets.</p><p><strong>Any users who had approved the new router to spend tokens, and <a href="https://dune.com/scamsniffer/unibot-hack">not yet revoked</a>, is a potential victim.</strong></p><p><strong>Revoke approvals for the router contract address: <a href="https://etherscan.io/address/0x126c9FbaB3A2FCA24eDfd17322E71a5e36E91865">0x126c9FbaB3A2FCA24eDfd17322E71a5e36E91865</a></strong></p><p>Specifically, <a href="https://twitter.com/BlockSecTeam/status/1719231743515832549">BlockSec</a> explained that:</p><blockquote><p>As the code is not open-sourced, we suspect that there is a lack of input validation of the function 0xb2bd16ab in the 0x126c contract, which allows an arbitrary call. Therefore, an attacker could invoke 'transferFrom' to transfer out tokens approved to the contract.</p></blockquote><p><a href="https://twitter.com/BeosinAlert/status/1719230693782507993">Beosin</a> provided the following diagram of the vulnerable code:</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/unibot-code.png"/></figure></p><p><strong>While the original exploiter has been inactive since <a href="https://twitter.com/PeckShieldAlert/status/1719251390319796477">sending 355 ETH</a> ($640k) of profits to Tornado Cash, there have been reports of <a href="https://twitter.com/0xSleuth_/status/1719239097234178336">copycat attackers</a> deploying contracts to replicate the exploit.</strong></p><p>Exploiter address: <strong>[0x413e4fb75c300b92fec12d7c44e4c0b4faab4d04]</strong>(<a href="https://etherscan.io/address/0x413e4fb75c300b92fec12d7c44e4c0b4faab4d04">https://etherscan.io/address/0x413e4fb75c300b92fec12d7c44e4c0b4faab4d04</a>)</p><p>Example attack tx: <a href="https://etherscan.io/tx/0xcbe521aea28911fe9983030748028e12541e347b8b6b974d026fa5065c22f0cf">0xcbe521ae…</a></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p><strong>The attack looks to be <a href="https://twitter.com/BeosinAlert/status/1717013965203804457">identical</a> to one that hit Maestro, another TG trading bot, for ~$500k last week.</strong></p><p>However, Maestro’s <a href="https://twitter.com/MaestroBots/status/1717113987479785558">response</a> was quick and clear, even refunding users with more than they had lost. Hopefully refunds for today’s victims will be easily budgeted for after the <a href="https://twitter.com/dcfgod/status/1719253619957186994">volume</a> they created.</p><p><em>But it seems bizarre that Unibot, a team working on a such a similar product, wouldn’t have double-checked their new router code for the same vulnerability after such recent incident.</em></p><p>In contrast, some <a href="https://twitter.com/reethmos/status/1719248101331116176">responses</a> from the Unibot team seemed to diminish the risk, potentially leading to <a href="https://twitter.com/Brentsketit/status/1719241757571895366">further</a> losses.</p><p><em><a href="https://twitter.com/PeckShieldAlert/status/1719273674472353867">Ouch.</a></em></p><hr/><p><strong>TG trading bots, like the recent SocialFi ponzi boom, <a href="https://twitter.com/hackenclub/status/1707769973039407177">sacrifice</a> security for convenience.</strong></p><p>While this incident <em>did not</em> involve compromised keys, trusting your wallet to a closed-source project is exactly the kind of behaviour we’re continually warned about.</p><p>And as today’s incident (<em>as well as <a href="https://rekt.news/lastpass-users-rekt/">LastPass</a>, and <a href="https://rekt.news/stars-arena-rekt/">StarsArena</a></em>) shows, these UX tradeoffs sometimes result in costly lessons about trust.</p><p><em>Will we <a href="https://twitter.com/0xfoobar/status/1719372646914380080">ever</a> learn?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/rekt-outline-conc.png"/></figure></p>