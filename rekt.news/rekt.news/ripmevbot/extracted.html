<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2022/09/ripmev-header.png"/></figure>
<strong>Zero pity.</strong></p><p>The notorious MEV bot known as <a href="https://etherscan.io/address/0xbadc0defafcf6d4239bdf0b66da4d7bd36fcf05a">0xbad</a> has fallen on hard times, just like the rest of us.</p><p>After 75 days of exploiting value from unexpecting users, this mempool menace backfired on its owner, creating a beautiful display of on-chain karma.</p><p>After one unfortunate user tried to <a href="https://etherscan.io/tx/0x96a129768ec66fd7d65114bf182f4e173bf0b73a44219adaf71f01381a3d0143">swap $1.85M of Compound cUSDC for USDC</a> on Uniswap v2, a lack of liquidity meant they only received $500 in USDC. 0xbad was quick to profit from the swap, backrunning the trade with an <a href="https://etherscan.io/tx/0x2a615005a63785284f11a4c5cb803d1935d34e358c10a3b4d76398d2e7bb2f9d">elaborate arb</a> involving many different DeFi dApps.</p><p>$1.02M profit.</p><p><strong>Nice.</strong></p><p><em>However…</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2022/09/ripmev-hour.png"/></figure></p><p><strong>0xbad got put down… <em>tremendously</em>.</strong></p><p>An anonymous attacker noticed a flaw in the bots arbitrage contract code, and <a href="https://etherscan.io/tx/0x631d206d49b930029197e5e57bbbb9a4da2eb00993560c77104cd9f4ae2d1a98">stole</a> not only the recently acquired 800 ETH, but the entire 1,101 ETH in 0xbad’s wallet.</p><p><strong>Attacker’s address: <a href="https://etherscan.io/address/0xb9f78307ded12112c1f09c16009e03ef4ef16612">0xb9f78307ded12112c1f09c16009e03ef4ef16612</a></strong></p><p><strong>0xbad: <a href="https://etherscan.io/address/0xbadc0defafcf6d4239bdf0b66da4d7bd36fcf05a">0xbadc0defafcf6d4239bdf0b66da4d7bd36fcf05a</a></strong></p><p><a href="https://twitter.com/bertcmiller/status/1574852628030361609?s=20&amp;t=UMyyYEHWlz88vonCknKWUA">@bertcmiller</a> of Flashbots broke it down:</p><p>0xbad did not properly protect the function that they used to execute the dYdX flashloans.</p><p>Note "callFunction," which is the function called by the dYdX router as a part of flashloan execution</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2022/09/ripmev-code.png"/></figure></p><p><strong>When you get a flashloan the protocol you're borrowing from will call a standardized function on your contract.</strong></p><p>In this case dYdX called "callFunction" on 0xbad.</p><p>Unfortunately for 0xbad, their code allowed for arbitrary execution.</p><p>The attacker used this to get 0xbad to <a href="https://etherscan.io/tx/0x59ddcf5ee5c687af2cbf291c3ac63bf28316a8ecbb621d9f62d07fa8a5b8ef4e">approve all of their WETH</a> for spender on their contract.</p><p>The attacker then simply <a href="https://etherscan.io/tx/0x631d206d49b930029197e5e57bbbb9a4da2eb00993560c77104cd9f4ae2d1a98">transferred the WETH</a> out to their address.</p><p><em>Down 0xbad</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p><strong>To add further drama to the drama, 0xbad decided to try and threaten their attacker with a <a href="https://etherscan.io/tx/0x6352ab3619bf078efd19272fc425fefd19e0e9081ce0019a72afadf2ff0a2c41">message sent</a> via transaction input data.</strong></p><blockquote><p>Congratulations on this, we got careless and you sure managed to get us good, that was not easy to see. We would like this cooperate with you on resolving this matter. Return the funds to @x19603D249DF53d8b1650c762c4df316013Dce840 before September 28 at 23:59 GMT and we will consider this a whitehat, we will give you 20% of the retrieved amount as a bug bounty, payable as you see fit. Should the funds not be returned by then, we will have no choice but to pursue accordingly with everything in our power with the appropriate authorities to retrieve our funds.</p></blockquote><p>Then came <a href="https://etherscan.io/tx/0x56f3ec870a8a76498d40436d6eb6784ee006d3209907c9a20279f7ab35a9a65e">a reply:</a></p><blockquote><p>What about normal people who you have mev'ed and literally fucked them? Will you return them? Return the funds to all people before September 28 at 23:59 GMT and we will consider this a whitehat, we will give you 1% of the retrieved amount as a good heart sign, payable as you see fit. Should the funds not be returned by then, we will have no choice but to pursue accordingly with everything in our power with the appropriate authorities to retrieve our funds.</p></blockquote><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p><strong>Last year, in “Return to the Dark Forest”, we wrote:</strong></p><blockquote><p>Frontrunning is vampiric. It feeds off weaker participants, while conflicts with other bots push gas prices to unusable levels. Most of the time, frontrunners win…</p></blockquote><p><em>But not this time…</em></p><p><strong>MEV bots act on the boundary of “code is law”.</strong></p><p><em>In the PvP arena that is Ethereum’s Dark Forest, sometimes you win and sometimes you lose.</em></p><p>Despite the fact that the funds were never returned to their original owner, it’s nice to see such a prompt display of on-chain karma.</p><p>As Bert Miller wrote on Twitter:</p><p><em>Bad code, great content</em></p><p><strong>Which would make a great tagline for rekt.news…</strong></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/rekt-outline-conc.png"/></figure></p>