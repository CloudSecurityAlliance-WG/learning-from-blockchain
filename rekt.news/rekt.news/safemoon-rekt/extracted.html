<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/safemoon-header.png"/></figure></p><p><em>Not so safe after all.</em></p><p><strong>Yesterday, <a href="https://twitter.com/safemoon/">Safemoon</a> lost $8.9M worth of ‘locked LP’ thanks to a bug introduced in the project’s latest upgrade.</strong></p><p>The attack, which drained the SFM/BNB pool, was <a href="https://twitter.com/safemoon/status/1640825402795991048">announced</a> by the project and its CEO, <a href="https://twitter.com/CptHodl/status/1640914110350016512">John Karony</a>, with replies disabled on both tweets.</p><p>A few hours after the attack, the hacker sent a message to the Safemoon: Deployer address, <a href="https://bscscan.com/tx/0xf98a8b7e3ffee676f06f0c037141483ec2c9cf8753a57fbcdbd718590e4d77ff">claiming</a> to be MEV bot operator willing to return the funds:</p><blockquote><p>Hey relax, we are accidently frontrun an attack against you, we would like to return the fund, setup secure communication channel , lets talk</p></blockquote><p><em>However, past on-chain <a href="https://twitter.com/BeosinAlert/status/1640893350919438336">activity</a> suggests they are <a href="https://twitter.com/bbbb/status/1640867460172619776">no white knight</a> after all…</em></p><p><strong>Even if the team has dodged a bullet this time…</strong></p><p><em>…can they be trusted after such a basic error?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/09/rekt-investigates-linebreak.png"/></figure></p><p>Credit: <em><a href="https://twitter.com/peckshield/status/1640855857910149122">Peckshield</a>, <a href="https://twitter.com/MoonMark_/status/1640844732082290688">MoonMark</a></em></p><p>Just over six hours before the attack, the <a href="https://bscscan.com/address/0x678ee23173dce625a90ed651e91ca5138149f590">Safemoon: Deployer</a> address <a href="https://bscscan.com/tx/0x71273e731752457892f73d2ad8b89060bd4f0bf131ed403d5dfc149319c1c01d">upgraded</a> the token <a href="https://bscscan.com/address/0x42981d0bfbaf196529376ee702f2a9eb9092fcb5">contract</a> to a <a href="https://bscscan.com/address/0xeb11a0a0bef1ac028b8c2d4cd64138dd5938ca7a#code">new implementation</a>. In doing so, the team introduced a vulnerability leading to an astonishingly simple exploit.</p><p><strong>The new code left the burn() function publicly callable, allowing anyone to burn SFM tokens from any address.</strong></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/safemoon-burn.png"/></figure></p><p>This allowed the attacker to burn large quantities of SFM held inside the SFM:BNB liquidity pool, vastly inflating the price of SFM tokens in the pool.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/safemoon-code.png"/></figure></p><p><strong>Then, by selling (previously acquired) SFM tokens into the skewed pool, the attacker was able to drain it of BNB liquidity, for a profit of 28k BNB, or $8.9M.</strong></p><p>Exploit tx: <strong><a href="https://bscscan.com/tx/0x48e52a12cb297354a2a1c54cbc897cf3772328e7e71f51c9889bb8c5e533a934">0x48e52a12…</a></strong></p><p>Attacker’s address: <strong><a href="https://bscscan.com/address/0x286e09932b8d096cba3423d12965042736b8f850">0x286e09932b8d096cba3423d12965042736b8f850</a></strong></p><p>The hacker <a href="https://bscscan.com/tx/0xf98a8b7e3ffee676f06f0c037141483ec2c9cf8753a57fbcdbd718590e4d77ff">claims</a> to have frontrunned attack and has <a href="https://bscscan.com/tx/0x9335559f951b3ae42218fff473ebd9fdf3231e8e10d157a6b6d629c5a30ba65f">reached out</a> to Safemoon to negotiate the return of funds, the majority of which have since been <a href="https://bscscan.com/tx/0xfd2aee213c3d357b3dd12be73385313879bbed4ee9b84a03dace2cea45e9e737">transferred</a> to <a href="https://bscscan.com/address/0x237d58596f72c752a6565858589348d0fce622ed">0x237D</a> where they remain at the time of writing.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p><strong>Since its launch two years ago, Safemoon has been beset by scandal.</strong></p><p>Initially labelled as a pump and dump scheme, Safemoon shillfluencers were later slapped with a <a href="https://www.classaction.org/media/merewhuader-et-al-v-safemoon-llc-et-al.pdf">class action suit</a>, before Coffeezilla published a series of detailed <a href="https://www.youtube.com/watch?v=CzbBi0agLNg">investigations</a> into what went on behind the scenes.</p><p>The favourite of <a href="https://twitter.com/TikTokInvestors/status/1384175716535730180">tiktok investors</a> during the peak of Spring 2021’s <a href="https://rekt.news/bsc-the-bridge-to-defi/">BSC hype</a>, Safemoon claimed it was un-ruggable due to locked liquidity, which was <a href="https://safemoon.com/whitepaper.pdf">topped-up</a> with every transfer of tokens. However, the transfer fees were also criticised as ponzinomics as bagholders were disincentivised to sell.</p><p>At the peak of <a href="https://rekt.news/shitcoins/">shitcoin szn</a>, we wrote:</p><blockquote><p>the shitcoins show no sign of stopping</p></blockquote><p><strong>The markets have cooled down significantly since then, and it seems hardly believable that some of these projects have managed to survive this far….</strong></p><p>Given the vulnerability was introduced by the project’s deployer address, Peckshield (perhaps charitably, or perhaps via Hanlon’s Razor) <a href="https://twitter.com/peckshield/status/1640855857910149122">suggested</a> that admin keys may have been leaked or phished.</p><p>Regardless of whether the funds are in the hands of a blackhat hacker or whitehat MEV frontrunner, the lack of trust in Safemoon from the wider crypto community suggests they’ll unlikely be safe, even with the team…</p><p>Whether a botched rug attempt, or sheer incompetence, this episode is not a good look for a project that was never very highly regarded.</p><p>Despite all the bad press, any remaining soldiers in the SFM army appear to still believe, or are suffering from a bagholder’s case of Stockholm Syndrome.</p><p><em>Perhaps if they haven’t been put off by now, they never will be.</em></p><p><strong>And even if this turns out to be a lucky escape for Safemoon, errors like this don’t bode well for the project’s future.</strong></p><p><em>How much longer can Safemoon last?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/rekt-outline-conc.png"/></figure></p>