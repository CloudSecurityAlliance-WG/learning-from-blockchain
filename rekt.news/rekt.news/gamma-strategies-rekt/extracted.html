<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/gamma-header.png"/></figure></p><p><em>Bold strategy, Gamma, let’s see if it pays off…</em></p><p><strong>Gamma Strategies, an Arbitrum-based concentrated liquidity management protocol, was exploited for at least $4.5M, earlier today.</strong></p><p>Security researchers <a href="https://twitter.com/PeckShieldAlert/status/1742753372334399513">initially</a> <a href="https://twitter.com/Phalcon_xyz/status/1742764570236608675">thought</a> CryptoAlgebra was the affected protocol, before the victim was later <a href="https://twitter.com/shoucccc/status/1742765618984829326">correctly identified</a> as Gamma.</p><p><strong>The attack <a href="https://arbiscan.io/tx/0x025cf2858723369d606ee3abbc4ec01eab064a97cc9ec578bf91c6908679be75">began</a> around 03:30 UTC, with the alarm quickly <a href="https://twitter.com/PeckShieldAlert/status/1742753372334399513">raised</a> and Gamma <a href="https://twitter.com/GammaStrategies/status/1742772630699364759">acknowledging</a> the hack approximately an hour and a half after it commenced.</strong></p><p>A follow-up <a href="https://twitter.com/GammaStrategies/status/1742839968240980408">announcement</a> informed users that the team had paused deposits to mitigate further attacks:</p><blockquote><p>All public vaults/hypervisors have had deposits shut down. You may withdraw your funds if need be. Our vaults will continue to be managed normally for now, but deposits are currently shut down until we identify and mitigate the problem.</p></blockquote><p><strong>When <a href="https://rekt.news/orbit-bridge-rekt/">Orbit lost over $80M</a> at New Year, we asked:</strong></p><blockquote><p>Can we do better this year?</p></blockquote><p><em>So far, it’s <a href="https://twitter.com/pcaversaccio/status/1742793977709899909">not looking good</a>…</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/09/rekt-investigates-linebreak.png"/></figure></p><p>Credit: <em><a href="https://twitter.com/GammaStrategies/status/1742882840247779453">Gamma Strategies</a>, <a href="https://twitter.com/CharlesWangP/status/1742855857178587387">CharlesWang</a>, <a href="https://twitter.com/PeckShieldAlert/status/1742858988499427610/">PeckShield</a></em></p><p><em>Gamma published a <a href="https://twitter.com/GammaStrategies/status/1742882840247779453">thread</a> outlining the preliminary cause of the exploit. However, a full post-mortem is forthcoming. Paladin’s CharlesWang <a href="https://twitter.com/CharlesWangP/status/1742855857178587387">outlined</a> a potentially similar attack vector.</em></p><p><strong>Flash loans were used to manipulate the value of deposits, allowing the attacker to mint an inflated number of LP tokens.</strong></p><p>Despite four desposit protection measures, the attack was viable due to the broad ranges in allowed price changes within certain vaults. Deposits remain paused on Gamma vaults, as it is during deposits that the attack vector arises.</p><p>As Gamma <a href="https://twitter.com/GammaStrategies/status/1742882843607416860">explained</a>:</p><blockquote><p>The main issue is with the settings we placed on (2) the price change threshold.</p><p>It was placed too high allowing for up 50-200% price change on certain LST and stablecoin vaults. This allowed the attacker to manipulate the price up to the price change threshold and mint a disproportionately high number of LP tokens.</p></blockquote><p>Peckshield <a href="https://twitter.com/PeckShieldAlert/status/1742858988499427610/">provided</a> an attack flow:</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/gamma-flow.png"/></figure></p><p>Attacker address (<a href="https://etherscan.io/address/0x5351536145610aa448a8bf85ba97c71caf31909c">ETH</a>, <a href="https://arbiscan.io/address/0x5351536145610aa448a8bf85ba97c71caf31909c">ARB</a>): <strong>0x5351536145610aa448a8bf85ba97c71caf31909c</strong></p><p>Attack contract 1: <a href="https://arbiscan.io/address/0x4b57adc00ac38f74506d29fc4080e3dc65b78a69">0x4b57adc00ac38f74506d29fc4080e3dc65b78a69</a></p><p>Example attack tx: <a href="https://arbiscan.io/tx/0x025cf2858723369d606ee3abbc4ec01eab064a97cc9ec578bf91c6908679be75">0x025cf285…</a></p><p>The majority of funds were bridged back to the hacker’s <a href="https://etherscan.io/address/0x5351536145610aa448a8bf85ba97c71caf31909c">Ethereum address</a>. USDT was then swapped out for ETH for a total of 1535 ETH ($3.4M). Approximately $1.1M of DAI and gDAI remains on <a href="https://arbiscan.io/address/0x5351536145610aa448a8bf85ba97c71caf31909c">Arbitrum</a>, however total losses to Gamma may have been <a href="https://twitter.com/itspublu/status/1742788866883363041">higher</a>.</p><p><em>The attacker was <a href="https://etherscan.io/tx/0x9d82ff833fd56004d046a90658313a811f6f4aacd66d5326ccc2bdd993ecd251">funded</a> via Tornado Cash two and a half hours before the attack began.</em></p><p>The team has <a href="https://etherscan.io/tx/0x293698c1ab8b7c411d17aff9176c60ebafbeddefe557ff80f8dddd50c77e2cc2">contacted</a> the attacker on-chain, seemingly hoping for a whitehat. But the 1000 ETH <a href="https://etherscan.io/advanced-filter?fadd=0x5351536145610aa448a8bf85ba97c71caf31909c&amp;tadd=0xd90e2f925DA726b50C4Ed8D0Fb90Ad053324F31b&amp;qt=1">deposited</a> into Tornado Cash doesn’t paint an optimistic picture.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p><em>Collateral damage threatened a number of other projects…</em></p><p>First, Crypto Algebra suffered reputation-wise from the initial mis-labeling, then <a href="https://twitter.com/Eclipsefi/status/1742767159087112319">other</a> <a href="https://twitter.com/stellaxyz_/status/1742780708698124472">protocols</a> paused their contracts out of an abundance of caution. DEXs <a href="https://twitter.com/CamelotDEX/status/1742775130667831482">Camelot</a> and <a href="https://twitter.com/QuickswapDEX/status/1742785790856278221">Quickswap</a> were also keen to point out that the issue was not with their own code.</p><p><strong>However, <a href="https://twitter.com/Phalcon_xyz/status/1742887316014891069">BlockSec</a> did note a series of smaller scale attacks on similar protocol <a href="https://twitter.com/dyson_money/status/1742895378964324812">Dyson Money</a>.</strong></p><hr/><p><em>Gamma Strategies has a somewhat chequered past.</em></p><p><strong>Before rebranding, the protocol then known as Visor Finance suffered three incidents in 2021 alone.</strong></p><p>In June they defended the <a href="https://visorfinance.medium.com/visor-beta-incident-report-1b2521b9266">loss of $500k</a> via a privileged function as “<em><a href="https://twitter.com/GammaStrategies/status/1406261211000344576">not a rug</a></em>”, then in November they <a href="https://twitter.com/GammaStrategies/status/1464574917056385025">downplayed</a> another <a href="https://twitter.com/Mudit__Gupta/status/1464657484367339527">hack</a> as “<em>economic arbitrage</em>”.</p><p>December 2021’s <a href="https://rekt.news/visor-finance-rekt/">loss of $8.2M</a> to an infinite mint bug seems to have been the nail in Visor’s coffin, with the rebrand and token migration <a href="https://medium.com/gamma-strategies/visor-merges-with-gamma-a-re-org-focusing-on-security-and-performance-b4deaf67e273">announced</a> two days later.</p><p><strong>However, it bears mentioning that Gamma has had no issues since the rebrand, with <a href="https://t.me/lobsters_chat/469430">apparently</a> “<em>no original developers or founders remaining from the project</em>”.</strong></p><p>The protocol has undergone <a href="https://docs.gamma.xyz/gamma/learn/audits">three audits</a>, from Consensys Diligence (<a href="https://github.com/GammaStrategies/hypervisor/blob/master/audits/ConsenSys-Diligence-Audit-28-03-22.pdf">March 2022</a>), Arbitrary Execution (<a href="https://github.com/GammaStrategies/hypervisor/blob/master/audits/AE_Gamma_audit_09_03_22.pdf">March 2022</a>), and Certik (<a href="https://github.com/GammaStrategies/hypervisor/blob/master/audits/REP-Hypervisor-2021-07-07.pdf">July 2021</a>), but given that the vulnerability was due to the configuration of individual pool’s price change tolerances, the bug is likely out of scope.</p><p><strong>As we press on into 2024, it seems the <a href="https://rekt.news/leaderboard/">constant stream</a> of hacks and exploits shows no sign of slowing down.</strong></p><p>And if we do see a new bull run, <a href="https://twitter.com/PaulFrambot/status/1742822921507049645">at this rate</a> it will surely eclipse the madness of last time.</p><p><em>Stay safe out there…</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/rekt-outline-conc.png"/></figure></p>