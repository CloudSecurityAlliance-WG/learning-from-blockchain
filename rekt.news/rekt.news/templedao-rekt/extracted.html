<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2022/10/temple-header.png"/></figure></p><p><strong>TempleDAO’s STAX, was hacked yesterday for approximately $2.3M worth of LP tokens.</strong></p><p>TempleDAO launched as one of many OHM-forks in the run-up to last year’s market top, before pivoting to stablecoin farm when the Olympus model crumbled.</p><p>Temple’s current focus is on yield for FRAX3CRV via Convex, and STAX forms part of their “<a href="https://templedao.medium.com/the-temple-flywheel-part-ii-4ef4846b8fa1">flywheel system</a>” as “<em>a reward boosting liquidity layer for the FRAX/TEMPLE gauge</em>”.</p><p><strong>Despite initially establishing a cult-like following, the devotion of their users seems to be waning.</strong></p><p>The day before the exploit, <a href="https://twitter.com/dcfgod/status/1579522572341088257">DCF GOD responded</a> to a TempleDAO community vibe check:</p><blockquote><p>”After a year of it, I’m low on hope”</p></blockquote><p><strong>Now that users have lost all hope, who still has faith in Temple DAO?</strong></p><p>The alarm was raised by <a href="https://twitter.com/spreekaway/status/1579836562338361345">Spreek</a> approximately an hour after the exploit, which was later <a href="https://twitter.com/staxfinance/status/1579855195693256704">confirmed by STAX</a>. Although the damage done is unlikely to pose an existential threat to the wider TempleDAO protocol, the details of the exploit make for painful reading.</p><p><strong>How did the devs make such a simple oversight when they <a href="https://etherscan.io/tx/0x601bf705db76812a867ac34da18920d70b1e866b7d18cd26174e78b8e076ab92">published</a> the contract in June?</strong></p><p><em>And why did it take so long to be exploited?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/09/rekt-investigates-linebreak.png"/></figure></p><p><em>Credit: <a href="https://twitter.com/FrankResearcher/status/1579840347647414272">FrankResearcher</a>, <a href="https://twitter.com/BlockSecTeam/status/1579843881893769222">BlockSec</a></em></p><p><strong>This hack was worryingly simple.</strong></p><p>The <a href="https://etherscan.io/address/0xd2869042e12a3506100af1d192b5b04d65137941#code">StaxLPStaking</a> contract’s migrateStake() function did not contain any checks that the oldStaking parameter was valid.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2022/10/temple-code1.png"/></figure></p><p>This meant that anyone could create a contract with the same oldStaking parameter, specifying an arbitrary deposit amount and address to which the funds could be sent.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2022/10/temple-code2.png"/></figure></p><p>The resulting ~320k Stax Frax/Temple LP tokens were then swapped for ETH inside the <a href="https://etherscan.io/address/0x2df9c154fe24d081cfe568645fb4075d725431e0">attacker’s contract</a>.</p><p><strong>Attacker’s address: <a href="https://etherscan.io/address/0x9c9fb3100a2a521985f0c47de3b4598dafd25b01">0x9c9fb3100a2a521985f0c47de3b4598dafd25b01</a></strong></p><p><strong>Attack tx: <a href="https://etherscan.io/tx/0x8c3f442fc6d640a6ff3ea0b12be64f1d4609ea94edd2966f42c01cd9bdcf04b5">0x8c3f442f…</a></strong></p><p>The exploiter’s address was <a href="https://etherscan.io/tx/0x95d85a52ca63c16362cabd872c047fbe1e7ec3a4b0b0509a7e28ae8ccaff68aa">funded via Binance</a> shortly before the attack, and the stolen funds were forwarded to another address (<a href="https://etherscan.io/address/0x2b63d4a3b2db8acbb2671ea7b16993077f1db5a0">0x2b63d4a3b2db8acbb2671ea7b16993077f1db5a0</a>) where they remain.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p><strong>$2M is a relatively small amount compared to the TVL of TempleDAO, (~$57M according to <a href="https://defillama.com/protocol/temple-dao">DeFiLlama</a>).</strong></p><p>STAX have <a href="https://twitter.com/staxfinance/status/1579855202362224640">assured</a> that ”<em>Remediations will be made for all affected users.</em>”</p><p><strong>Arguably, the greatest damage done will be to the project’s reputation, after allowing such a basic error to make it to production.</strong></p><p>TempleDAO have <a href="https://twitter.com/templedao/status/1579878591981969416">pointed out</a> that their Temple Core Vaults are secure and share no common code with STAX. However, after such a simple oversight…</p><p><em>Can Temple users keep the faith?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/rekt-outline-conc.png"/></figure></p>