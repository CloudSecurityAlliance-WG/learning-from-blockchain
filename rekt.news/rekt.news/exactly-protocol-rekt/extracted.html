<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/exactly-header.png"/></figure></p><p><em>L2s have been going through something of a rekt-naissance lately.</em></p><p><strong><a href="https://twitter.com/ExactlyProtocol">Exactly Protocol</a> becomes the latest victim of this summer’s on-chain crime spree, after being hit for $7.2M.</strong></p><p>The lending platform, based on Optimism, was targeted by an exploit which drained users' collateral.</p><p>Peckshield <a href="https://twitter.com/peckshield/status/1692469871962202522">raised the alarm</a> and the Exactly team <a href="https://twitter.com/ExactlyProtocol/status/1692481399620858053">responded</a> that they were investigating. An <a href="https://twitter.com/ExactlyProtocol/status/1692509323690184966">update</a> came almost two hours later, stating that the protocol had been paused:</p><blockquote><p>We're actively investigating a security issue within our protocol. To ensure user safety, the protocol is temporarily paused (you can still withdraw assets). Our team is on top of this and will share more details asap.</p></blockquote><p><strong>While the losses are heavy, the collateral (<em>heh</em>) damage looks to have been even heavier.</strong></p><p>DeFiLlama <a href="https://defillama.com/protocol/exactly">shows</a> the project’s TVL to have dropped from $37M pre-hack, to $26M <a href="https://twitter.com/PeckShieldAlert/status/1692484653494751563">post-hack</a>.</p><p>The figure has continued to drop since, presumably as users who are <a href="https://twitter.com/MoJo_Fi/status/1692511090930815438">able to withdraw</a> do so, and sits at less than $11M at the time of writing. The <a href="https://www.coingecko.com/en/coins/exactly-token">EXA token</a> is also down almost 35% since the hack.</p><p><em>Will Exactly ever financially recover from this?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/09/rekt-investigates-linebreak.png"/></figure></p><p>Credit: <em><a href="https://twitter.com/BlockSecTeam/status/1692533280971936059">BlockSec</a></em></p><p>The attack was made possible due to an insufficient check in the DebtManager contract (<a href="https://optimistic.etherscan.io/address/0x675d410dcf6f343219AAe8d1DDE0BFAB46f52106">proxy</a>, <a href="https://optimistic.etherscan.io/address/0x16748Cb753A68329cA2117a7647aA590317EbF41#code">implementation</a>) as to whether the market address was valid.</p><p>This allowed the hacker to pass a fake market address, inserting the victim’s address as _msgSender, and thereby drain users’ collateral.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/exactly-code.png"/></figure></p><p>Exploiter address 1: <a href="https://optimistic.etherscan.io/address/0x3747dbbcb5c07786a4c59883e473a2e38f571af9">0x3747dbbcb5c07786a4c59883e473a2e38f571af9</a></p><p>Exploiter address 2: <a href="https://optimistic.etherscan.io/address/0xe4f34a72d7c18b6f666d6ca53fbc3790bc9da042">0xe4f34a72d7c18b6f666d6ca53fbc3790bc9da042</a></p><p>Exploiter address 3: <a href="https://optimistic.etherscan.io/address/0x417179df13ba3ed138b0a58eaa0c3813430a20e0">0x417179df13ba3ed138b0a58eaa0c3813430a20e0</a></p><p>Attack contract: <a href="https://optimistic.etherscan.io/address/0x6dd61c69415c8ecab3fefd80d079435ead1a5b4d#code">0x6dd61c69415c8ecab3fefd80d079435ead1a5b4d</a></p><p>Example attack tx: <a href="https://optimistic.etherscan.io/tx/0x3d6367de5c191204b44b8a5cf975f257472087a9aadc59b5d744ffdef33a520e">0x3d6367de…</a></p><p><em>The attacker was <a href="https://etherscan.io/tx/0x97618de89d43593dda51585a07972a1267d11433e387f89bfc2831ce120c2f86">funded</a> from Tornado Cash on <a href="https://etherscan.io/address/0xe4f34a72d7c18b6f666d6ca53fbc3790bc9da042">Ethereum</a> before bridging to Optimism.</em></p><p><strong>Of the 4324 ETH (~$7.2M) of total proceeds from the hack, 1500 ETH ($2.5M) have been bridged back to Ethereum, where they remain.</strong></p><p><a href="https://twitter.com/MetaSleuth/status/1692529887628636439">BlockSec</a> provided the following chart illustrating the flow of funds:</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/exactly-funds.png"/></figure></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p><em>Despite extensive <a href="https://docs.exact.ly/security/audits">audits from four firms</a> (though none since the debtManager contract was uploaded to <a href="https://github.com/exactly/protocol/blob/main/contracts/periphery/DebtManager.sol">GitHub</a>), Exactly Protocol still got rekt.</em></p><p><strong>As we’ve said many times before, audits are not a silver bullet.</strong></p><p>They should be seen as just one, albeit very important, part of an overall holistic security approach.</p><p><strong>But while some bounty hunters <a href="https://twitter.com/usmannk/status/1691943833511379290">find themselves</a> undervalued by <a href="https://bug-bounty-wall-of-shame.github.io/">projects</a> who don’t want to cough up the cash, we’re sure to stay busy here at <a href="https://rekt.news/">rekt.news</a>.</strong></p><p><em>Who will be next on the <a href="https://rekt.news/leaderboard/">leaderboard</a>?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/rekt-outline-conc.png"/></figure></p>