<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/mevbot-header.png"/></figure></p><p><em>The sandwicher has become the sandwiched.</em></p><p><strong>$2M was lost on Tuesday night as an MEV bot got a taste of its own medicine.</strong></p><p>The curious case of crypto-karma was spotted by <a href="https://twitter.com/spreekaway/status/1722040126614761790">Spreek</a>, who identified the issue as an unprotected swap function within the bot’s code.</p><p>The incident is reminiscent of when the notorious bot <a href="https://etherscan.io/address/0xbadc0defafcf6d4239bdf0b66da4d7bd36fcf05a">0xbadc0de</a> got <a href="https://rekt.news/ripmevbot/">rekt for $1.5M</a>, last year.</p><p>As we wrote at the time:</p><blockquote><p>MEV bots act on the boundary of “code is law”.</p></blockquote><p>When it comes to autonomous on-chain predators it’s hard to sympathise.</p><p><em>Is this a simple case of ‘you win some, you lose some’?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/09/rekt-investigates-linebreak.png"/></figure></p><p>Credit: <em><a href="https://twitter.com/BlockSecTeam/status/1722101942061601052">BlockSec</a>, <a href="https://twitter.com/PeckShieldAlert/status/1722046149329363178">PeckShield</a>, <a href="https://twitter.com/spreekaway/status/1722040126614761790">Spreek</a></em></p><p><strong>For all the complexity within the dog-eat-dog world of MEV, the exploit was surprisingly simple.</strong></p><p>The bot’s code had left a swap function unprotected, which anyone could call. This was exploited to sandwich attack the bot via WETH/WBTC trades on Curve, funded via a $50M flash loan.</p><p>BlockSec <a href="https://twitter.com/BlockSecTeam/status/1722101942061601052">explains</a>:</p><blockquote><p>A bot was attacked due to the lack of access control of a public function 0xf6ebebbb, which could be exploited to manipulate swaps in Curve pools. The loss was ~$2M.</p><p>Hence the attacker could first abuse the flawed function to pump the asset price (e.g., WETH) and then make a reverse swap to make a profit.</p></blockquote><p>And Peckshield <a href="https://twitter.com/PeckShieldAlert/status/1722046149329363178">provided</a> a look at the sandwiched swaps:</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/mevbot-code.png"/></figure></p><p><strong>The <a href="https://twitter.com/spreekaway/status/1722040126614761790/photo/2">result</a>:</strong></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2023/01/mevbot-swap.png"/></figure></p><p><strong><em>Oooof.</em></strong></p><p>Attacker address (<a href="https://etherscan.io/tx/0x4dadcadec09e6b92febcbc005409ddfa0367ae9e459fa1c7de7b5525b842d875">funded</a> via Tornado Cash): <strong><a href="https://etherscan.io/address/0x46d9b3dfbc163465ca9e306487cba60bc438f5a2">0x46d9b3dfbc163465ca9e306487cba60bc438f5a2</a></strong></p><p>Attack tx: <a href="https://etherscan.io/tx/0xbc08860cd0a08289c41033bdc84b2bb2b0c54a51ceae59620ed9904384287a38">0xbc08860c…</a></p><p>Victim address: <a href="https://etherscan.io/address/0x05f016765c6c601fd05a10dba1abe21a04f924a5">0x05f016765c6c601fd05a10dba1abe21a04f924a5</a></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p><strong>Whenever large amounts of money move in DeFi, things tend to work out nicely for Curve (<em>though <a href="https://rekt.news/curve-vyper-rekt/">not always</a></em>), and this incident was no exception.</strong></p><p>The swapping of vast sums necessary to imbalance the pool enough for a viable exploit generated a cool <a href="https://twitter.com/CurveCap/status/1722231234259238950">$250k in fees</a> for the protocol.</p><p><a href="https://etherscan.io/address/0xc0ffeebabe5d496b2dde509f9fa189c25cf29671">0xc0ffeebabe</a>, another bot known for the occasional <a href="https://rekt.news/curve-vyper-rekt/">whitehat</a> exploit-frontrun, also made an <a href="https://twitter.com/CurveCap/status/1722231231813988491">appearance</a> in cleaning up the mess.</p><p><strong>Autonomous bots, while constantly controversial, seem to be a necessary evil of a permissionless financial system.</strong></p><p>And with the juicy tips often paid to validators, many of the ecosystem’s key players are surely happy to tolerate the activities of the <a href="https://rekt.news/return-to-the-dark-forest/">Dark Forest</a>’s most dangerous predators.</p><p><em>How long until you fall prey, anon?</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/rekt-outline-conc.png"/></figure></p>