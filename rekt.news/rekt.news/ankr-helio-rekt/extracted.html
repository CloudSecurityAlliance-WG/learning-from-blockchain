<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2022/11/ankrhelio-header.png"/></figure>
<strong>18 quadrillion dollars.</strong></p><p>That’s the theoretical value of the 60 trillion aBNBc that was illegitimately minted from Ankr earlier today.</p><p>Unfortunately, that’s more than the GDP of the entire world, and the aBNBc liquidity couldn’t stretch that far, so the hacker only got away with $5M.</p><p>Ankr’s official <a href="https://twitter.com/ankr/status/1598503332477280256">announcement</a> pointed out that underlying staked assets are safe, and the thread goes on to promise users “a reissuance of aBNBc” via a snapshot.</p><p><em>But the damage didn’t stop there…</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/09/rekt-investigates-linebreak.png"/></figure></p><p><em>Credit: <a href="https://twitter.com/BlockSecTeam/status/1598514978428157954">BlockSec</a>, <a href="https://twitter.com/peckshield/status/1598508401755144196">Peckshield</a></em></p><p><strong><a href="https://www.coingecko.com/en/coins/ankr-reward-bearing-stake-bnb">aBNBc</a> is a reward-bearing receipt token for BNB staked via the Ankr platform on BSC.</strong></p><p>The exploit was due to a private key compromise of the Ankr deployer address on BSC, potentially the result of a <a href="https://rekt.news/big-phish/">phishing campaign</a>.</p><p>The compromised deployer account <a href="https://bscscan.com/tx/0xb2cb9e5311610c48aeed89e44549542362692808257f706accdc75f051ac7303">published</a> a malicious version of the aBNBc token contract, which was then <a href="https://bscscan.com/tx/0xcbc5ff4a6c9a66274f9bde424777c3dc862ab576e282fbea3c9c2609ca3e282b">upgraded</a> to replace the existing implementation. The upgraded version included a new function (0x3b3a5522) which allowed the attacker to bypass caller verification and mint tokens freely, directly to their own address.</p><p><strong>Exploiters address: <a href="https://bscscan.com/address/0xf3a465c9fa6663ff50794c698f600faa4b05c777">0xf3a465c9fa6663ff50794c698f600faa4b05c777</a></strong></p><p>(Compromised) Ankr deployer address: <a href="https://bscscan.com/address/0x2ffc59d32a524611bb891cab759112a51f9e33c0">0x2ffc59d32a524611bb891cab759112a51f9e33c0</a></p><p><strong>Example attack tx (minting aBNBc to exploiter’s wallet): <a href="https://bscscan.com/tx/0xe367d05e7ff37eb6d0b7d763495f218740c979348d7a3b6d8e72d3b947c86e33">0xe367d05e…</a></strong></p><p>Funding exploiter wallet from compromised deployer: <a href="https://bscscan.com/tx/0xeb617798207d1c9dc20afbe90e82a44a9ae4b53004ef47f82d3f70eabf69ba72">0xeb617798…</a></p><p>Despite the large amount of tokens minted, a lack of on-chain liquidity limited the exploiter’s profits to just $5M after draining PancakeSwap’s aBNB pools. Most of the proceeds were bridged to <a href="https://etherscan.io/address/0xf3a465C9fA6663fF50794C698F600Faa4b05c777">Ethereum</a>, where the exploiter is in the process of laundering them through Tornado Cash.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p><strong>As the <a href="https://twitter.com/1nf0s3cpt/status/1598514043421356032">word got out</a> about the publicly callable infinite mint, <a href="https://twitter.com/PeckShieldAlert/status/1598506767637680129">copycats</a> joined in, many of whom can be seen amongst the <a href="https://bscscan.com/token/0xe85afccdafbe7f2b096f268e31cce3da8da2990a#balances">top holders</a> of the now worthless aBNBc.</strong></p><p>Some did find a way to profit, however, with one account making 3x more than the initial exploiter, however the quick timing and recent funding of the address suggest that it could be the same actor.</p><p>By buying large amounts of depegged aBNB from PancakeSwap, <a href="https://bscscan.com/address/0x8d11f5b4d351396ce41813dce5a32962aa48e217">this address</a> took the token to stablecoin project <a href="https://helio.money/">Helio Money</a>.</p><p>Before the oracle had updated to reflect the crashed price, the user borrowed 16M HAY against aBNBc <a href="https://bscscan.com/tx/0x15dabf0c1bb63ec329361da5ce30a5c28a1ed1b107e3008c92614455f02032e4">collateral</a> for a <a href="https://twitter.com/BlockSecTeam/status/1598625878455373824">profit</a> of $15.5M. Another <a href="https://bscscan.com/address/0x9bae78d1c67826cde91b20b49690589ed0879fc7">user</a> profited through the same method, <a href="https://twitter.com/PeckShieldAlert/status/1598590419893641221">earning</a> approximately $3.5M.</p><p>The attacks have caused <a href="https://www.coingecko.com/en/coins/destablecoin-hay">HAY</a> to depeg ($0.62 at the time of writing), but the project has <a href="https://twitter.com/Helio_Money/status/1598587624947589123">assured</a> its users that they will be compensated.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p><strong>Audits by both <a href="https://assets.ankr.com/staking/smart_contract_security_audit_bnb_peckshield.pdf">Peckshield</a> and <a href="https://assets.ankr.com/earn/smart_contract_security_audit_bnb.pdf">Beosin</a> called out the danger that the privileged accounts posed to Ankr’s smart contracts, and were marked as “Confirmed” and “Acknowledged”, respectively.</strong></p><p><em>However, Ankr did not take steps to fix these issues.</em></p><p>Now they have paid the price, and Helios has caught even more collateral damage.</p><p><strong>CZ <a href="https://twitter.com/cz_binance/status/1598575867311132673">tweeted</a> the following summary:</strong></p><blockquote><p>”Possible hacks on Ankr and Hay. Initial analysis is developer private key was hacked, and the hacker updated the smart contract to a more malicious one. Binance paused withdrawals a few hrs ago. Also froze about $3m that hackers move to our CEX.”</p></blockquote><p><strong>Is CZ trying to become crypto’s new main character?</strong></p><p><em>Someone should remind him that role never ends well…</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/rekt-outline-conc.png"/></figure></p>