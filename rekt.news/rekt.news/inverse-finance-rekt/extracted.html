<section class="post-content"><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2022/04/inverse-header.png"/></figure></p><p><strong>Inverse Finance got flipped for ~$15M.</strong></p><p><em>This attack got the experts attention.</em></p><p>A professionally executed hack allowed an anonymous actor to manipulate the price of INV and help themself to an exclusive deal from the ETH based lending protocol.</p><p>How did it happen?</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/09/rekt-investigates-linebreak.png"/></figure></p><p><em>Credit: <a href="https://twitter.com/frankresearcher/status/1510239094777032713?s=21&amp;t=xSsIh9c1zODe1XtYcHFNxQ">Igor Igamberdiev</a> &amp; <a href="https://twitter.com/peckshield/status/1510232640338608131?s=20&amp;t=kG2VjhsXC7XN-GbLoMOeNQ">Peckshield.</a></em></p><p><strong>~$15.6M was stolen in the form of:</strong></p><ul><li>1588 ETH</li><li>94 WBTC</li><li>4M DOLA</li><li>39.3 YFI</li></ul><p><strong>First of all, the exploiter withdrew 901 ETH from Tornado Cash.</strong></p><p>Then they transferred 1.5 ETH to 241 clean addresses via Disperse and deployed five different smart contracts, of which only one was real.</p><p>He then swapped 500 ETH to 1.7k INV so that it went through the INV-WETH pair on SushiSwap, significantly changing the price due to low liquidity (50x).</p><p>At the same time, he began spamming transactions with an exploit to be the first to get into the next block and get an inflated price from SushiSwap.</p><p>The Inverse Finance oracle, through Keeper Network, ended up using SushiSwap TWAP as an oracle, returning the price that made the INV token on the platform incredibly expensive.</p><p>The attacker then deposited his 1.7k INV (fair price - $644k) as collateral and (permanently) borrowed $15.6M.</p><p><em><a href="https://twitter.com/peckshield/status/1510235343160676359?s=20&amp;t=yOTDaUd1_qHww5WjfNApBw">Peckshield provided</a> the following visualisation.</em></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2022/04/inverse-peckshield.png"/></figure></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2022/04/inverse-twap-code.png"/></figure></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2022/04/inverse-inv-price.png"/></figure></p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/03/rekt-linebreak.png"/></figure></p><p><strong>We would prefer that hackers take the weekends off, but at least this wasn’t another case of “compromised keys”.</strong></p><p>Inverse Finance have since released their <a href="https://twitter.com/InverseFinance/status/1510282040809299972?s=20&amp;t=0nY6XsdfJ2qu1YUB11CsSQ">official statement</a>, and several knowledgeable community members have pointed out the complexity / efficiency of the attack technique.</p><p>Flash bot expert himself, <a href="https://twitter.com/bertcmiller/status/1510246695929532417?s=21&amp;t=TKrULBbJo5NiglPzNffQyw">@bertcmiller</a>, said that:</p><blockquote><p>"The InverseFinance hack is one of the most MEV aware hacks I've seen."</p></blockquote><blockquote><p>"[the attacker] held an oracle's price at an insane level across multiple blocks, prevented arb bots from bringing prices back in line, and protected against generalised frontrunners."</p></blockquote><p><a href="https://twitter.com/chainlinkgod/status/1510298134202572800?s=21&amp;t=mYGxl3w-OSq78TqYpc-zgg">Chainlinkgod</a>, <em>(who always has something to say when an oracle is exploited)</em> also pointed out that:</p><blockquote><p>"Relying upon a TWAP oracle generated from a single thinly traded DEX trading pair with a short time sample compounds market manipulation risks."</p></blockquote><p>After the attack, in Twitter Spaces, <a href="https://twitter.com/ChainLinkGod/status/1510321456751599617?s=20&amp;t=yOTDaUd1_qHww5WjfNApBw">Inverse Finance stated</a> that they are working with Chainlink to launch a INV price feed once liquidity requirements have been met. This would then replace the current TWAP oracle.</p><p><strong>Although these risks are obvious in hindsight, it’s clear that this was not an amateur job.</strong></p><p><em>Even the best in the business wear black hats sometimes…</em></p><p>Maybe it’s better not to aggravate them.</p><p><figure><img alt="" src="https://raw.githubusercontent.com/RektHQ/Assets/main/images/2021/08/rekt-outline-conc.png"/></figure></p>